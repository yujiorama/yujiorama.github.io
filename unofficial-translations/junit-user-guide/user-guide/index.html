<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Stefan Bechtold, Sam Brannen, Johannes Link, Matthias Merdes, Marc Philipp, Juliette de Rancourt, Christian Stein">
<title>JUnit 5 User Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="icon" type="image/png" href="https://junit.org/junit5/assets/img/junit5-logo.png" />
<style>
  /* Tocbot dynamic TOC, works with tocbot 3.0.2 */
  /* Source: https://github.com/asciidoctor/asciidoctor/issues/699#issuecomment-321066006 */
  #tocbot a.toc-link.node-name--H1{ font-style: italic }
  @media screen{
    #tocbot > ul.toc-list{ margin-bottom: 0.5em; margin-left: 0.125em }
    #tocbot ul.sectlevel0, #tocbot a.toc-link.node-name--H1 + ul{
      padding-left: 0 }
    #tocbot a.toc-link{ height:100% }
    .is-collapsible{ max-height:3000px; overflow:hidden; }
    .is-collapsed{ max-height:0 }
    .is-active-link{ font-weight:700 }
  }
  @media print{
    #tocbot a.toc-link.node-name--H4{ display:none }
  }
</style>
</head>
<body id="user-guide" class="article toc2 toc-left">
<div id="header">
<h1>JUnit 5 User Guide</h1>
<div class="details">
<span id="author" class="author">Stefan Bechtold</span><br>
<span id="author2" class="author">Sam Brannen</span><br>
<span id="author3" class="author">Johannes Link</span><br>
<span id="author4" class="author">Matthias Merdes</span><br>
<span id="author5" class="author">Marc Philipp</span><br>
<span id="author6" class="author">Juliette de Rancourt</span><br>
<span id="author7" class="author">Christian Stein</span><br>
<span id="revnumber">version 5.9.0-SNAPSHOT</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#overview">1. 概要</a>
<ul class="sectlevel2">
<li><a href="#overview-what-is-junit-5">1.1. JUnit 5 とは何か</a></li>
<li><a href="#overview-java-versions">1.2. 対応している Java のバージョン</a></li>
<li><a href="#overview-getting-help">1.3. 分からないことの調べ方</a></li>
<li><a href="#overview-getting-started">1.4. JUnit 5 の始め方</a>
<ul class="sectlevel3">
<li><a href="#overview-getting-started-junit-artifacts">1.4.1. JUnit のアーティファクトをダウンロードする</a></li>
<li><a href="#overview-getting-started-features">1.4.2. JUnit 5 の機能</a></li>
<li><a href="#overview-getting-started-example-projects">1.4.3. プロジェクト例</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#writing-tests">2. テストを作成する</a>
<ul class="sectlevel2">
<li><a href="#writing-tests-annotations">2.1. アノテーション</a>
<ul class="sectlevel3">
<li><a href="#writing-tests-meta-annotations">2.1.1. メタアノテーションと合成アノテーション</a></li>
</ul>
</li>
<li><a href="#writing-tests-classes-and-methods">2.2. テストクラスとテストメソッド</a></li>
<li><a href="#writing-tests-display-names">2.3. 表示名</a>
<ul class="sectlevel3">
<li><a href="#writing-tests-display-name-generator">2.3.1. 表示名生成ロジック</a></li>
<li><a href="#writing-tests-display-name-generator-default">2.3.2. 表示名生成ロジックの初期値を変更する</a></li>
</ul>
</li>
<li><a href="#writing-tests-assertions">2.4. アサーション</a>
<ul class="sectlevel3">
<li><a href="#writing-tests-assertions-kotlin">2.4.1. Kotlin 用のアサーション</a></li>
<li><a href="#writing-tests-assertions-third-party">2.4.2. 外部のアサーションライブラリ</a></li>
</ul>
</li>
<li><a href="#writing-tests-assumptions">2.5. アサンプション（仮定）</a></li>
<li><a href="#writing-tests-disabling">2.6. テストを無効にする</a></li>
<li><a href="#writing-tests-conditional-execution">2.7. 条件に基づくテスト実行</a>
<ul class="sectlevel3">
<li><a href="#writing-tests-conditional-execution-os">2.7.1. OS の条件指定</a></li>
<li><a href="#writing-tests-conditional-execution-jre">2.7.2. Java 実行環境（JRE：Java Runtime Environment） の条件指定</a></li>
<li><a href="#writing-tests-conditional-execution-system-properties">2.7.3. システムプロパティの条件指定</a></li>
<li><a href="#writing-tests-conditional-execution-environment-variables">2.7.4. 環境変数の条件指定</a></li>
<li><a href="#writing-tests-conditional-execution-custom">2.7.5. 独自の条件指定</a></li>
</ul>
</li>
<li><a href="#writing-tests-tagging-and-filtering">2.8. タグ付けと選択</a></li>
<li><a href="#writing-tests-test-execution-order">2.9. テストの実行順序</a>
<ul class="sectlevel3">
<li><a href="#writing-tests-test-execution-order-methods">2.9.1. テストメソッドの実行順序</a>
<ul class="sectlevel4">
<li><a href="#writing-tests-test-execution-order-methods-default">テストメソッドの実行順序の初期値を変更する</a></li>
</ul>
</li>
<li><a href="#writing-tests-test-execution-order-classes">2.9.2. テストクラスの実行順序</a></li>
</ul>
</li>
<li><a href="#writing-tests-test-instance-lifecycle">2.10. テストインスタンスのライフサイクル</a>
<ul class="sectlevel3">
<li><a href="#writing-tests-test-instance-lifecycle-changing-default">2.10.1. インスタンスライフサイクル管理の初期値を変更する</a></li>
</ul>
</li>
<li><a href="#writing-tests-nested">2.11. ネストテストクラス</a></li>
<li><a href="#writing-tests-dependency-injection">2.12. コンストラクタやメソッドによる依存性の注入</a></li>
<li><a href="#writing-tests-test-interfaces-and-default-methods">2.13. テストインターフェイスとデフォルトメソッド</a></li>
<li><a href="#writing-tests-repeated-tests">2.14. 繰り返しテスト</a>
<ul class="sectlevel3">
<li><a href="#writing-tests-repeated-tests-examples">2.14.1. 繰り返しテストの具体例</a></li>
</ul>
</li>
<li><a href="#writing-tests-parameterized-tests">2.15. パラメタライズテスト</a>
<ul class="sectlevel3">
<li><a href="#writing-tests-parameterized-tests-setup">2.15.1. 必要な準備</a></li>
<li><a href="#writing-tests-parameterized-tests-consuming-arguments">2.15.2. 引数を消費するということについて</a></li>
<li><a href="#writing-tests-parameterized-tests-sources">2.15.3. 引数の源</a>
<ul class="sectlevel4">
<li><a href="#writing-tests-parameterized-tests-sources-ValueSource">@ValueSource</a></li>
<li><a href="#writing-tests-parameterized-tests-sources-null-and-empty">null および空値</a></li>
<li><a href="#writing-tests-parameterized-tests-sources-EnumSource">@EnumSource</a></li>
<li><a href="#writing-tests-parameterized-tests-sources-MethodSource">@MethodSource</a></li>
<li><a href="#writing-tests-parameterized-tests-sources-CsvSource">@CsvSource</a></li>
<li><a href="#writing-tests-parameterized-tests-sources-CsvFileSource">@CsvFileSource</a></li>
<li><a href="#writing-tests-parameterized-tests-sources-ArgumentsSource">@ArgumentsSource</a></li>
</ul>
</li>
<li><a href="#writing-tests-parameterized-tests-argument-conversion">2.15.4. 引数の変換</a>
<ul class="sectlevel4">
<li><a href="#writing-tests-parameterized-tests-argument-conversion-widening">ワイドニング変換</a></li>
<li><a href="#writing-tests-parameterized-tests-argument-conversion-implicit">暗黙的な型変換</a></li>
<li><a href="#writing-tests-parameterized-tests-argument-conversion-explicit">明示的な型変換</a></li>
</ul>
</li>
<li><a href="#writing-tests-parameterized-tests-argument-aggregation">2.15.5. 引数の集約</a>
<ul class="sectlevel4">
<li><a href="#writing-tests-parameterized-tests-argument-aggregation-custom">独自の集約</a></li>
</ul>
</li>
<li><a href="#writing-tests-parameterized-tests-display-names">2.15.6. 表示名の変更</a></li>
<li><a href="#writing-tests-parameterized-tests-lifecycle-interop">2.15.7. ライフサイクルと相互運用性</a></li>
</ul>
</li>
<li><a href="#writing-tests-test-templates">2.16. テストのテンプレート化</a></li>
<li><a href="#writing-tests-dynamic-tests">2.17. 実行時にテストを生成する</a>
<ul class="sectlevel3">
<li><a href="#writing-tests-dynamic-tests-examples">2.17.1. 動的テストの具体例</a></li>
<li><a href="#writing-tests-dynamic-tests-uri-test-source">2.17.2. 動的テストのための URI テストソース</a></li>
</ul>
</li>
<li><a href="#writing-tests-declarative-timeouts">2.18. タイムアウト</a>
<ul class="sectlevel3">
<li><a href="#writing-tests-declarative-timeouts-polling">2.18.1. ポーリングテストで @Timeout を使用する</a></li>
<li><a href="#writing-tests-declarative-timeouts-mode">2.18.2. 全体で @Timeout を無効化する</a></li>
</ul>
</li>
<li><a href="#writing-tests-parallel-execution">2.19. 並列実行</a>
<ul class="sectlevel3">
<li><a href="#writing-tests-parallel-execution-config">2.19.1. 設定方法</a></li>
<li><a href="#writing-tests-parallel-execution-synchronization">2.19.2. 同期化</a></li>
</ul>
</li>
<li><a href="#writing-tests-built-in-extensions">2.20. 組み込みの拡張機能</a>
<ul class="sectlevel3">
<li><a href="#writing-tests-built-in-extensions-TempDirectory">2.20.1. 一時ディレクトリ</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#migrating-from-junit4">3. JUnit 4 から移行する</a>
<ul class="sectlevel2">
<li><a href="#migrating-from-junit4-running">3.1. JUnit Platform で JUnit 4 のテストを実行する</a>
<ul class="sectlevel3">
<li><a href="#migrating-from-junit4-categories-support">3.1.1. カテゴリー（Categories）の対応</a></li>
</ul>
</li>
<li><a href="#migrating-from-junit4-tips">3.2. 移行のポイント</a></li>
<li><a href="#migrating-from-junit4-rule-support">3.3. JUnit 4 の <code>Rule</code> 対応（制限付き）</a></li>
<li><a href="#migrating-from-junit4-ignore-annotation-support">3.4. JUnit 4 の <code>@Ignore</code> 対応</a></li>
</ul>
</li>
<li><a href="#running-tests">4. テストを実行する</a>
<ul class="sectlevel2">
<li><a href="#running-tests-ide">4.1. IDE でテストを実行する</a>
<ul class="sectlevel3">
<li><a href="#running-tests-ide-intellij-idea">4.1.1. IntelliJ IDEA</a></li>
<li><a href="#running-tests-ide-eclipse">4.1.2. Eclipse</a></li>
<li><a href="#running-tests-ide-netbeans">4.1.3. NetBeans</a></li>
<li><a href="#running-tests-ide-vscode">4.1.4. Visual Studio Code</a></li>
<li><a href="#running-tests-ide-other">4.1.5. 他の IDE</a></li>
</ul>
</li>
<li><a href="#running-tests-build">4.2. ビルドツールでテストを実行する</a>
<ul class="sectlevel3">
<li><a href="#running-tests-build-gradle">4.2.1. Gradle</a>
<ul class="sectlevel4">
<li><a href="#running-tests-build-gradle-config-params">設定パラメータの構成</a></li>
<li><a href="#running-tests-build-gradle-engines-configure">テスト実行エンジンの構成</a></li>
<li><a href="#running-tests-build-gradle-logging">ログ出力の設定（任意）</a></li>
</ul>
</li>
<li><a href="#running-tests-build-maven">4.2.2. Maven</a>
<ul class="sectlevel4">
<li><a href="#running-tests-build-maven-engines-configure">テスト実行エンジンの構成</a></li>
<li><a href="#running-tests-build-maven-filter-test-class-names">名前でテストクラスを選択する</a></li>
<li><a href="#running-tests-build-maven-filter-tags">タグでテストクラスを選択する</a></li>
<li><a href="#running-tests-build-maven-config-params">設定パラメータの構成</a></li>
</ul>
</li>
<li><a href="#running-tests-build-ant">4.2.3. Ant</a>
<ul class="sectlevel4">
<li><a href="#basic-usage">Basic Usage</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#running-tests-console-launcher">4.3. コンソールランチャー</a>
<ul class="sectlevel3">
<li><a href="#running-tests-console-launcher-options">4.3.1. コンソールランチャーの引数（フラグ）</a></li>
<li><a href="#running-tests-console-launcher-argument-files">4.3.2. コンソールランチャーの引数（@-files）</a></li>
</ul>
</li>
<li><a href="#running-tests-junit-platform-runner">4.4. JUnit 4 で JUnit Platform を実行する</a>
<ul class="sectlevel3">
<li><a href="#running-tests-junit-platform-runner-setup">4.4.1. 準備</a>
<ul class="sectlevel4">
<li><a href="#running-tests-junit-platform-runner-setup-explicit-dependencies">明示的な依存関係</a></li>
<li><a href="#running-tests-junit-platform-runner-setup-transitive-dependencies">推移的依存関係</a></li>
</ul>
</li>
<li><a href="#running-tests-junit-platform-runner-technical-names">4.4.2. 表示名と部品名</a></li>
<li><a href="#running-tests-junit-platform-runner-single-test">4.4.3. 単独のテストクラス</a></li>
<li><a href="#running-tests-junit-platform-runner-test-suite">4.4.4. テストスイート</a></li>
</ul>
</li>
<li><a href="#running-tests-config-params">4.5. 設定パラメータの構成</a>
<ul class="sectlevel3">
<li><a href="#running-tests-config-params-deactivation-pattern">4.5.1. パターンマッチ記法</a></li>
</ul>
</li>
<li><a href="#running-tests-tags">4.6. タグ</a>
<ul class="sectlevel3">
<li><a href="#running-tests-tag-syntax-rules">4.6.1. タグの構文規則</a></li>
<li><a href="#running-tests-tag-expressions">4.6.2. タグ記法</a></li>
</ul>
</li>
<li><a href="#running-tests-capturing-output">4.7. 標準出力や標準エラー出力をキャプチャーする</a></li>
<li><a href="#running-tests-listeners">4.8. リスナーを使用する</a>
<ul class="sectlevel3">
<li><a href="#running-tests-listeners-flight-recorder">4.8.1. Java Flight Recorder を使用する</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#extensions">5. 拡張モデル</a>
<ul class="sectlevel2">
<li><a href="#extensions-overview">5.1. 概要</a></li>
<li><a href="#extensions-registration">5.2. 拡張機能を登録する</a>
<ul class="sectlevel3">
<li><a href="#extensions-registration-declarative">5.2.1. 宣言的に登録する方法</a></li>
<li><a href="#extensions-registration-programmatic">5.2.2. 手続き的に登録する方法</a>
<ul class="sectlevel4">
<li><a href="#extensions-registration-programmatic-static-fields">static 宣言したフィールドで拡張機能を登録する</a></li>
<li><a href="#extensions-registration-programmatic-instance-fields">インスタンスフィールドで拡張機能を登録する</a></li>
</ul>
</li>
<li><a href="#extensions-registration-automatic">5.2.3. 自動的に拡張機能を登録する</a>
<ul class="sectlevel4">
<li><a href="#extensions-registration-automatic-enabling">拡張機能の自動検出を有効化する</a></li>
</ul>
</li>
<li><a href="#extensions-registration-inheritance">5.2.4. 拡張機能の継承</a></li>
</ul>
</li>
<li><a href="#extensions-conditions">5.3. 条件付きのテスト実行</a>
<ul class="sectlevel3">
<li><a href="#extensions-conditions-deactivation">5.3.1. 条件を不活性にする</a>
<ul class="sectlevel4">
<li><a href="#extensions-conditions-deactivation-patterns">パターンマッチ記法</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#extensions-test-instance-factories">5.4. テストインスタンスファクトリ</a></li>
<li><a href="#extensions-test-instance-post-processing">5.5. テストインスタンスを作成した後の処理</a></li>
<li><a href="#extensions-test-instance-pre-destroy-callback">5.6. テストインスタンスを破棄する前のコールバック</a></li>
<li><a href="#extensions-parameter-resolution">5.7. パラメータの解決</a></li>
<li><a href="#extensions-test-result-processing">5.8. テスト結果の処理</a></li>
<li><a href="#extensions-lifecycle-callbacks">5.9. ライフサイクルコールバック</a>
<ul class="sectlevel3">
<li><a href="#extensions-lifecycle-callbacks-before-after-execution">5.9.1. テスト実行の前、および、後のコールバック</a></li>
</ul>
</li>
<li><a href="#extensions-exception-handling">5.10. 例外処理</a></li>
<li><a href="#extensions-intercepting-invocations">5.11. テストコードの呼び出しへの割り込み</a></li>
<li><a href="#extensions-test-templates">5.12. テストテンプレートに呼び出し元のコンテキストを与える</a></li>
<li><a href="#extensions-keeping-state">5.13. 拡張機能の状態を保存する</a></li>
<li><a href="#extensions-supported-utilities">5.14. 拡張機能で利用できるユーティリティ</a>
<ul class="sectlevel3">
<li><a href="#extensions-supported-utilities-annotations">5.14.1. アノテーション</a></li>
<li><a href="#extensions-supported-utilities-classes">5.14.2. クラス</a></li>
<li><a href="#extensions-supported-utilities-reflection">5.14.3. リフレクション</a></li>
<li><a href="#extensions-supported-utilities-modifier">5.14.4. 修飾子（Modifier）</a></li>
</ul>
</li>
<li><a href="#extensions-execution-order">5.15. ユーザーコードと拡張機能の相対的な実行順序</a>
<ul class="sectlevel3">
<li><a href="#extensions-execution-order-overview">5.15.1. ユーザーコードと拡張機能の順序関係</a></li>
<li><a href="#extensions-execution-order-wrapping-behavior">5.15.2. コールバックによる包み隠す振る舞い</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#advanced-topics">6. 高度な使い方</a>
<ul class="sectlevel2">
<li><a href="#launcher-api">6.1. JUnit Platform Launcher API</a>
<ul class="sectlevel3">
<li><a href="#launcher-api-discovery">6.1.1. テストの発見</a></li>
<li><a href="#launcher-api-execution">6.1.2. テストの実行</a></li>
<li><a href="#launcher-api-engines-custom">6.1.3. テスト実行エンジンの登録</a></li>
<li><a href="#launcher-api-post-discovery-filters-custom">6.1.4. テスト発見後処理フィルター（PostDiscoveryFilter） を登録する</a></li>
<li><a href="#launcher-api-launcher-session-listeners-custom">6.1.5. セッションリスナー（LauncherSessionListener）を登録する</a></li>
<li><a href="#launcher-api-launcher-discovery-listeners-custom">6.1.6. テスト発見リスナー（LauncherDiscoveryListener）を登録します</a></li>
<li><a href="#launcher-api-listeners-custom">6.1.7. テスト実行リスナー（TestExecutionListener）を登録する</a></li>
<li><a href="#launcher-api-listeners-config">6.1.8. テスト実行リスナーの設定</a></li>
<li><a href="#launcher-api-listeners-custom-deactivation">6.1.9. テスト実行リスナーを不活性にする</a>
<ul class="sectlevel4">
<li><a href="#launcher-api-listeners-custom-deactivation-pattern">パターンマッチ記法</a></li>
</ul>
</li>
<li><a href="#launcher-api-launcher-config">6.1.10. Launcher の設定</a></li>
</ul>
</li>
<li><a href="#junit-platform-reporting">6.2. JUnit Platform レポート機能</a></li>
<li><a href="#junit-platform-suite-engine">6.3. JUnit Platform テストスイートエンジン</a>
<ul class="sectlevel3">
<li><a href="#junit-platform-suite-engine-setup">6.3.1. 準備</a>
<ul class="sectlevel4">
<li><a href="#junit-platform-suite-engine-setup-required-dependencies">必要な依存ライブラリ</a></li>
<li><a href="#junit-platform-suite-engine-setup-transitive-dependencies">推移的依存ライブラリ</a></li>
</ul>
</li>
<li><a href="#junit-platform-suite-engine-example">6.3.2. テストスイートを宣言するアノテーション <code>@Suite</code> の使用例</a></li>
</ul>
</li>
<li><a href="#testkit">6.4. JUnit Platform 検査キット</a>
<ul class="sectlevel3">
<li><a href="#testkit-engine">6.4.1. テスト実行エンジン検査キット</a></li>
<li><a href="#testkit-engine-statistics">6.4.2. 統計情報を確認する</a></li>
<li><a href="#testkit-engine-events">6.4.3. イベントを確認する</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#api-evolution">7. API の進化</a>
<ul class="sectlevel2">
<li><a href="#api-evolution-version-and-status">7.1. API のバージョンと状態</a></li>
<li><a href="#api-evolution-experimental-apis">7.2. 実験的な API</a></li>
<li><a href="#api-evolution-deprecated-apis">7.3. 廃止予定の API</a></li>
<li><a href="#api-evolution-tooling">7.4. ツール側の <code>@API</code> 対応</a></li>
</ul>
</li>
<li><a href="#contributors">8. Contributors</a></li>
<li><a href="#release-notes">9. Release Notes</a></li>
<li><a href="#appendix">10. 付録</a>
<ul class="sectlevel2">
<li><a href="#reproducible-builds">10.1. 再現性のあるビルド</a></li>
<li><a href="#dependency-metadata">10.2. 依存ライブラリに関するメタデータ</a>
<ul class="sectlevel3">
<li><a href="#dependency-metadata-junit-platform">10.2.1. JUnit Platform</a></li>
<li><a href="#dependency-metadata-junit-jupiter">10.2.2. JUnit Jupiter</a></li>
<li><a href="#dependency-metadata-junit-vintage">10.2.3. JUnit Vintage</a></li>
<li><a href="#dependency-metadata-junit-bom">10.2.4. 部品表（BOM：Bill of Materials）</a></li>
<li><a href="#dependency-metadata-dependencies">10.2.5. Dependencies</a></li>
</ul>
</li>
<li><a href="#dependency-diagram">10.3. Dependency Diagram</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="overview"><a class="anchor" href="#overview"></a>1. 概要</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このドキュメントは、実際にテストを書くプログラマーや拡張機能の作者、テストエンジンの作者、それからビルドツールや IDE ベンダーのための包括的なリファレンスです。</p>
</div>
<div class="sect2">
<h3 id="overview-what-is-junit-5"><a class="anchor" href="#overview-what-is-junit-5"></a>1.1. JUnit 5 とは何か</h3>
<div class="paragraph">
<p>過去の JUnit と違って、JUnit 5 は3種類のサブプロジェクトが提供するさまざまなモジュールを組み合わせたソフトウェアになっています。</p>
</div>
<div class="paragraph">
<p><strong>JUnit 5 = <em>JUnit Platform</em> + <em>JUnit Jupiter</em> + <em>JUnit Vintage</em></strong></p>
</div>
<div class="paragraph">
<p><strong>JUnit Platform</strong> は JVM で <a href="#launcher-api">テストフレームワークを起動する</a> ための基盤を提供します。
Platform で実行するテストフレームワークを開発するための <code><a href="../api/org.junit.platform.engine/org/junit/platform/engine/TestEngine.html">TestEngine</a></code> API も公開しています。
さらに、コマンドラインから Platform を起動するための <a href="#running-tests-console-launcher">Console Launcher</a> や、JUnit 4 の環境で任意の <code>TestEngine</code> を実行するための <a href="#running-tests-junit-platform-runner">JUnit 4 based Runner</a> を提供します。
JUnit Platform を最上級の機能として対応している IDE もたくさんあります（<a href="#running-tests-ide-intellij-idea">IntelliJ IDEA</a>, <a href="#running-tests-ide-eclipse">Eclipse</a>,
<a href="#running-tests-ide-netbeans">NetBeans</a>, <a href="#running-tests-ide-vscode">Visual Studio Code</a>）。
ビルドツールについても同様です（<a href="#running-tests-build-gradle">Gradle</a>, <a href="#running-tests-build-maven">Maven</a>, <a href="#running-tests-build-ant">Ant</a>）。</p>
</div>
<div class="paragraph">
<p><strong>JUnit Jupiter</strong> は JUnit 5 でテストを書いたり、JUnit 5 の拡張機能を作成するための新しい <a href="#writing-tests">プログラミングモデル</a> や <a href="#extensions">拡張モデル</a> を組み合わせたものです。
Jupiter サブプロジェクトは、Platform で Jupiter のテストを実行するための <code>TestEngine</code> を提供します。</p>
</div>
<div class="paragraph">
<p><strong>JUnit Vintage</strong> は Platform で JUnit 3 や JUnit 4 に基づくテストを実行するための <code>TestEngine</code> を提供します。
クラスパスあるいはモジュールパスに JUnit 4.12 より新しいバージョンの jar ファイルを配置しなければなりません。</p>
</div>
</div>
<div class="sect2">
<h3 id="overview-java-versions"><a class="anchor" href="#overview-java-versions"></a>1.2. 対応している Java のバージョン</h3>
<div class="paragraph">
<p>JUnit 5 を実行するには Java 8 より新しいバージョンが必要です。
しかし、Java 8 より古いバージョンの JDK でコンパイルしたテストコードも実行できます。</p>
</div>
</div>
<div class="sect2">
<h3 id="overview-getting-help"><a class="anchor" href="#overview-getting-help"></a>1.3. 分からないことの調べ方</h3>
<div class="paragraph">
<p>JUnit 5 に関する質問は <a href="https://stackoverflow.com/questions/tagged/junit5">Stack Overflow</a> や JUnit チームの <a href="https://gitter.im/junit-team/junit5">Gitter</a> へ投稿するといいでしょう。</p>
</div>
</div>
<div class="sect2">
<h3 id="overview-getting-started"><a class="anchor" href="#overview-getting-started"></a>1.4. JUnit 5 の始め方</h3>
<div class="sect3">
<h4 id="overview-getting-started-junit-artifacts"><a class="anchor" href="#overview-getting-started-junit-artifacts"></a>1.4.1. JUnit のアーティファクトをダウンロードする</h4>
<div class="paragraph">
<p>あなたのプロジェクトに追加するべきアーティファクトを調べるには、 <a href="#dependency-metadata">依存ライブラリに関するメタデータ</a> を参照してください。
依存ライブラリとして追加するには <a href="#running-tests-build">ビルドツールでテストを実行する</a> や <a href="#overview-getting-started-example-projects">プロジェクト例</a> を参照してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="overview-getting-started-features"><a class="anchor" href="#overview-getting-started-features"></a>1.4.2. JUnit 5 の機能</h4>
<div class="paragraph">
<p>JUnit 5 で利用できる機能や使い方を調べるには、このユーザーガイドの対応するセクションを読むといいでしょう。
次のようなトピックで分類しています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#writing-tests">JUnit Jupiter でテストを書く</a></p>
</li>
<li>
<p><a href="#migrating-from-junit4">JUnit 4 から JUnit Jupiter へ移行する</a></p>
</li>
<li>
<p><a href="#running-tests">テストを実行する</a></p>
</li>
<li>
<p><a href="#extensions">JUnit Jupiter の拡張モデル</a></p>
</li>
<li>
<p>高度な内容</p>
<div class="ulist">
<ul>
<li>
<p><a href="#launcher-api">JUnit Platform Launcher API</a></p>
</li>
<li>
<p><a href="#testkit">JUnit Platform 検査キット</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="overview-getting-started-example-projects"><a class="anchor" href="#overview-getting-started-example-projects"></a>1.4.3. プロジェクト例</h4>
<div class="paragraph">
<p><a href="https://github.com/junit-team/junit5-samples"><code>Junit 5 のサンプルプロジェクトリポジトリ</code></a> には、そのまま実行できるサンプルプロジェクトがあるので、自分の環境にコピーして実験してみてください。
JUnit Jupiter を使用するプロジェクトだけでなく、JUnit Vintage や他のテストフレームワークを使用するプロジェクトもあります。
ビルドスクリプトも参考になるでしょう（<code>build.gradle</code> や <code>pom.xml</code> など）。
ビルドツールやプログラミング言語の組み合わせが特徴的なプロジェクトのリンクは次のとおりです。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle と Java - <code><a href="https://github.com/junit-team/junit5-samples/tree/HEAD/junit5-jupiter-starter-gradle">junit5-jupiter-starter-gradle</a></code></p>
</li>
<li>
<p>Gradle と Kotlin - <code><a href="https://github.com/junit-team/junit5-samples/tree/HEAD/junit5-jupiter-starter-gradle-kotlin">junit5-jupiter-starter-gradle-kotlin</a></code></p>
</li>
<li>
<p>Gradle と Groovy - <code><a href="https://github.com/junit-team/junit5-samples/tree/HEAD/junit5-jupiter-starter-gradle-groovy">junit5-jupiter-starter-gradle-groovy</a></code></p>
</li>
<li>
<p>Maven - <code><a href="https://github.com/junit-team/junit5-samples/tree/HEAD/junit5-jupiter-starter-maven">junit5-jupiter-starter-maven</a></code></p>
</li>
<li>
<p>Ant - <code><a href="https://github.com/junit-team/junit5-samples/tree/HEAD/junit5-jupiter-starter-ant">junit5-jupiter-starter-ant</a></code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="writing-tests"><a class="anchor" href="#writing-tests"></a>2. テストを作成する</h2>
<div class="sectionbody">
<div class="paragraph">
<p>次のコード例は、JUnit Jupiter で作成した最小限のテストです。
この章では全ての機能を説明していきます。</p>
</div>
<div class="listingblock">
<div class="title">最小限のテストケース</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">example.util.Calculator</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">MyFirstJUnitJupiterTests</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Calculator</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Calculator</span><span class="o">();</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">addition</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">));</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-annotations"><a class="anchor" href="#writing-tests-annotations"></a>2.1. アノテーション</h3>
<div class="paragraph">
<p>JUnit Jupiter はテストを書いたりフレームワークを拡張するためのアノテーションを提供しています。</p>
</div>
<div class="paragraph">
<p>明記しない限り、全ての主要なアノテーションは <code>junit-jupiter-api</code> モジュールの <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/package-summary.html">org.junit.jupiter.api</a></code> パッケージにあります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">アノテーション</th>
<th class="tableblock halign-left valign-top">内容</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">そのメソッドがテストメソッドであることを示します。JUnit 4 の <code>@Test</code> と違って、何も属性が定義されていません。JUnit Jupiter ではテストの振る舞いを拡張する個別のアノテーションを提供しています。<em>オーバーライド</em> しなかったメソッドは <em>継承</em> します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@ParameterizedTest</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">そのメソッドが <a href="#writing-tests-parameterized-tests">パラメタライズドテスト</a> であることを示します。<em>オーバーライド</em> しなかったメソッドは <em>継承</em> します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RepeatedTest</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">そのメソッドが <a href="#writing-tests-repeated-tests">繰り返し実行するテスト</a> のテンプレートであることを示します。<em>オーバーライド</em> しなかったメソッドは <em>継承</em> します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestFactory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">そのメソッドが <a href="#writing-tests-dynamic-tests">動的に生成するテスト</a> のファクトリメソッドであることを示します。<em>オーバーライド</em> しなかったメソッドは <em>継承</em> します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestTemplate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">そのメソッドが <a href="#writing-tests-test-templates">テストケースのテンプレート</a> であることを示します。登録した <a href="#extensions-test-templates">テンプレートプロバイダー</a> の返す呼び出しコンテキストの数に応じて、複数回実行するために設計します。<em>オーバーライド</em> しなかったメソッドは <em>継承</em> します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestClassOrder</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Nested</code> で修飾した <a href="#writing-tests-test-execution-order-classes">テストクラスの実行順序</a> を変更します。アノテーションは <em>継承</em> します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestMethodOrder</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このアノテーションで修飾したクラスにおける <a href="#writing-tests-test-execution-order-methods">テストメソッドの実行順序</a> を変更します。JUnit 4 の <code>@FixMethodOrder</code> と同じように機能します。アノテーションは <em>継承</em> します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestInstance</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このアノテーションで修飾したクラスにおける<a href="#writing-tests-test-instance-lifecycle">インスタンスのライフサイクル</a> を変更します。アノテーションは <em>継承</em> しません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@DisplayName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テストクラスやテストメソッドに独自の <a href="#writing-tests-display-names">表示名</a> を設定します。アノテーションは <em>継承</em> しません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@DisplayNameGeneration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テストクラスに独自の <a href="#writing-tests-display-name-generator">表示名生成ロジック</a> を設定します。アノテーションは <em>継承</em> します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@BeforeEach</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">当該テストクラスについて、<code>@Test, @RepeatedTest, @ParameterizedTest, @TestFactory</code> で修飾されたメソッドを実行する <strong>それぞれの</strong> タイミングで、このメソッドを <em>先に</em> 実行することを保証します。JUnit 4 では <code>@Before</code> を使用していました。<em>オーバーライド</em> しなかったメソッドは <em>継承</em> します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@AfterEach</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">当該テストクラスについて、<code>@Test, @RepeatedTest, @ParameterizedTest, @TestFactory</code> で修飾されたメソッドを実行する <strong>それぞれの</strong> タイミングで、このメソッドを <em>後から</em> 実行することを保証します。JUnit 4 では <code>@Before</code> を使用していました。<em>オーバーライド</em> しなかったメソッドは <em>継承</em> します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@BeforeAll</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">当該テストクラスについて、<code>@Test, @RepeatedTest, @ParameterizedTest, @TestFactory</code> で修飾された <strong>全ての</strong> メソッドより <em>先に</em> 、このメソッドを実行することを保証します。JUnit 4 では <code>@BeforeClass</code> を使用していました。このアノテーションで修飾したメソッドは <em>隠蔽</em> されたり <em>オーバーライド</em> されたりしなければ <em>継承</em> します。また、当該クラスが「クラス単位（per-class）」で <a href="#writing-tests-test-instance-lifecycle">インスタンスのライフサイクル</a> を管理していないなら、このアノテーションで修飾するメソッドは <code>static</code> で宣言しなければなりません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@AfterAll</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">当該テストクラスについて、<code>@Test, @RepeatedTest, @ParameterizedTest, @TestFactory</code> で修飾された <strong>全ての</strong> メソッドより <em>後に</em> 、このメソッドを実行することを保証します。JUnit 4 では <code>@AfterClass</code> を使用していました。このアノテーションで修飾したメソッドは <em>隠蔽</em> されたり <em>オーバーライド</em> されたりしなければ <em>継承</em> します。また、当該クラスが「クラス単位（per-class）」で <a href="#writing-tests-test-instance-lifecycle">インスタンスのライフサイクル</a> を管理していないなら、このアノテーションで修飾するメソッドは <code>static</code> で宣言しなければなりません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Nested</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">その内部クラスが <a href="#writing-tests-nested">ネストテストクラス</a> であることを示します。「クラス単位（per-class）」で <a href="#writing-tests-test-instance-lifecycle">インスタンスのライフサイクル</a> を管理していないなら、ネストテストクラスには <code>@BeforeAll</code> や <code>@AfterAll</code> で修飾したメソッドを定義できません。アノテーションは <em>継承</em> しません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Tag</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">クラスやメソッドのいずれかに、 <a href="#writing-tests-tagging-and-filtering">テストを選択するためのタグ</a> を定義します。TestNG におけるテストグループ、JUnit 4 におけるカテゴリーに相当します。このアノテーションでクラスを修飾した場合は <em>継承</em> します。メソッドの場合は <em>継承</em> しません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Disabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">そのクラスやメソッドが <a href="#writing-tests-disabling">無効</a> であることを示します。JUnit 4 では <code>@Ignore</code> を使用していました。アノテーションは <em>継承</em> しません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Test, @RepeatedTest, @ParameterizedTest, @TestFactory, @TestTemplate</code> で修飾されたメソッドの実行時間が指定した時間を超過したら失敗させます。アノテーションは <em>継承</em> します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@ExtendWith</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">クラスを修飾して、 <a href="#extensions-registration-declarative">登録する拡張機能を宣言的に記述</a> します。アノテーションは <em>継承</em> します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RegisterExtension</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">フィールドを修飾して、 <a href="#extensions-registration-programmatic">登録する拡張機能を手続き的に記述</a> します。フィールドは <em>隠蔽</em> されない限り <em>継承</em> します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TempDir</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">フィールドや、テストメソッドおよびライフサイクルメソッドの引数へ、 <a href="#writing-tests-built-in-extensions-TempDirectory">一時ディレクトリ</a> の情報を注入します。パッケージは <code>org.junit.jupiter.api.io</code> です。</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
一部のアノテーションは <em>実験的な機能</em> です。詳しい状態は <a href="#api-evolution-experimental-apis">実験的な API</a> を参照してください。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="writing-tests-meta-annotations"><a class="anchor" href="#writing-tests-meta-annotations"></a>2.1.1. メタアノテーションと合成アノテーション</h4>
<div class="paragraph">
<p>JUnit Jupiter のアノテーションは <em>メタアノテーション</em> として使用できます。
つまり、自分で定義した <em>合成アノテーション</em> は、使用したメタアノテーションのセマンティクスを自動的に <em>継承</em> できるのです。</p>
</div>
<div class="paragraph">
<p>例えば、コードベースのあちこちに <code>@Tag("fast")</code> というコード片をコピーペーストで量産する代わりに、<code>@Fast</code> という <em>合成アノテーション</em> を定義できるのです。
そうすれば、もともと <code>@Tag("fast")</code> と記述していた部分をそのまま置換できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.lang.annotation.ElementType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.RetentionPolicy</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Tag</span><span class="o">;</span>

<span class="nd">@Target</span><span class="o">({</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">TYPE</span><span class="o">,</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">METHOD</span> <span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Tag</span><span class="o">(</span><span class="s">"fast"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Fast</span> <span class="o">{</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@Fast</code> アノテーションは次のように使用できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Fast</span>
<span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">myFastTest</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>もう一歩先に進めて、 <code>@Tag("fast")</code> と <code>@Test</code> を置き換える <code>@FastTest</code> アノテーションを定義できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.lang.annotation.ElementType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.RetentionPolicy</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Tag</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Tag</span><span class="o">(</span><span class="s">"fast"</span><span class="o">)</span>
<span class="nd">@Test</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">FastTest</span> <span class="o">{</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>JUnit は <code>@FastTest</code> アノテーションで修飾したメソッドを、<code>@Test</code> アノテーションと "fast" タグを指定したメソッドとして自動的に認識します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@FastTest</span>
<span class="kt">void</span> <span class="nf">myFastTest</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-classes-and-methods"><a class="anchor" href="#writing-tests-classes-and-methods"></a>2.2. テストクラスとテストメソッド</h3>
<div class="paragraph">
<p><strong>テストクラス</strong>: 1つ以上の <em>テストメソッド</em> を含む任意のトップレベルクラス、<code>static</code> 宣言したメンバークラス、<a href="#writing-tests-nested">ネストテストクラス</a></p>
</div>
<div class="paragraph">
<p>抽象クラスはテストクラスにできません。
また、テストクラスに定義できるコンストラクタは1つだけです。</p>
</div>
<div class="paragraph">
<p><strong>テストメソッド</strong>: <code>@Test, @RepeatedTest, @ParameterizedTest, @TestFactory, @TestTemplate</code> のいずれかのアノテーションで直接、あるいは、間接的に修飾されたインスタンスメソッド</p>
</div>
<div class="paragraph">
<p><strong>ライフサイクルメソッド</strong>: <code>@BeforeAll, @AfterAll, @BeforeEach, @AfterEach</code> のいずれかのアノテーションで直接、あるいは、間接的に修飾されたインスタンスメソッド</p>
</div>
<div class="paragraph">
<p>テストメソッドとライフサイクルメソッドは、基底クラスから継承することもできますし、インターフェイスから継承することもできます（<a href="#writing-tests-test-interfaces-and-default-methods">テストインターフェイスとデフォルトメソッド</a> を参照）。
なお、どちらのメソッドも抽象メソッドにできませんし、返り値も宣言できません（ただし <code>@TestFactory</code> メソッドには返り値が必要です）。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">クラスとメソッドの可視性</div>
<div class="paragraph">
<p>テストクラス、テストメソッド、ライフサイクルメソッドの可視性は <code>public</code> でなくても構いませんが、<code>private</code> に <em>してはいけません</em> 。</p>
</div>
<div class="paragraph">
<p>他のパッケージのテストクラスを継承する場合など、技術的な必要性がない限り、基本的にはテストクラスやテストメソッドの可視性に <code>public</code> を指定しないほうがいいでしょう。
JPMS（Java Platform Module System）のモジュールパスを単純化したい場合は、可視性を <code>public</code> にする理由になるでしょう。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>次のコード例は <code>@Test</code> メソッドと全てのライフサイクルメソッドを使用したものです。
実行時のセマンティクスについては <a href="#writing-tests-test-execution-order">テストの実行順序</a> と <a href="#extensions-execution-order-wrapping-behavior">コールバックによる包み隠す振る舞い</a> を参照してください。</p>
</div>
<div class="listingblock">
<div class="title">基本的なテストクラス</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">fail</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assumptions</span><span class="o">.</span><span class="na">assumeTrue</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.AfterAll</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.AfterEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeAll</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Disabled</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">StandardTests</span> <span class="o">{</span>

    <span class="nd">@BeforeAll</span>
    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">initAll</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nd">@BeforeEach</span>
    <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">succeedingTest</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">failingTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">fail</span><span class="o">(</span><span class="s">"a failing test"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@Disabled</span><span class="o">(</span><span class="s">"for demonstration purposes"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">skippedTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// not executed</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">abortedTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assumeTrue</span><span class="o">(</span><span class="s">"abc"</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"Z"</span><span class="o">));</span>
        <span class="n">fail</span><span class="o">(</span><span class="s">"test should have been aborted"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@AfterEach</span>
    <span class="kt">void</span> <span class="nf">tearDown</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nd">@AfterAll</span>
    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">tearDownAll</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-display-names"><a class="anchor" href="#writing-tests-display-names"></a>2.3. 表示名</h3>
<div class="paragraph">
<p>テストクラスやテストメソッドには <code>@DisplayName</code> で空白文字や特殊文字や絵文字などを含む独自の表示名を宣言できます。
表示名はテストレポートや IDE で実行したテストランナーで使用できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"A special test case"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">DisplayNameDemo</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"Custom test name containing spaces"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">testWithDisplayNameContainingSpaces</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"╯°□°）╯"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">testWithDisplayNameContainingSpecialCharacters</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"😱"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">testWithDisplayNameContainingEmoji</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-display-name-generator"><a class="anchor" href="#writing-tests-display-name-generator"></a>2.3.1. 表示名生成ロジック</h4>
<div class="paragraph">
<p>JUnit Jupiter は <code>@DisplayNameGeneration</code> アノテーションで独自の表示名生成ロジックを使用できます。
ただし、<code>DisplayNameGenerator</code> の生成した表示名より、<code>@DisplayName</code> アノテーションで宣言した値を優先して使用します。</p>
</div>
<div class="paragraph">
<p>表示名生成ロジックを作成するときは <code>DisplayNamaGenerator</code> インターフェイスを実装します。
Jupiter の提供する既存の実装は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">DisplayNameGenerator の実装クラス</th>
<th class="tableblock halign-left valign-top">振る舞い</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Standard</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JUnit Jupiter 5.0 で導入された標準的な表示名生成ロジックです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Simple</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">引数無しテストメソッドの括弧を除去します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ReplaceUnderscores</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">アンダースコアを空白文字で置換します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IndicativeSentences</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">エンクロージングクラスの名前と、テストクラスやテストメソッドの名前を連結して完全な文章を生成します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>IndicativeSentences</code> については、区切り文字と内部で使用する表示名生成ロジックを <code>@IndicativeSentencesGeneration</code> アノテーションで設定できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayNameGeneration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayNameGenerator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.IndicativeSentencesGeneration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Nested</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.params.ParameterizedTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.params.provider.ValueSource</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">DisplayNameGeneratorDemo</span> <span class="o">{</span>

    <span class="nd">@Nested</span>
    <span class="nd">@DisplayNameGeneration</span><span class="o">(</span><span class="nc">DisplayNameGenerator</span><span class="o">.</span><span class="na">ReplaceUnderscores</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">class</span> <span class="nc">A_year_is_not_supported</span> <span class="o">{</span>

        <span class="nd">@Test</span>
        <span class="kt">void</span> <span class="nf">if_it_is_zero</span><span class="o">()</span> <span class="o">{</span>
        <span class="o">}</span>

        <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"A negative value for year is not supported by the leap year computation."</span><span class="o">)</span>
        <span class="nd">@ParameterizedTest</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"For example, year {0} is not supported."</span><span class="o">)</span>
        <span class="nd">@ValueSource</span><span class="o">(</span><span class="n">ints</span> <span class="o">=</span> <span class="o">{</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span> <span class="o">})</span>
        <span class="kt">void</span> <span class="nf">if_it_is_negative</span><span class="o">(</span><span class="kt">int</span> <span class="n">year</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span>

    <span class="o">}</span>

    <span class="nd">@Nested</span>
    <span class="nd">@IndicativeSentencesGeneration</span><span class="o">(</span><span class="n">separator</span> <span class="o">=</span> <span class="s">" -&gt; "</span><span class="o">,</span> <span class="n">generator</span> <span class="o">=</span> <span class="nc">DisplayNameGenerator</span><span class="o">.</span><span class="na">ReplaceUnderscores</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">class</span> <span class="nc">A_year_is_a_leap_year</span> <span class="o">{</span>

        <span class="nd">@Test</span>
        <span class="kt">void</span> <span class="nf">if_it_is_divisible_by_4_but_not_by_100</span><span class="o">()</span> <span class="o">{</span>
        <span class="o">}</span>

        <span class="nd">@ParameterizedTest</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"Year {0} is a leap year."</span><span class="o">)</span>
        <span class="nd">@ValueSource</span><span class="o">(</span><span class="n">ints</span> <span class="o">=</span> <span class="o">{</span> <span class="mi">2016</span><span class="o">,</span> <span class="mi">2020</span><span class="o">,</span> <span class="mi">2048</span> <span class="o">})</span>
        <span class="kt">void</span> <span class="nf">if_it_is_one_of_the_following_years</span><span class="o">(</span><span class="kt">int</span> <span class="n">year</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span>

    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>+-- DisplayNameGeneratorDemo [OK]
  +-- A year is not supported [OK]
  | +-- A negative value for year is not supported by the leap year computation. [OK]
  | | +-- For example, year -1 is not supported. [OK]
  | | '-- For example, year -4 is not supported. [OK]
  | '-- if it is zero() [OK]
  '-- A year is a leap year [OK]
    +-- A year is a leap year -&gt; if it is divisible by 4 but not by 100. [OK]
    '-- A year is a leap year -&gt; if it is one of the following years. [OK]
      +-- Year 2016 is a leap year. [OK]
      +-- Year 2020 is a leap year. [OK]
      '-- Year 2048 is a leap year. [OK]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-display-name-generator-default"><a class="anchor" href="#writing-tests-display-name-generator-default"></a>2.3.2. 表示名生成ロジックの初期値を変更する</h4>
<div class="paragraph">
<p><code>junit.jupiter.displayname.generator.default</code> という <a href="#running-tests-config-params">設定パラメータ</a> で、JUnit Jupiter が <code>DisplayNameGenerator</code> の初期値として使用するクラスの完全修飾クラス名を指定できます。
<code>@DisplayNameGeneration</code> アノテーションで指定するのと同じように、<code>DisplayNameGenerator</code> インターフェイスの実装クラスを指定します。
エンクロージングクラスやインターフェイスを <code>@DisplayNameGeneration</code> アノテーションで修飾しない限り、常に <code>DisplayNameGenerator</code> の初期値を使用します。
そして、<code>@DisplayName</code> アノテーションで宣言した値は常に優先されます。</p>
</div>
<div class="paragraph">
<p>例えば、表示名生成ロジックの初期値として <code>ReplaceUnderscores</code> を使うには、プロパティファイル（例えば <code>src/test/resources/junit-platform.properties</code>）へ次のように記述します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="properties"><span class="py">junit.jupiter.displayname.generator.default</span> <span class="p">=</span> <span class="se">\
</span>    <span class="s">org.junit.jupiter.api.DisplayNameGenerator$ReplaceUnderscores</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>自分で作成した <code>DisplayNameGenerator</code> インターフェイスの実装クラスも同じように指定できます。</p>
</div>
<div id="writing-tests-display-name-generator-precedence-rules" class="paragraph">
<p>まとめると、テストクラスやテストメソッドの表示名は次の優先順位に従って決定されます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>@DisplayName</code> アノテーションで宣言した値</p>
</li>
<li>
<p><code>@DisplayNameGeneration</code> で宣言した <code>DisplayNameGenerator</code> の返す値</p>
</li>
<li>
<p>プロパティフィルで指定した <code>DisplayNameGenerator</code> の初期値が返す値</p>
</li>
<li>
<p><code>org.junit.jupiter.api.DisplayNameGenerator.Standard</code> が返す値</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-assertions"><a class="anchor" href="#writing-tests-assertions"></a>2.4. アサーション</h3>
<div class="paragraph">
<p>JUnit Jupiter は大量のアサーションメソッドを提供します。
JUnit 4 でも提供していたメソッドに加えて、それらのメソッドを Java 8 のラムダ式で使えるようにしたメソッドが増えています。
全てのアサーションメソッドは <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/Assertions.html">org.junit.jupiter.api.Assertions</a></code> クラスの <code>static</code> メソッドとして定義されています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">time</span><span class="o">.</span><span class="na">Duration</span><span class="o">.</span><span class="na">ofMillis</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">time</span><span class="o">.</span><span class="na">Duration</span><span class="o">.</span><span class="na">ofMinutes</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertAll</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertNotNull</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertThrows</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertTimeout</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertTimeoutPreemptively</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.concurrent.CountDownLatch</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">example.domain.Person</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">example.util.Calculator</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">AssertionsDemo</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Calculator</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Calculator</span><span class="o">();</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Person</span> <span class="n">person</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Person</span><span class="o">(</span><span class="s">"Jane"</span><span class="o">,</span> <span class="s">"Doe"</span><span class="o">);</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">standardAssertions</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">));</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">multiply</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span>
                <span class="s">"The optional failure message is now the last parameter"</span><span class="o">);</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="sc">'a'</span> <span class="o">&lt;</span> <span class="sc">'b'</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="s">"Assertion messages can be lazily evaluated -- "</span>
                <span class="o">+</span> <span class="s">"to avoid constructing complex messages unnecessarily."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">groupedAssertions</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// In a grouped assertion all assertions are executed, and all</span>
        <span class="c1">// failures will be reported together.</span>
        <span class="n">assertAll</span><span class="o">(</span><span class="s">"person"</span><span class="o">,</span>
            <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Jane"</span><span class="o">,</span> <span class="n">person</span><span class="o">.</span><span class="na">getFirstName</span><span class="o">()),</span>
            <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Doe"</span><span class="o">,</span> <span class="n">person</span><span class="o">.</span><span class="na">getLastName</span><span class="o">())</span>
        <span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">dependentAssertions</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Within a code block, if an assertion fails the</span>
        <span class="c1">// subsequent code in the same block will be skipped.</span>
        <span class="n">assertAll</span><span class="o">(</span><span class="s">"properties"</span><span class="o">,</span>
            <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="nc">String</span> <span class="n">firstName</span> <span class="o">=</span> <span class="n">person</span><span class="o">.</span><span class="na">getFirstName</span><span class="o">();</span>
                <span class="n">assertNotNull</span><span class="o">(</span><span class="n">firstName</span><span class="o">);</span>

                <span class="c1">// Executed only if the previous assertion is valid.</span>
                <span class="n">assertAll</span><span class="o">(</span><span class="s">"first name"</span><span class="o">,</span>
                    <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">firstName</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"J"</span><span class="o">)),</span>
                    <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">firstName</span><span class="o">.</span><span class="na">endsWith</span><span class="o">(</span><span class="s">"e"</span><span class="o">))</span>
                <span class="o">);</span>
            <span class="o">},</span>
            <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="c1">// Grouped assertion, so processed independently</span>
                <span class="c1">// of results of first name assertions.</span>
                <span class="nc">String</span> <span class="n">lastName</span> <span class="o">=</span> <span class="n">person</span><span class="o">.</span><span class="na">getLastName</span><span class="o">();</span>
                <span class="n">assertNotNull</span><span class="o">(</span><span class="n">lastName</span><span class="o">);</span>

                <span class="c1">// Executed only if the previous assertion is valid.</span>
                <span class="n">assertAll</span><span class="o">(</span><span class="s">"last name"</span><span class="o">,</span>
                    <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">lastName</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"D"</span><span class="o">)),</span>
                    <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">lastName</span><span class="o">.</span><span class="na">endsWith</span><span class="o">(</span><span class="s">"e"</span><span class="o">))</span>
                <span class="o">);</span>
            <span class="o">}</span>
        <span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">exceptionTesting</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Exception</span> <span class="n">exception</span> <span class="o">=</span> <span class="n">assertThrows</span><span class="o">(</span><span class="nc">ArithmeticException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span>
            <span class="n">calculator</span><span class="o">.</span><span class="na">divide</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">));</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"/ by zero"</span><span class="o">,</span> <span class="n">exception</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">timeoutNotExceeded</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// The following assertion succeeds.</span>
        <span class="n">assertTimeout</span><span class="o">(</span><span class="n">ofMinutes</span><span class="o">(</span><span class="mi">2</span><span class="o">),</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="c1">// Perform task that takes less than 2 minutes.</span>
        <span class="o">});</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">timeoutNotExceededWithResult</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// The following assertion succeeds, and returns the supplied object.</span>
        <span class="nc">String</span> <span class="n">actualResult</span> <span class="o">=</span> <span class="n">assertTimeout</span><span class="o">(</span><span class="n">ofMinutes</span><span class="o">(</span><span class="mi">2</span><span class="o">),</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"a result"</span><span class="o">;</span>
        <span class="o">});</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"a result"</span><span class="o">,</span> <span class="n">actualResult</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">timeoutNotExceededWithMethod</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// The following assertion invokes a method reference and returns an object.</span>
        <span class="nc">String</span> <span class="n">actualGreeting</span> <span class="o">=</span> <span class="n">assertTimeout</span><span class="o">(</span><span class="n">ofMinutes</span><span class="o">(</span><span class="mi">2</span><span class="o">),</span> <span class="nl">AssertionsDemo:</span><span class="o">:</span><span class="n">greeting</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Hello, World!"</span><span class="o">,</span> <span class="n">actualGreeting</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">timeoutExceeded</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// The following assertion fails with an error message similar to:</span>
        <span class="c1">// execution exceeded timeout of 10 ms by 91 ms</span>
        <span class="n">assertTimeout</span><span class="o">(</span><span class="n">ofMillis</span><span class="o">(</span><span class="mi">10</span><span class="o">),</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="c1">// Simulate task that takes more than 10 ms.</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
        <span class="o">});</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">timeoutExceededWithPreemptiveTermination</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// The following assertion fails with an error message similar to:</span>
        <span class="c1">// execution timed out after 10 ms</span>
        <span class="n">assertTimeoutPreemptively</span><span class="o">(</span><span class="n">ofMillis</span><span class="o">(</span><span class="mi">10</span><span class="o">),</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="c1">// Simulate task that takes more than 10 ms.</span>
            <span class="k">new</span> <span class="nf">CountDownLatch</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">await</span><span class="o">();</span>
        <span class="o">});</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">greeting</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"Hello, World!"</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div id="writing-tests-assertions-preemptive-timeouts" class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">予防的なタイムアウトを <code>assertTimeoutPreemptively()</code> で記述する</div>
<div class="paragraph">
<p><a href="#writing-tests-declarative-timeouts">宣言的タイムアウト</a> と逆に、<code>Assertions</code> クラスの <code>assertTimeoutPreemptively()</code> メソッドは指定された <code>executable</code> あるいは <code>supplier</code> を、呼び出し元とは別のスレッドで実行します。
そのため、<code>executable</code> や <code>supplier</code> で <code>java.lang.ThreadLocal</code> を使用するコードを実行すると、予期せぬ副作用を引き起こす可能性があります。</p>
</div>
<div class="paragraph">
<p>典型的な例の1つとして、Spring Framework の提供するトランザクション管理機能が挙げられます。
特に、テストメソッドを実行する前のトランザクション状態を <code>ThreadLocal</code> へ記録している場合に問題になります。
つまり、<code>assertTimeoutPreemptively()</code> メソッドに渡した <code>executable</code> あるいは <code>supplier</code> の実行する Spring のコンポーネントがトランザクションで行ったあらゆる操作を、テストの管理しているトランザクションとしてロールバックできないのです。
たとえテストの管理しているトランザクションをロールバックしても、コミットした結果は永続化されてしまいます。</p>
</div>
<div class="paragraph">
<p><code>ThreadLocal</code> を使用している他のフレームワークでも同じような副作用に悩まされるでしょう。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="writing-tests-assertions-kotlin"><a class="anchor" href="#writing-tests-assertions-kotlin"></a>2.4.1. Kotlin 用のアサーション</h4>
<div class="paragraph">
<p>JUnit Jupiter は <a href="https://kotlinlang.org/">Kotlin</a> から使用するためのアサーションメソッドを提供しています。
全てのアサーション関数は <code>org.junit.jupiter.api</code> パッケージのトップレベル関数として定義されています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">example.domain.Person</span>
<span class="k">import</span> <span class="nn">example.util.Calculator</span>
<span class="k">import</span> <span class="nn">java.time.Duration</span>
<span class="k">import</span> <span class="nn">org.junit.jupiter.api.Assertions.assertEquals</span>
<span class="k">import</span> <span class="nn">org.junit.jupiter.api.Assertions.assertTrue</span>
<span class="k">import</span> <span class="nn">org.junit.jupiter.api.Test</span>
<span class="k">import</span> <span class="nn">org.junit.jupiter.api.assertAll</span>
<span class="k">import</span> <span class="nn">org.junit.jupiter.api.assertDoesNotThrow</span>
<span class="k">import</span> <span class="nn">org.junit.jupiter.api.assertThrows</span>
<span class="k">import</span> <span class="nn">org.junit.jupiter.api.assertTimeout</span>
<span class="k">import</span> <span class="nn">org.junit.jupiter.api.assertTimeoutPreemptively</span>

<span class="kd">class</span> <span class="nc">KotlinAssertionsDemo</span> <span class="p">{</span>

    <span class="k">private</span> <span class="kd">val</span> <span class="py">person</span> <span class="p">=</span> <span class="nc">Person</span><span class="p">(</span><span class="s">"Jane"</span><span class="p">,</span> <span class="s">"Doe"</span><span class="p">)</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">people</span> <span class="p">=</span> <span class="nf">setOf</span><span class="p">(</span><span class="n">person</span><span class="p">,</span> <span class="nc">Person</span><span class="p">(</span><span class="s">"John"</span><span class="p">,</span> <span class="s">"Doe"</span><span class="p">))</span>

    <span class="nd">@Test</span>
    <span class="k">fun</span> <span class="nf">`exception</span> <span class="n">absence</span> <span class="nf">testing`</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">calculator</span> <span class="p">=</span> <span class="nc">Calculator</span><span class="p">()</span>
        <span class="kd">val</span> <span class="py">result</span> <span class="p">=</span> <span class="nf">assertDoesNotThrow</span><span class="p">(</span><span class="s">"Should not throw an exception"</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">calculator</span><span class="p">.</span><span class="nf">divide</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nf">assertEquals</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nd">@Test</span>
    <span class="k">fun</span> <span class="nf">`expected</span> <span class="n">exception</span> <span class="nf">testing`</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">calculator</span> <span class="p">=</span> <span class="nc">Calculator</span><span class="p">()</span>
        <span class="kd">val</span> <span class="py">exception</span> <span class="p">=</span> <span class="n">assertThrows</span><span class="p">&lt;</span><span class="nc">ArithmeticException</span><span class="p">&gt;</span> <span class="p">(</span><span class="s">"Should throw an exception"</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">calculator</span><span class="p">.</span><span class="nf">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nf">assertEquals</span><span class="p">(</span><span class="s">"/ by zero"</span><span class="p">,</span> <span class="n">exception</span><span class="p">.</span><span class="n">message</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nd">@Test</span>
    <span class="k">fun</span> <span class="nf">`grouped</span> <span class="nf">assertions`</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">assertAll</span><span class="p">(</span><span class="s">"Person properties"</span><span class="p">,</span>
            <span class="p">{</span> <span class="nf">assertEquals</span><span class="p">(</span><span class="s">"Jane"</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">firstName</span><span class="p">)</span> <span class="p">},</span>
            <span class="p">{</span> <span class="nf">assertEquals</span><span class="p">(</span><span class="s">"Doe"</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">lastName</span><span class="p">)</span> <span class="p">}</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="nd">@Test</span>
    <span class="k">fun</span> <span class="nf">`grouped</span> <span class="n">assertions</span> <span class="n">from</span> <span class="n">a</span> <span class="nf">stream`</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">assertAll</span><span class="p">(</span><span class="s">"People with first name starting with J"</span><span class="p">,</span>
            <span class="n">people</span>
                <span class="p">.</span><span class="nf">stream</span><span class="p">()</span>
                <span class="p">.</span><span class="nf">map</span> <span class="p">{</span>
                    <span class="c1">// This mapping returns Stream&lt;() -&gt; Unit&gt;</span>
                    <span class="p">{</span> <span class="nf">assertTrue</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">firstName</span><span class="p">.</span><span class="nf">startsWith</span><span class="p">(</span><span class="s">"J"</span><span class="p">))</span> <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="nd">@Test</span>
    <span class="k">fun</span> <span class="nf">`grouped</span> <span class="n">assertions</span> <span class="n">from</span> <span class="n">a</span> <span class="nf">collection`</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">assertAll</span><span class="p">(</span><span class="s">"People with last name of Doe"</span><span class="p">,</span>
            <span class="n">people</span><span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="p">{</span> <span class="nf">assertEquals</span><span class="p">(</span><span class="s">"Doe"</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="n">lastName</span><span class="p">)</span> <span class="p">}</span> <span class="p">}</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="nd">@Test</span>
    <span class="k">fun</span> <span class="nf">`timeout</span> <span class="n">not</span> <span class="n">exceeded</span> <span class="nf">testing`</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">fibonacciCalculator</span> <span class="p">=</span> <span class="nc">FibonacciCalculator</span><span class="p">()</span>
        <span class="kd">val</span> <span class="py">result</span> <span class="p">=</span> <span class="nf">assertTimeout</span><span class="p">(</span><span class="nc">Duration</span><span class="p">.</span><span class="nf">ofMillis</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">fibonacciCalculator</span><span class="p">.</span><span class="nf">fib</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nf">assertEquals</span><span class="p">(</span><span class="mi">377</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nd">@Test</span>
    <span class="k">fun</span> <span class="nf">`timeout</span> <span class="n">exceeded</span> <span class="n">with</span> <span class="n">preemptive</span> <span class="nf">termination`</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// The following assertion fails with an error message similar to:</span>
        <span class="c1">// execution timed out after 10 ms</span>
        <span class="nf">assertTimeoutPreemptively</span><span class="p">(</span><span class="nc">Duration</span><span class="p">.</span><span class="nf">ofMillis</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="p">{</span>
            <span class="c1">// Simulate task that takes more than 10 ms.</span>
            <span class="nc">Thread</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-assertions-third-party"><a class="anchor" href="#writing-tests-assertions-third-party"></a>2.4.2. 外部のアサーションライブラリ</h4>
<div class="paragraph">
<p>Junit Jupiter はたいていのテストを満足するアサーションの部品を提供していますが、<em>マッチャー</em> のようにより強力で便利な機能が必要になる場合もあります。
そういう場合、JUnit チームとしては <a href="https://joel-costigliola.github.io/assertj/">AssertJ</a> や <a href="https://hamcrest.org/JavaHamcrest/">Hamcrest</a> や <a href="https://truth.dev/">Truth</a> などの外部ライブラリを使用することをお勧めしています。
開発者は自由にアサーションライブラリを選択できるのです。</p>
</div>
<div class="paragraph">
<p>例えば、<em>マッチャー</em> を組み合わせたり、フルーエント API を使うことで、可読性や説明力の高いアサーションを表現できるようになります。
JUnit 4 の <code>org.junit.Assert</code> クラスが提供する
<a href="https://junit.org/junit4/javadoc/latest/org/junit/Assert.html#assertThat"><code>assertThat()</code></a>
は、
<a href="https://junit.org/junit4/javadoc/latest/org/hamcrest/Matcher.html"><code>Hamcrest のマッチャー</code></a>
を組み合わせて使用できるようになっていました。
しかし、JUnit Jupiter の <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/Assertions.html">org.junit.jupiter.api.Assertions</a></code> クラスは <code>assertThat()</code> を提供していないため、開発者は外部アサーションライブラリの提供するマッチャーを使わなければなりません。</p>
</div>
<div class="paragraph">
<p>次のコード例では、JUnit Jupiter のテストで Hamcrest の提供する <code>assertThat()</code> を使っています。
Hamcrest の jar ファイルがクラスパスに存在するなら、<code>assertThat(), is(), equalTo()</code> などの <code>static</code> メソッドを import して、<code>assertWithHamcrestMatcher()</code> テストメソッドで使用できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">hamcrest</span><span class="o">.</span><span class="na">CoreMatchers</span><span class="o">.</span><span class="na">equalTo</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">hamcrest</span><span class="o">.</span><span class="na">CoreMatchers</span><span class="o">.</span><span class="na">is</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">hamcrest</span><span class="o">.</span><span class="na">MatcherAssert</span><span class="o">.</span><span class="na">assertThat</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">example.util.Calculator</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">HamcrestAssertionsDemo</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Calculator</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Calculator</span><span class="o">();</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">assertWithHamcrestMatcher</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">calculator</span><span class="o">.</span><span class="na">subtract</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">1</span><span class="o">),</span> <span class="n">is</span><span class="o">(</span><span class="n">equalTo</span><span class="o">(</span><span class="mi">3</span><span class="o">)));</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>JUnit 4 のプログラミングモデルで作成したテストなら引き続き <code>org.junit.Assert#assertThat</code> メソッドを使用できます。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-assumptions"><a class="anchor" href="#writing-tests-assumptions"></a>2.5. アサンプション（仮定）</h3>
<div class="paragraph">
<p>JUnit Jupiter では、JUnit 4 で提供していたアサンプションメソッドの一部と、それらのメソッドを Java 8 のラムダ式でメソッド参照として使用できるようにしたメソッドを提供しています。
全てのアサンプションメソッドは <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/Assumptions.html">org.junit.jupiter.api.Assumptions</a></code> クラスの <code>static</code> メソッドとして定義されています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assumptions</span><span class="o">.</span><span class="na">assumeTrue</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assumptions</span><span class="o">.</span><span class="na">assumingThat</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">example.util.Calculator</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">AssumptionsDemo</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Calculator</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Calculator</span><span class="o">();</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testOnlyOnCiServer</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assumeTrue</span><span class="o">(</span><span class="s">"CI"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">getenv</span><span class="o">(</span><span class="s">"ENV"</span><span class="o">)));</span>
        <span class="c1">// remainder of test</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testOnlyOnDeveloperWorkstation</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assumeTrue</span><span class="o">(</span><span class="s">"DEV"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">getenv</span><span class="o">(</span><span class="s">"ENV"</span><span class="o">)),</span>
            <span class="o">()</span> <span class="o">-&gt;</span> <span class="s">"Aborting test: not on developer workstation"</span><span class="o">);</span>
        <span class="c1">// remainder of test</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testInAllEnvironments</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assumingThat</span><span class="o">(</span><span class="s">"CI"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">getenv</span><span class="o">(</span><span class="s">"ENV"</span><span class="o">)),</span>
            <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="c1">// perform these assertions only on the CI server</span>
                <span class="n">assertEquals</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">divide</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">2</span><span class="o">));</span>
            <span class="o">});</span>

        <span class="c1">// perform these assertions in all environments</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">42</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">multiply</span><span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">));</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
JUnit Jupiter 5.4 から JUnit 4 の <code>org.junit.Assume</code> クラスのメソッドをアサンプションメソッドとして使えるようになりました。
例えば、JUnit 4 の <code>AssumptionViolatedException</code> で、本来失敗とするべきテストを中断できるようになっています。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-disabling"><a class="anchor" href="#writing-tests-disabling"></a>2.6. テストを無効にする</h3>
<div class="paragraph">
<p><a href="#writing-tests-conditional-execution">条件に基づくテスト実行</a> で紹介した <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/Disabled.html">@Disabled</a></code> アノテーションで修飾したり、独自の <a href="#extensions-conditions"><code>ExecutionCondition</code></a> を作成したりすることで、テストクラス全体あるいは一部のテストメソッドだけを <em>無効</em> にできます。</p>
</div>
<div class="paragraph">
<p>次のコード例では <code>@Disabled</code> でテストクラスを無効にしています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Disabled</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="nd">@Disabled</span><span class="o">(</span><span class="s">"Disabled until bug #99 has been fixed"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">DisabledClassDemo</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testWillBeSkipped</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>次のコード例では <code>@Disabled</code> でテストメソッドを無効にしています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Disabled</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">DisabledTestsDemo</span> <span class="o">{</span>

    <span class="nd">@Disabled</span><span class="o">(</span><span class="s">"Disabled until bug #42 has been resolved"</span><span class="o">)</span>
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testWillBeSkipped</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testWillBeExecuted</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<em>理由（reason）</em> を指定せずに <code>@Disabled</code> を記述する場合もあると思います。
しかし、JUnit チームとしては、簡単でいいからテストクラスやテストメソッドを無効にする理由を書いたほうがいいと考えています。
コード例では <code>@Disabled("Disabled until bug \#42 has been resolved")</code> のように理由を書いています。
開発チームによっては、課題管理ツールに登録した課題を自動的に追跡できるよう、課題番号を書いている場合もあるそうです。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-conditional-execution"><a class="anchor" href="#writing-tests-conditional-execution"></a>2.7. 条件に基づくテスト実行</h3>
<div class="paragraph">
<p>JUnit Jupiter の <a href="#extensions-conditions"><code>ExecutionCondition</code></a> API を使うと、<em>手続き的に評価した条件</em> に応じて、テストコンテナやテストの <em>有効</em> と <em>無効</em> を制御できます。
組み込みの <code>ExecutionCondition</code> の中でも分かりやすいのは、<code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/Disabled.html">@Disabled</a></code> アノテーション（<a href="#writing-tests-disabling">テストを無効にする</a>）に対応する <code><a href="https://github.com/junit-team/junit5/tree/HEAD/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/DisabledCondition.java">DisabledCondition</a></code> です。
<code>org.junit.jupiter.api.condition</code> パッケージには、<code>@Disabled</code> 以外のさまざまなアノテーションに対応する <code>ExecutionCondition</code> があるため、開発者は <em>宣言的に</em> テストクラスやテストメソッドの <em>有効</em> や <em>無効</em> を制御できます。
複数の <code>ExecutionCondition</code> を登録した場合、どれか1つでも条件を満たせばテストコンテナやテストは直ちに <em>無効</em> になります。
組み込みの <code>ExecutionCondition</code> に対応する全てのアノテーションには <code>disabledReason</code> という属性があるため、テストを無効にした理由を提供できます。</p>
</div>
<div class="paragraph">
<p><a href="#extensions-conditions"><code>ExecutionCondition</code></a> や、次のセクションも参照してください。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">合成アノテーション</div>
<div class="paragraph">
<p>次のセクションで説明している、<em>条件として使用できる</em> 全てのアノテーションは、<em>合成アノテーション</em> を作るためのメタアノテーションとして使用できます。
例えば、 <a href="#writing-tests-conditional-execution-os-demo">@EnabledOnOs デモ</a> では <code>@Test</code> と <code>@EnabledOnOs</code> を組み合わせて単一の再利用可能なアノテーション <code>@TestOnMac</code> の作り方を説明しています。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>特別な記載がない限り、次のセクションで説明している <em>条件として使用できる</em> 全てのアノテーションは1度しか指定できません。
直接的に指定するだけでなく、継承やメタアノテーションにより間接的に指定する場合も含めて、JUnit は最初に発見したアノテーションだけを使用します。
他のアノテーションは無視されてしまうのです。
しかし、<code>org.junit.jupiter.api.condition</code> パッケージには、他のアノテーションと組み合わせたアノテーションもあるので注意してください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="writing-tests-conditional-execution-os"><a class="anchor" href="#writing-tests-conditional-execution-os"></a>2.7.1. OS の条件指定</h4>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/EnabledOnOs.html">@EnabledOnOs</a></code> や <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/DisabledOnOs.html">@DisabledOnOs</a></code> を使うと、指定した OS でテストコンテナやテストの有効と無効を制御できます。</p>
</div>
<div id="writing-tests-conditional-execution-os-demo" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Test</span>
<span class="nd">@EnabledOnOs</span><span class="o">(</span><span class="no">MAC</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">onlyOnMacOs</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@TestOnMac</span>
<span class="kt">void</span> <span class="nf">testOnMac</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@EnabledOnOs</span><span class="o">({</span> <span class="no">LINUX</span><span class="o">,</span> <span class="no">MAC</span> <span class="o">})</span>
<span class="kt">void</span> <span class="nf">onLinuxOrMac</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@DisabledOnOs</span><span class="o">(</span><span class="no">WINDOWS</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">notOnWindows</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Test</span>
<span class="nd">@EnabledOnOs</span><span class="o">(</span><span class="no">MAC</span><span class="o">)</span>
<span class="nd">@interface</span> <span class="nc">TestOnMac</span> <span class="o">{</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-conditional-execution-jre"><a class="anchor" href="#writing-tests-conditional-execution-jre"></a>2.7.2. Java 実行環境（JRE：Java Runtime Environment） の条件指定</h4>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/EnabledOnJre.html">@EnabledOnJre</a></code> や <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/DisabledOnJre.html">@DisabledOnJre</a></code> を使うと、指定した JRE でテストコンテナやテストの有効と無効を制御できます。
<code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/EnabledForJreRange.html">@EnabledForJreRange</a></code> や <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/DisabledForJreRange.html">@DisabledForJreRange</a></code> を使うと、JRE のバージョンを範囲指定できます。
範囲指定の最小値（<code>min</code>）の初期値は <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/JRE.html">JRE</a>.JAVA_8</code> で、最大値（<code>max</code>）の初期値は <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/JRE.html">JRE</a>.OTHER</code> です。
範囲は半開区間として評価します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Test</span>
<span class="nd">@EnabledOnJre</span><span class="o">(</span><span class="no">JAVA_8</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">onlyOnJava8</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@EnabledOnJre</span><span class="o">({</span> <span class="no">JAVA_9</span><span class="o">,</span> <span class="no">JAVA_10</span> <span class="o">})</span>
<span class="kt">void</span> <span class="nf">onJava9Or10</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@EnabledForJreRange</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="no">JAVA_9</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="no">JAVA_11</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">fromJava9to11</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@EnabledForJreRange</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="no">JAVA_9</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">fromJava9toCurrentJavaFeatureNumber</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@EnabledForJreRange</span><span class="o">(</span><span class="n">max</span> <span class="o">=</span> <span class="no">JAVA_11</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">fromJava8To11</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@DisabledOnJre</span><span class="o">(</span><span class="no">JAVA_9</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">notOnJava9</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@DisabledForJreRange</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="no">JAVA_9</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="no">JAVA_11</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">notFromJava9to11</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@DisabledForJreRange</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="no">JAVA_9</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">notFromJava9toCurrentJavaFeatureNumber</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@DisabledForJreRange</span><span class="o">(</span><span class="n">max</span> <span class="o">=</span> <span class="no">JAVA_11</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">notFromJava8to11</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-conditional-execution-system-properties"><a class="anchor" href="#writing-tests-conditional-execution-system-properties"></a>2.7.3. システムプロパティの条件指定</h4>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/EnabledIfSystemProperty.html">@EnabledIfSystemProperty</a></code> や <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/DisabledIfSystemProperty.html">@DisabledIfSystemProperty</a></code> を使うと、指定したシステムプロパティでテストコンテナやテストの有効と無効を制御できます。
<code>matches</code> 属性に指定した値は正規表現として評価します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Test</span>
<span class="nd">@EnabledIfSystemProperty</span><span class="o">(</span><span class="n">named</span> <span class="o">=</span> <span class="s">"os.arch"</span><span class="o">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="s">".*64.*"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">onlyOn64BitArchitectures</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@DisabledIfSystemProperty</span><span class="o">(</span><span class="n">named</span> <span class="o">=</span> <span class="s">"ci-server"</span><span class="o">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="s">"true"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">notOnCiServer</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>JUnit Jupiter 5.6 から、<code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/EnabledIfSystemProperty.html">@EnabledIfSystemProperty</a></code> と <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/DisabledIfSystemProperty.html">@DisabledIfSystemProperty</a></code> は <em>繰り返し可能なアノテーション</em> になりました。
その結果、これらのアノテーションはテストクラスやテストメソッドに複数回指定できるようになりました。
直接的に指定するだけでなく、継承やメタアノテーションにより間接的に指定する場合もあるでしょう。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-conditional-execution-environment-variables"><a class="anchor" href="#writing-tests-conditional-execution-environment-variables"></a>2.7.4. 環境変数の条件指定</h4>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/EnabledIfEnvironmentVariable.html">@EnabledIfEnvironmentVariable</a></code> や <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/DisabledIfEnvironmentVariable.html">@DisabledIfEnvironmentVariable</a></code> を使うと、指定したシステムプロパティでテストコンテナやテストの有効と無効を制御できます。
<code>matches</code> 属性に指定した値は正規表現として評価します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Test</span>
<span class="nd">@EnabledIfEnvironmentVariable</span><span class="o">(</span><span class="n">named</span> <span class="o">=</span> <span class="s">"ENV"</span><span class="o">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="s">"staging-server"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">onlyOnStagingServer</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@DisabledIfEnvironmentVariable</span><span class="o">(</span><span class="n">named</span> <span class="o">=</span> <span class="s">"ENV"</span><span class="o">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="s">".*development.*"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">notOnDeveloperWorkstation</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>JUnit Jupiter 5.6 から、<code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/EnabledIfEnvironmentVariable.html">@EnabledIfEnvironmentVariable</a></code> と <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/DisabledIfEnvironmentVariable.html">@DisabledIfEnvironmentVariable</a></code> は <em>繰り返し可能なアノテーション</em> になりました。
その結果、これらのアノテーションはテストクラスやテストメソッドに複数回指定できるようになりました。
直接的に指定するだけでなく、継承やメタアノテーションにより間接的に指定する場合もあるでしょう。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-conditional-execution-custom"><a class="anchor" href="#writing-tests-conditional-execution-custom"></a>2.7.5. 独自の条件指定</h4>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/EnabledIf.html">@EnabledIf</a></code> や <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/DisabledIf.html">@DisabledIf</a></code> を使うと、指定した名前のメソッドを実行したときの返り値に応じて、テストコンテナやテストの有効と無効を制御できます。
指定するメソッドには単一の引数 <code>ExtensionContext</code> を渡すことができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Test</span>
<span class="nd">@EnabledIf</span><span class="o">(</span><span class="s">"customCondition"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">enabled</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@DisabledIf</span><span class="o">(</span><span class="s">"customCondition"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">disabled</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="kt">boolean</span> <span class="nf">customCondition</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>一方、テストクラス以外の場所で定義されたメソッドを指定することもできます。
メソッド名は <em>完全修飾名</em> で指定しなければなりません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">package</span> <span class="nn">example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.condition.EnabledIf</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">ExternalCustomConditionDemo</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="nd">@EnabledIf</span><span class="o">(</span><span class="s">"example.ExternalCondition#customCondition"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">enabled</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ...</span>
    <span class="o">}</span>

<span class="o">}</span>

<span class="kd">class</span> <span class="nc">ExternalCondition</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">customCondition</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
テストクラスに <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/EnabledIf.html">@EnabledIf</a></code> や <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/condition/EnabledIf.html">@EnabledIf</a></code> を指定するときに指定できるメソッドは <code>static</code> 宣言しなければなりません。
テストクラス以外の場所で定義されたメソッドを指定するとして、そのメソッドも <code>static</code> 宣言しなければなりません。
それ以外の場合は <code>static</code> 宣言したメソッドと、インスタンスメソッドのどちらでも利用できます。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-tagging-and-filtering"><a class="anchor" href="#writing-tests-tagging-and-filtering"></a>2.8. タグ付けと選択</h3>
<div class="paragraph">
<p>テストクラスやテストメソッドには <code>@Tag</code> アノテーションでタグ付けが可能です。
タグは <a href="#running-tests">テストを検出して実行</a> するときにテストを選択するための条件に使用できます。
<a href="#running-tests-tags">タグ</a> セクションでは JUnit Platform のタグ機能について説明しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Tag</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="nd">@Tag</span><span class="o">(</span><span class="s">"fast"</span><span class="o">)</span>
<span class="nd">@Tag</span><span class="o">(</span><span class="s">"model"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">TaggingDemo</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="nd">@Tag</span><span class="o">(</span><span class="s">"taxes"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">testingTaxCalculation</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
タグ付けのためのアノテーションを作成する方法については <a href="#writing-tests-meta-annotations">メタアノテーションと合成アノテーション</a> を参照してください。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-test-execution-order"><a class="anchor" href="#writing-tests-test-execution-order"></a>2.9. テストの実行順序</h3>
<div class="paragraph">
<p>初期設定では、テストクラスやテストメソッドの実行順序が、意図的に曖昧にした決定論的なアルゴリズムで決まるようになっています。
テストスイートが実行するテストクラスやテストメソッドの順番は変わらないことが保証されているため、繰り返し可能なビルド（repeatable build）を推進してくれます。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<em>テストクラス</em> や <em>テストメソッド</em> の定義については <a href="#writing-tests-classes-and-methods">テストクラスとテストメソッド</a> を参照してください。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="writing-tests-test-execution-order-methods"><a class="anchor" href="#writing-tests-test-execution-order-methods"></a>2.9.1. テストメソッドの実行順序</h4>
<div class="paragraph">
<p>本物の <em>ユニットテスト</em> は普通ならどのような順番で実行しても同じ結果になるべきだと言われています。
しかし、どうしても実行する順番を指定しなければならないこともあります。
例えば、<em>統合テスト</em> や <em>機能テスト</em> を作成するときは順番が重要です。
特に <code>@TestInstance(Lifecycle.PER_CLASS)</code> も組み合わせているならなおのことです。</p>
</div>
<div class="paragraph">
<p>テストメソッドを実行する順番を制御するには、テストクラスやテストインターフェイスを <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/TestMethodOrder.html">@TestMethodOrder</a></code> アノテーションで修飾し、適切な <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/MethodOrderer.html">MethodOrderer</a></code> の実装を指定します。
<code>MethodOrderer</code> インターフェイスを自分で実装することもできますし、組み込みの実装を使うこともできます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/MethodOrderer.DisplayName.html">MethodOrderer.DisplayName</a></code>: テストメソッドの表示名に基づいて <em>英数字の昇順</em> に並び替えます。<a href="#writing-tests-display-name-generator-precedence-rules">表示名の決定規則</a> も参照してください</p>
</li>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/MethodOrderer.MethodName.html">MethodOrderer.MethodName</a></code>: テストメソッドの名前と形式的な引数リストの名前に基づいて <em>英数字の昇順</em> に並び替えます。</p>
</li>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/MethodOrderer.OrderAnnotation.html">MethodOrderer.OrderAnnotation</a></code>: <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/Order.html">@Order</a></code> アノテーションに指定した整数値に基づいて <em>数字の昇順</em> に並び替えます。</p>
</li>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/MethodOrderer.Random.html">MethodOrderer.Random</a></code>: <em>疑似乱数</em> に基づいて並び替えます。乱数の <em>シード</em> を指定できます。</p>
</li>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/MethodOrderer.Alphanumeric.html">MethodOrderer.Alphanumeric</a></code>: テストメソッドの名前と形式的な引数リストの名前に基づいて <em>英数字の昇順</em> に並び替えます。<strong><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/MethodOrderer.MethodName.html">MethodOrderer.MethodName</a></code> を導入したため非推奨になりました。6.0 をリリースするときに削除されます。</strong></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="#extensions-execution-order-wrapping-behavior">コールバックによる包み隠す振る舞い</a> も参照してください。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>次のコード例は <code>@Order</code> アノテーションでテストメソッドの実行順序を指定しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.junit.jupiter.api.MethodOrderer.OrderAnnotation</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Order</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.TestMethodOrder</span><span class="o">;</span>

<span class="nd">@TestMethodOrder</span><span class="o">(</span><span class="nc">OrderAnnotation</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">OrderedTestsDemo</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="nd">@Order</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">nullValues</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// perform assertions against null values</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@Order</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">emptyValues</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// perform assertions against empty values</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@Order</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">validValues</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// perform assertions against valid values</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-test-execution-order-methods-default"><a class="anchor" href="#writing-tests-test-execution-order-methods-default"></a>テストメソッドの実行順序の初期値を変更する</h5>
<div class="paragraph">
<p><code>junit.jupiter.testmethod.order.default</code> という <a href="#running-tests-config-params">設定パラメータ</a> で、JUnit Jupiter が初期値として使用する <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/MethodOrderer.html">MethodOrderer</a></code> の実装クラスの完全修飾クラス名を指定できます。
エンクロージングクラスやインターフェイスを <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/TestMethodOrder.html">@TestMethodOrder</a></code> アノテーションで修飾しない限り、常に <code>MethodOrderer</code> の初期値を使用します。
そして、<code>@TestMethodOrder</code> アノテーションで指定した順序決定ルールは常に優先されます。</p>
</div>
<div class="paragraph">
<p>初期値を <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/MethodOrderer.OrderAnnotation.html">MethodOrderer.OrderAnnotation</a></code> へ変更するには、プロパティファイル（例えば <code>src/test/resources/junit-platform.properties</code>）へ次のように記述します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="properties"><span class="py">junit.jupiter.testmethod.order.default</span> <span class="p">=</span> <span class="se">\
</span>    <span class="s">org.junit.jupiter.api.MethodOrderer$OrderAnnotation</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>自分で作成した <code>MethodOrderer</code> インターフェイスの実装クラスも同じように指定できます。</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-test-execution-order-classes"><a class="anchor" href="#writing-tests-test-execution-order-classes"></a>2.9.2. テストクラスの実行順序</h4>
<div class="paragraph">
<p>普通ならテストクラスをどのような順番で実行しても同じ結果になるべきだと言われています。
しかし、どうしても実行する順番を指定しなければならないこともあります。
テストクラス間に意図しない依存関係は存在しないことを保証するため、テストクラスをランダムな順序で実行したい場合もあるでしょう。
また、ビルド時間を最適化するため、実行順序を指定したい場合もあるでしょう。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>前回失敗したテストを先に実行したい: フェールファストモード</p>
</li>
<li>
<p>並列実行できるなら時間のかかるテストを先に実行したい: テスト実行時間最小化モード</p>
</li>
<li>
<p>それ以外のさまざまなユースケース</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>テストスイートの <em>大域的な</em> テストクラスの実行順序は、<code>junit.jupiter.testclass.order.default</code> という <a href="#running-tests-config-params">設定パラメータ</a> で、JUnit Jupiter が初期値として使用する <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/ClassOrderer.html">ClassOrderer</a></code> の実装クラスの完全修飾クラス名を指定できます。</p>
</div>
<div class="paragraph">
<p>自分で作成した <code>ClassOrderer</code> インターフェイスの実装クラスも同じように指定できます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/ClassOrderer.ClassName.html">ClassOrderer.ClassName</a></code>: テストクラスの完全修飾クラス名に基づいて <em>英数字の昇順</em> に並び替えます。</p>
</li>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/ClassOrderer.DisplayName.html">ClassOrderer.DisplayName</a></code>: テストクラスの表示名に基づいて <em>英数字の昇順</em> に並び替えます。<a href="#writing-tests-display-name-generator-precedence-rules">表示名の決定規則</a> も参照してください</p>
</li>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/ClassOrderer.OrderAnnotation.html">ClassOrderer.OrderAnnotation</a></code>: <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/Order.html">@Order</a></code> アノテーションに指定した整数値に基づいて <em>数字の昇順</em> に並び替えます。</p>
</li>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/ClassOrderer.Random.html">ClassOrderer.Random</a></code>: <em>疑似乱数</em> に基づいて並び替えます。乱数の <em>シード</em> を指定できます。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>次のコード例は <code>@Order</code> アノテーションで <em>テストクラス</em> の実行順序を指定しています。
初期値を <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/ClassOrderer.OrderAnnotation.html">ClassOrderer.OrderAnnotation</a></code> へ変更するには、プロパティファイル（例えば <code>src/test/resources/junit-platform.properties</code>）へ次のように記述します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="properties"><span class="py">junit.jupiter.testclass.order.default</span> <span class="p">=</span> <span class="se">\
</span>    <span class="s">org.junit.jupiter.api.ClassOrderer$OrderAnnotation</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>ClassOrder</code> は、全てのトップレベルテストクラス（<code>static</code> 宣言したネストテストクラスも含む）と <code>@Nested</code> で修飾したネストテストクラスに指定できます。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
トップレベルテストクラスの順序は同じトップレベルテストクラス同士で比較します。同じエンクロージングクラスのネストテストクラスの順序は、同じエンクロージングクラスのネストテストクラス同士で比較します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ネストテストクラスの <em>局所的な</em> 実行順序を指定するには、エンクロージングクラスを <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/TestClassOrder.html">@TestClassOrder</a></code> で修飾します。
そして <code>@TestClassOrder</code> アノテーションに <code>ClassOrder</code> を実装したクラスのクラス参照を直接指定します。
<code>ClassOrder</code> は再帰的にネストテストクラスを探索します。
<code>@TestClassOrder</code> の局所的な宣言は、基底クラスから継承した <code>@TestClassOrder</code> の宣言で上書きされます。
また、設定パラメータ <code>junit.jupiter.testclass.order.default</code> で大域的に宣言した <code>ClassOrder</code> で上書きされます。</p>
</div>
<div class="paragraph">
<p>次のコード例は <code>@Order</code> アノテーションで <em>ネストテストクラス</em> の実行順序を指定しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.junit.jupiter.api.ClassOrderer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Nested</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Order</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.TestClassOrder</span><span class="o">;</span>

<span class="nd">@TestClassOrder</span><span class="o">(</span><span class="nc">ClassOrderer</span><span class="o">.</span><span class="na">OrderAnnotation</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">OrderedNestedTestClassesDemo</span> <span class="o">{</span>

    <span class="nd">@Nested</span>
    <span class="nd">@Order</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="kd">class</span> <span class="nc">PrimaryTests</span> <span class="o">{</span>

        <span class="nd">@Test</span>
        <span class="kt">void</span> <span class="nf">test1</span><span class="o">()</span> <span class="o">{</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Nested</span>
    <span class="nd">@Order</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
    <span class="kd">class</span> <span class="nc">SecondaryTests</span> <span class="o">{</span>

        <span class="nd">@Test</span>
        <span class="kt">void</span> <span class="nf">test2</span><span class="o">()</span> <span class="o">{</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-test-instance-lifecycle"><a class="anchor" href="#writing-tests-test-instance-lifecycle"></a>2.10. テストインスタンスのライフサイクル</h3>
<div class="paragraph">
<p>それぞれのテストメソッドが独立して実行できるよう、そして、変更可能なテストインスタンスの状態に基づく予期せぬ副作用を無くすため、JUnit は <em>テストメソッド</em> （<a href="#writing-tests-classes-and-methods">テストクラスとテストメソッド</a>）を実行するたびに、テストクラスの新しいインスタンスを作るようにしました。
この、メソッド単位（per-method）のインスタンスライフサイクル管理は、JUnit Jupiter の基本的な振る舞いであり、過去の全ての JUnit と同じものです。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
メソッド単位（per-method）のインスタンスライフサイクル管理が有効になっているなら、テストメソッドが <em>無効</em> になっても、テストクラスのインスタンスは作成するので注意してください（<a href="#writing-tests-conditional-execution">条件に基づくテスト実行</a> や <code>@Disabled</code> アノテーションなど）。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>JUnit Jupiter に同じインスタンスで全てのテストメソッドを実行させたいときは、テストクラスを <code>@TestInstance(Lifecycle.PER_CLASS)</code> で修飾しましょう。
そうすると、テストクラスのインスタンスを1度しか作らなくなります。
テストメソッドがインスタンス変数に記録した状態へ依存しているなら、<code>@BeforeEach</code> や <code>@AfterEach</code> のメソッドで状態を初期化しなければなりません。</p>
</div>
<div class="paragraph">
<p>クラス単位（per-class）のインスタンスライフサイクル管理にはメソッド単位（per-method）にない利点があります。
それは、<code>@BeforeAll</code> や <code>@AfterAll</code> のメソッドに <code>static</code> 宣言が不要になることです（同様に、インターフェイスの <code>default</code> メソッドも不要になります）。
クラス単位（per-class）のインスタンスライフサイクル管理では、ネストテストクラスで <code>@BeforeAll</code> と <code>@AfterAll</code> を使うこともできます。</p>
</div>
<div class="paragraph">
<p>Kotlin でテストを書いているときも、クラス単位（per-class）のインスタンスライフサイクル管理 にしたほうが、<code>@BeforeAll</code> や <code>@AfterAll</code> をメソッドで実装できるので便利でしょう。</p>
</div>
<div class="sect3">
<h4 id="writing-tests-test-instance-lifecycle-changing-default"><a class="anchor" href="#writing-tests-test-instance-lifecycle-changing-default"></a>2.10.1. インスタンスライフサイクル管理の初期値を変更する</h4>
<div class="paragraph">
<p>テストクラスやテストインターフェイスを <code>@TestInstance</code> で修飾していないとき、JUnit Jupiter は <em>既定</em> のインスタンスライフサイクル管理をします。
本来の <em>初期値</em> は <code>PER_METHOD</code> ですが、テスト実行計画全体で変更できます。
インスタンスライフサイクル管理の初期値を変更するには、<code>junit.jupiter.testinstance.lifecycle.default</code> という <em>設定パラメータ</em> に、<code>TestInstance.Lifecycle</code> の列挙値を設定します（大文字小文字の違いは無視します）。
JVM のシステムプロパティや、<code>Launcher</code> に渡す <code>LauncherDiscoveryRequest</code> の <em>設定パラメータ</em> 、JUnit Platform の設定ファイル（<a href="#running-tests-config-params">設定パラメータの構成</a> を参照）で指定することもできます。</p>
</div>
<div class="paragraph">
<p>システムプロパティでインスタンスライフサイクル管理の初期値に <code>Lifecycle.PER_CLASS</code> を設定するには次のように指定します。</p>
</div>
<div class="paragraph">
<p><code>-Djunit.jupiter.testinstance.lifecycle.default=per_class</code></p>
</div>
<div class="paragraph">
<p>いろいろ指定する方法あありますが、JUnit Platform の設定ファイルで指定するのが最も確実な方法です。
JUnit Platform の設定ファイルはソースコードリポジトリに格納してバージョン管理して、IDE やビルドツールから利用できるようにするといいでしょう。、</p>
</div>
<div class="paragraph">
<p>JUnit Platform の設定ファイルでインスタンスライフサイクル管理の初期値に <code>Lifecycle.PER_CLASS</code> を設定するには次のように記述します（例えば <code>rsc/test/resources/junit-platform.properties</code>）。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="properties"><span class="py">junit.jupiter.testinstance.lifecycle.default</span> <span class="p">=</span> <span class="s">per_class</span></code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
インスタンスライフサイクル管理の初期値を不適切な値に変更すると、テストの結果が予測不能になったり、不安定になったりします。
例えば、ビルドツールの初期値をクラス単位（per-class）にしたのに、IDE ではメソッド単位（per-method）でテストを実行していると、ビルドジョブで解析の難しいエラーが発生します。
それゆえに、システムプロパティではなく JUnit Platform の設定ファイルで初期値を変更することをお勧めします。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-nested"><a class="anchor" href="#writing-tests-nested"></a>2.11. ネストテストクラス</h3>
<div class="paragraph">
<p><code>@Nested</code> アノテーションを使うと、いろいろなグループのテストの関係性をより分かりやすく表現できるようになります。
Java の内部クラスでテストの階層構造を考えられるようになるからです。
次のコード例をIDEで実行した結果は次のとおりです。</p>
</div>
<div class="listingblock">
<div class="title">内部クラスで構成したスタック型データ構造のテストスイート</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertFalse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertThrows</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.EmptyStackException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Stack</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Nested</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"A stack"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">TestingAStackDemo</span> <span class="o">{</span>

    <span class="nc">Stack</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="n">stack</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"is instantiated with new Stack()"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">isInstantiatedWithNew</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nc">Stack</span><span class="o">&lt;&gt;();</span>
    <span class="o">}</span>

    <span class="nd">@Nested</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"when new"</span><span class="o">)</span>
    <span class="kd">class</span> <span class="nc">WhenNew</span> <span class="o">{</span>

        <span class="nd">@BeforeEach</span>
        <span class="kt">void</span> <span class="nf">createNewStack</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">stack</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Stack</span><span class="o">&lt;&gt;();</span>
        <span class="o">}</span>

        <span class="nd">@Test</span>
        <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"is empty"</span><span class="o">)</span>
        <span class="kt">void</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">assertTrue</span><span class="o">(</span><span class="n">stack</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
        <span class="o">}</span>

        <span class="nd">@Test</span>
        <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"throws EmptyStackException when popped"</span><span class="o">)</span>
        <span class="kt">void</span> <span class="nf">throwsExceptionWhenPopped</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">assertThrows</span><span class="o">(</span><span class="nc">EmptyStackException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nl">stack:</span><span class="o">:</span><span class="n">pop</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="nd">@Test</span>
        <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"throws EmptyStackException when peeked"</span><span class="o">)</span>
        <span class="kt">void</span> <span class="nf">throwsExceptionWhenPeeked</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">assertThrows</span><span class="o">(</span><span class="nc">EmptyStackException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nl">stack:</span><span class="o">:</span><span class="n">peek</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="nd">@Nested</span>
        <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"after pushing an element"</span><span class="o">)</span>
        <span class="kd">class</span> <span class="nc">AfterPushing</span> <span class="o">{</span>

            <span class="nc">String</span> <span class="n">anElement</span> <span class="o">=</span> <span class="s">"an element"</span><span class="o">;</span>

            <span class="nd">@BeforeEach</span>
            <span class="kt">void</span> <span class="nf">pushAnElement</span><span class="o">()</span> <span class="o">{</span>
                <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">anElement</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nd">@Test</span>
            <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"it is no longer empty"</span><span class="o">)</span>
            <span class="kt">void</span> <span class="nf">isNotEmpty</span><span class="o">()</span> <span class="o">{</span>
                <span class="n">assertFalse</span><span class="o">(</span><span class="n">stack</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
            <span class="o">}</span>

            <span class="nd">@Test</span>
            <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"returns the element when popped and is empty"</span><span class="o">)</span>
            <span class="kt">void</span> <span class="nf">returnElementWhenPopped</span><span class="o">()</span> <span class="o">{</span>
                <span class="n">assertEquals</span><span class="o">(</span><span class="n">anElement</span><span class="o">,</span> <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">());</span>
                <span class="n">assertTrue</span><span class="o">(</span><span class="n">stack</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
            <span class="o">}</span>

            <span class="nd">@Test</span>
            <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"returns the element when peeked but remains not empty"</span><span class="o">)</span>
            <span class="kt">void</span> <span class="nf">returnElementWhenPeeked</span><span class="o">()</span> <span class="o">{</span>
                <span class="n">assertEquals</span><span class="o">(</span><span class="n">anElement</span><span class="o">,</span> <span class="n">stack</span><span class="o">.</span><span class="na">peek</span><span class="o">());</span>
                <span class="n">assertFalse</span><span class="o">(</span><span class="n">stack</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>このテストを IDE で実行すると、実行結果は同じような木構造になります。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/writing-tests_nested_test_ide.png" alt="writing tests nested test ide">
</div>
<div class="title">Executing a nested test in an IDE</div>
</div>
<div class="paragraph">
<p>この場合、内側のテストで階層的なライフサイクルメソッドを定義することで、外側のテストの事前条件を内側のテストで使用しているのが分かります。
<code>createNewStack()</code> は <code>@BeforeEach</code> で修飾されたライフサイクルメソッドで、メソッドを定義したクラスと、その内側のクラスのテストメソッドを実行するときに使用します。</p>
</div>
<div class="paragraph">
<p>外側のテストのセットアップは内側のテストより先に実行するため、結果として全てのテストを独立して実行できることになります。
内側のテストを実行するときは常に外側のテストのセットアップを実行するので、内側のテストだけを実行できるのです。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@Nested</code> で修飾できるのは <em>static でない内部クラス（インナークラス）</em> だけです。
どれだけネストが深くなったとしても内部クラスか1つの例外を除いて完全なライフサイクルに対応しています。
例外とは、<code>@BeforeAll</code> と <code>@AfterAll</code> が <em>初期設定</em> では動作しないことです。
Java の内部クラスは <code>static</code> メンバを定義できないからです。
ただし、ネストテストクラスを <code>@TestInstance(Lifecycle.PER_CLASS)</code> で修飾すればその例外を回避できます（<a href="#writing-tests-test-instance-lifecycle">テストインスタンスのライフサイクル</a> を参照）。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-dependency-injection"><a class="anchor" href="#writing-tests-dependency-injection"></a>2.12. コンストラクタやメソッドによる依存性の注入</h3>
<div class="paragraph">
<p>過去の JUnit ではテストクラスのコンストラクタやテストメソッドに引数を定義できませんでした（少なくとも標準の <code>Runner</code> ではそうでした）。
JUnit Jupiter における重要な変更点の1つは、テストクラスのコンストラクタやテストメソッドに引数を定義できるようになったことです。
優れた柔軟性をもたらすだけでなく、<em>依存性の注入</em> ができるようになったのです。</p>
</div>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/ParameterResolver.html">ParameterResolver</a></code> は JUnit の拡張機能が実行時に <em>動的に</em> パラメータを解決するための API を定義しています。
<code>ParameterResolver</code> を登録しておくと、実行時に <em>テストクラス</em> のコンストラクタや <em>テストメソッド</em> あるいは <em>ライフサイクルメソッド</em> の引数を解決してくれるのです（<a href="#writing-tests-classes-and-methods">テストクラスとテストメソッド</a> を参照）。</p>
</div>
<div class="paragraph">
<p>現在は次の3種類の組み込みリゾルバーが自動的に登録されるようになっています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="https://github.com/junit-team/junit5/tree/HEAD/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/TestInfoParameterResolver.java">TestInfoParameterResolver</a></code>: コンストラクタやメソッドに <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/TestInfo.html">TestInfo</a></code> 型の引数があれば、<code>TestInfoParameterResolver</code> が今のテストコンテナあるいはテストの情報を持つ <code>TestInfo</code> のインスタンスを設定します。
設定された <code>TestInfo</code> から、今のテストコンテナやテストの情報（例えば表示名、テストクラス名、テストメソッド名、割り当てられたタグなど）を取得できます。
表示名はクラス名やメソッド名、あるいは、<code>@DisplayName</code> で指定された名前になります。</p>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/TestInfo.html">TestInfo</a></code> は JUnit 4 の <code>TestName</code> ルールを置き換える部品として使用できます。
次のコード例ではテストクラスのコンストラクタと <code>@BeforeEach</code> メソッド、テストメソッドに <code>TestInfo</code> を注入しています。</p>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Tag</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.TestInfo</span><span class="o">;</span>

<span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"TestInfo Demo"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">TestInfoDemo</span> <span class="o">{</span>

    <span class="nc">TestInfoDemo</span><span class="o">(</span><span class="nc">TestInfo</span> <span class="n">testInfo</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"TestInfo Demo"</span><span class="o">,</span> <span class="n">testInfo</span><span class="o">.</span><span class="na">getDisplayName</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@BeforeEach</span>
    <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="nc">TestInfo</span> <span class="n">testInfo</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">displayName</span> <span class="o">=</span> <span class="n">testInfo</span><span class="o">.</span><span class="na">getDisplayName</span><span class="o">();</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="n">displayName</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"TEST 1"</span><span class="o">)</span> <span class="o">||</span> <span class="n">displayName</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"test2()"</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"TEST 1"</span><span class="o">)</span>
    <span class="nd">@Tag</span><span class="o">(</span><span class="s">"my-tag"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">test1</span><span class="o">(</span><span class="nc">TestInfo</span> <span class="n">testInfo</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"TEST 1"</span><span class="o">,</span> <span class="n">testInfo</span><span class="o">.</span><span class="na">getDisplayName</span><span class="o">());</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="n">testInfo</span><span class="o">.</span><span class="na">getTags</span><span class="o">().</span><span class="na">contains</span><span class="o">(</span><span class="s">"my-tag"</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test2</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="https://github.com/junit-team/junit5/tree/HEAD/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/RepetitionInfoParameterResolver.java">RepetitionInfoParameterResolver</a></code>: <code>@RepeatedTest, @BeforeEach, @AfterEach</code> で修飾したメソッドに <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/RepetitionInfo.html">RepetitionInfo</a></code> 型の引数があれば、<code>RepetitionInfoParameterResolver</code> が <code>RepetitionInfo</code> のインスタンスを設定します。
設定された <code>RepetitionInfo</code> から、今の繰り返し情報と <code>@RepeatedTest</code> に指定された繰り返し数の合計値を取得できます。
<code>@RepeatedTest</code> の外側のコンテキストでは <code>RepetitionInfoParameterResolver</code> を登録しないので注意してください。<a href="#writing-tests-repeated-tests-examples">繰り返しテストの具体例</a> も参照してください。</p>
</li>
<li>
<p><code><a href="https://github.com/junit-team/junit5/tree/HEAD/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/TestReporterParameterResolver.java">TestReporterParameterResolver</a></code>: コンストラクタやメソッドに <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/TestReporter.html">TestReporter</a></code> 型の引数があれば, <code>TestReporterParameterResolver</code> が <code>TestReporter</code> のインスタンスを設定します。
設定された <code>TestReporter</code> で、実行しているテストに関するデータを公開できます。
公開したデータは <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/TestExecutionListener.html">TestExecutionListener</a></code> の <code>reportingEntryPublished()</code> メソッドで取得できるので、IDE に表示したりレポートに出力したりできます。</p>
<div class="paragraph">
<p>JUnit 4 で標準出力と標準エラー出力へテストの結果を出力していた場合、JUnit Jupiter では <code>TestReporter</code> を使わなければいけません。
テストクラスを <code>@RunWith(JUnitPlatform.class)</code> で修飾すると、全ての出力を標準出力へ書き込むようになります。
また、IDE によっては、テストの結果を標準出力と UI の両方に出力します。</p>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">TestReporterDemo</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">reportSingleValue</span><span class="o">(</span><span class="nc">TestReporter</span> <span class="n">testReporter</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">testReporter</span><span class="o">.</span><span class="na">publishEntry</span><span class="o">(</span><span class="s">"a status message"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">reportKeyValuePair</span><span class="o">(</span><span class="nc">TestReporter</span> <span class="n">testReporter</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">testReporter</span><span class="o">.</span><span class="na">publishEntry</span><span class="o">(</span><span class="s">"a key"</span><span class="o">,</span> <span class="s">"a value"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">reportMultipleKeyValuePairs</span><span class="o">(</span><span class="nc">TestReporter</span> <span class="n">testReporter</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">values</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"user name"</span><span class="o">,</span> <span class="s">"dk38"</span><span class="o">);</span>
        <span class="n">values</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"award year"</span><span class="o">,</span> <span class="s">"1974"</span><span class="o">);</span>

        <span class="n">testReporter</span><span class="o">.</span><span class="na">publishEntry</span><span class="o">(</span><span class="n">values</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
他のパラメータリゾルバーを使いたければ適切な拡張機能を <code>@ExtendWith</code> で登録しなければなりません。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/ParameterResolver.html">ParameterResolver</a></code> の実装例として <code><a href="https://github.com/junit-team/junit5-samples/tree/HEAD/junit5-jupiter-extensions/src/main/java/com/example/random/RandomParametersExtension.java">RandomParametersExtension</a></code> を見てみましょう。
拡張モデルとパラメータ解決処理を説明するため、短く、分かりやすくしています。
また、<code>MyRandomParametersTest</code> でその使い方を説明します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">RandomParametersExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MyRandomParametersTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">injectsInteger</span><span class="o">(</span><span class="nd">@Random</span> <span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="nd">@Random</span> <span class="kt">int</span> <span class="n">j</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">assertNotEquals</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">injectsDouble</span><span class="o">(</span><span class="nd">@Random</span> <span class="kt">double</span> <span class="n">d</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mf">0.0</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>現実的な例は <code><a href="https://github.com/mockito/mockito/blob/release/2.x/subprojects/junit-jupiter/src/main/java/org/mockito/junit/jupiter/MockitoExtension.java">MockitoExtension</a></code> や <code><a href="https://github.com/spring-projects/spring-framework/tree/HEAD/spring-test/src/main/java/org/springframework/test/context/junit/jupiter/SpringExtension.java">SpringExtension</a></code> のソースコードを参照してください。</p>
</div>
<div class="paragraph">
<p>作成した <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/ParameterResolver.html">ParameterResolver</a></code> が引数の型だけで値を注入するかどうかを判断するなら、総称型の <code><a href="https://github.com/junit-team/junit5/tree/HEAD/junit-jupiter-api/src/main/java/org/junit/jupiter/api/extension/support/TypeBasedParameterResolver.java">TypeBasedParameterResolver</a></code> を基底クラスにするといいでしょう。
<code>supportsParameters</code> メソッドが対応する引数の型の情報を隠蔽します。</p>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-test-interfaces-and-default-methods"><a class="anchor" href="#writing-tests-test-interfaces-and-default-methods"></a>2.13. テストインターフェイスとデフォルトメソッド</h3>
<div class="paragraph">
<p>JUnit Jupiter ではインターフェイスのデフォルトメソッドを <code>@Test, @RepeatedTest, @ParameterizedTest, @TestFactory, @TestTemplate, @BeforeEach, @AfterEach</code> で修飾できるようになりました。
インターフェイスやクラスを <code>@TestInstance(Lifecycle.PER_CLASS)</code> （<a href="#writing-tests-test-instance-lifecycle">テストインスタンスのライフサイクル</a> を参照）で修飾しているなら、<code>static</code> メソッドやインターフェイスのデフォルトメソッドを <code>@BeforeAll, @AfterAll</code> で修飾できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@TestInstance</span><span class="o">(</span><span class="nc">Lifecycle</span><span class="o">.</span><span class="na">PER_CLASS</span><span class="o">)</span>
<span class="kd">interface</span> <span class="nc">TestLifecycleLogger</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="nc">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">TestLifecycleLogger</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>

    <span class="nd">@BeforeAll</span>
    <span class="k">default</span> <span class="kt">void</span> <span class="nf">beforeAllTests</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Before all tests"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@AfterAll</span>
    <span class="k">default</span> <span class="kt">void</span> <span class="nf">afterAllTests</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"After all tests"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@BeforeEach</span>
    <span class="k">default</span> <span class="kt">void</span> <span class="nf">beforeEachTest</span><span class="o">(</span><span class="nc">TestInfo</span> <span class="n">testInfo</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"About to execute [%s]"</span><span class="o">,</span>
            <span class="n">testInfo</span><span class="o">.</span><span class="na">getDisplayName</span><span class="o">()));</span>
    <span class="o">}</span>

    <span class="nd">@AfterEach</span>
    <span class="k">default</span> <span class="kt">void</span> <span class="nf">afterEachTest</span><span class="o">(</span><span class="nc">TestInfo</span> <span class="n">testInfo</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"Finished executing [%s]"</span><span class="o">,</span>
            <span class="n">testInfo</span><span class="o">.</span><span class="na">getDisplayName</span><span class="o">()));</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">interface</span> <span class="nc">TestInterfaceDynamicTestsDemo</span> <span class="o">{</span>

    <span class="nd">@TestFactory</span>
    <span class="k">default</span> <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsForPalindromes</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"racecar"</span><span class="o">,</span> <span class="s">"radar"</span><span class="o">,</span> <span class="s">"mom"</span><span class="o">,</span> <span class="s">"dad"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">text</span> <span class="o">-&gt;</span> <span class="n">dynamicTest</span><span class="o">(</span><span class="n">text</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">isPalindrome</span><span class="o">(</span><span class="n">text</span><span class="o">))));</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>テストインターフェイスの実装クラスは、テストインターフェイスを修飾した <code>@ExtendWith, @Tag</code> を自動的に継承します。
<a href="#extensions-lifecycle-callbacks-before-after-execution">テスト実行の前、および、後のコールバック</a> の実装例を、<a href="#extensions-lifecycle-callbacks-timing-extension">TimingExtension</a> のソースコードで確認しましょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Tag</span><span class="o">(</span><span class="s">"timed"</span><span class="o">)</span>
<span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">TimingExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">interface</span> <span class="nc">TimeExecutionLogger</span> <span class="o">{</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>これらのインターフェイスをテストクラスで実装すると次のようになります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">TestInterfaceDemo</span> <span class="kd">implements</span> <span class="nc">TestLifecycleLogger</span><span class="o">,</span>
        <span class="nc">TimeExecutionLogger</span><span class="o">,</span> <span class="nc">TestInterfaceDynamicTestsDemo</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">isEqualValue</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"a"</span><span class="o">.</span><span class="na">length</span><span class="o">(),</span> <span class="s">"is always equal"</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>TestInterfaceDemo</code> を実行すると次のような出力が得られるでしょう。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>INFO  example.TestLifecycleLogger - Before all tests
INFO  example.TestLifecycleLogger - About to execute [dynamicTestsForPalindromes()]
INFO  example.TimingExtension - Method [dynamicTestsForPalindromes] took 19 ms.
INFO  example.TestLifecycleLogger - Finished executing [dynamicTestsForPalindromes()]
INFO  example.TestLifecycleLogger - About to execute [isEqualValue()]
INFO  example.TimingExtension - Method [isEqualValue] took 1 ms.
INFO  example.TestLifecycleLogger - Finished executing [isEqualValue()]
INFO  example.TestLifecycleLogger - After all tests</pre>
</div>
</div>
<div class="paragraph">
<p>この機能を応用して、インターフェイスを契約とするテストを作成できます。
例えば、<code>Object.equals</code> や <code>Comparable.compareTo</code> の実装に関するテストは次のように記述できるでしょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Testable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="no">T</span> <span class="nf">createValue</span><span class="o">();</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">EqualsContract</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="nc">Testable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="no">T</span> <span class="nf">createNotEqualValue</span><span class="o">();</span>

    <span class="nd">@Test</span>
    <span class="k">default</span> <span class="kt">void</span> <span class="nf">valueEqualsItself</span><span class="o">()</span> <span class="o">{</span>
        <span class="no">T</span> <span class="n">value</span> <span class="o">=</span> <span class="n">createValue</span><span class="o">();</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="n">value</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="k">default</span> <span class="kt">void</span> <span class="nf">valueDoesNotEqualNull</span><span class="o">()</span> <span class="o">{</span>
        <span class="no">T</span> <span class="n">value</span> <span class="o">=</span> <span class="n">createValue</span><span class="o">();</span>
        <span class="n">assertFalse</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="kc">null</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="k">default</span> <span class="kt">void</span> <span class="nf">valueDoesNotEqualDifferentValue</span><span class="o">()</span> <span class="o">{</span>
        <span class="no">T</span> <span class="n">value</span> <span class="o">=</span> <span class="n">createValue</span><span class="o">();</span>
        <span class="no">T</span> <span class="n">differentValue</span> <span class="o">=</span> <span class="n">createNotEqualValue</span><span class="o">();</span>
        <span class="n">assertNotEquals</span><span class="o">(</span><span class="n">value</span><span class="o">,</span> <span class="n">differentValue</span><span class="o">);</span>
        <span class="n">assertNotEquals</span><span class="o">(</span><span class="n">differentValue</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ComparableContract</span><span class="o">&lt;</span><span class="no">T</span> <span class="kd">extends</span> <span class="nc">Comparable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;&gt;</span> <span class="kd">extends</span> <span class="nc">Testable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="no">T</span> <span class="nf">createSmallerValue</span><span class="o">();</span>

    <span class="nd">@Test</span>
    <span class="k">default</span> <span class="kt">void</span> <span class="nf">returnsZeroWhenComparedToItself</span><span class="o">()</span> <span class="o">{</span>
        <span class="no">T</span> <span class="n">value</span> <span class="o">=</span> <span class="n">createValue</span><span class="o">();</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">value</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">value</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="k">default</span> <span class="kt">void</span> <span class="nf">returnsPositiveNumberWhenComparedToSmallerValue</span><span class="o">()</span> <span class="o">{</span>
        <span class="no">T</span> <span class="n">value</span> <span class="o">=</span> <span class="n">createValue</span><span class="o">();</span>
        <span class="no">T</span> <span class="n">smallerValue</span> <span class="o">=</span> <span class="n">createSmallerValue</span><span class="o">();</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">smallerValue</span><span class="o">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="k">default</span> <span class="kt">void</span> <span class="nf">returnsNegativeNumberWhenComparedToLargerValue</span><span class="o">()</span> <span class="o">{</span>
        <span class="no">T</span> <span class="n">value</span> <span class="o">=</span> <span class="n">createValue</span><span class="o">();</span>
        <span class="no">T</span> <span class="n">smallerValue</span> <span class="o">=</span> <span class="n">createSmallerValue</span><span class="o">();</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="n">smallerValue</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">value</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>それぞれのインターフェイスをテストクラスで実装すると、それぞれのテストを継承することになります。
もちろん、インターフェイスメソッドは実装しなければなりません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">StringTests</span> <span class="kd">implements</span> <span class="nc">ComparableContract</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;,</span> <span class="nc">EqualsContract</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">createValue</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"banana"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">createSmallerValue</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"apple"</span><span class="o">;</span> <span class="c1">// 'a' &lt; 'b' in "banana"</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">createNotEqualValue</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"cherry"</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
これらのコード例は説明用で、完全なものではありません。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-repeated-tests"><a class="anchor" href="#writing-tests-repeated-tests"></a>2.14. 繰り返しテスト</h3>
<div class="paragraph">
<p>JUnit Jupiter では <code>@RepeatedTest</code> でテストを繰り返し実行する回数、あるいは、繰り返し回数の最大値を指定してテストを実行できるようになりました。
繰り返しごとに実行するテストメソッドは、<code>@Test</code> で修飾した通常のテストメソッドと完全に同じライフサイクルと拡張機能に対応しています。</p>
</div>
<div class="paragraph">
<p>次のコード例では、<code>repeatedTest()</code> を10回繰り返すようになっています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@RepeatedTest</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">repeatedTest</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>繰り返し実行する回数を指定するだけでなく、<code>name</code> 属性で表示名を変更できるようになっています。
表示名は、文字列リテラルとプレースホルダを組み合わせたパターン文字列です。
現在対応しているプレースホルダは次のとおりです。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>{displayName}</code>: <code>@RepeatedTest</code> で修飾したメソッド名</p>
</li>
<li>
<p><code>{currentRepetition}</code>: 現在の繰り返し回数</p>
</li>
<li>
<p><code>{totalRepetitions}</code>: 繰り返し回数の最大値</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>表示名の初期値は <code>"repetition {currentRepetition} of {totalRepetitions}"</code> です。
従って、前のコード例では繰り返しごとの表示名は <code>repetition 1 of 10</code>、 <code>repetition 2 of 10</code> のようになります。
それぞれの表示名にテストメソッド名を含めたい場合は、独自のパターン文字列を指定するか、定義済みの <code>RepeatedTest.LONG_DISPLAY_NAME</code> を指定するといいでしょう。
<code>RepeatedTest.LONG_DISPLAY_NAME</code> は <code>"{displayName} :: repetition {currentRepetition} of {totalRepetitions}"</code> と同じ内容で、<code>repeatedTest() :: repetition 1 of 10</code>、 <code>repeatedTest() :: repetition 2 of 10</code> のように出力されます。</p>
</div>
<div class="paragraph">
<p><code>@RepeatedTest, @BeforeEach, @AfterEach</code> で修飾したメソッドの内部から、現在の繰り返し回数や、繰り返し回数の最大値を取得したい場合、メソッド引数に <code>RepetitionInfo</code> 型の引数を宣言し、インスタンスを注入させることができます。</p>
</div>
<div class="sect3">
<h4 id="writing-tests-repeated-tests-examples"><a class="anchor" href="#writing-tests-repeated-tests-examples"></a>2.14.1. 繰り返しテストの具体例</h4>
<div class="paragraph">
<p>繰り返しテストのさまざまな使い方を <code>RepeatedTestsDemo</code> クラスで説明していきます。</p>
</div>
<div class="paragraph">
<p><code>repeatedTest()</code> メソッドの使い方は前のセクションで説明したのと同じです。
<code>repeatedTestWithRepetitionInfo()</code> メソッドは <code>RepetitionInfo</code> でメソッドの中から繰り返し回数などの情報を取得しています。</p>
</div>
<div class="paragraph">
<p><code>customDisplayName()</code> メソッドは <code>@DisplayName</code> と <code>@RepeatedTest</code> で変更した表示名を <code>TestInfo</code> から取得して、生成された名前の形式が合っているか検証しています。
<code>Repeat!</code> はプレースホルダの <code>{displayName}</code> を <code>@DisplayName</code> の値で置換したものです。
<code>1/1</code> はプレースホルダの <code>{currentRepetition}/{totalRepetitions}</code> を置換したものです。
逆に <code>customDisplayNameWithLongPattern()</code> メソッドでは表示名のパターンとして <code>RepeatedTest.LONG_DISPLAY_NAME</code> を使っています。</p>
</div>
<div class="paragraph">
<p><code>repeatedTestInGerman()</code> メソッドは繰り返しテストで表示名をローカライズする方法を示しています。
ここではドイツ語へ翻訳しているので、<code>Wiederholung 1 von 5</code>, <code>Wiederholung 2 von 5</code> のようになります。</p>
</div>
<div class="paragraph">
<p><code>@BeforeEach</code> で修飾した <code>beforeEach()</code> メソッドは、それぞれの繰り返しテストを実行する前に実行します。
メソッド引数に注入した <code>TestInfo</code> と <code>RepetitionInfo</code> から、実行しているテストメソッドの情報を取得できます。
ログレベルを <code>INFO</code> に設定してテストクラス <code>RepeatedTestsDemo</code> を実行すると、次のような出力が得られるでしょう。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>INFO: About to execute repetition 1 of 10 for repeatedTest
INFO: About to execute repetition 2 of 10 for repeatedTest
INFO: About to execute repetition 3 of 10 for repeatedTest
INFO: About to execute repetition 4 of 10 for repeatedTest
INFO: About to execute repetition 5 of 10 for repeatedTest
INFO: About to execute repetition 6 of 10 for repeatedTest
INFO: About to execute repetition 7 of 10 for repeatedTest
INFO: About to execute repetition 8 of 10 for repeatedTest
INFO: About to execute repetition 9 of 10 for repeatedTest
INFO: About to execute repetition 10 of 10 for repeatedTest
INFO: About to execute repetition 1 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 2 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 3 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 4 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 5 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 1 of 1 for customDisplayName
INFO: About to execute repetition 1 of 1 for customDisplayNameWithLongPattern
INFO: About to execute repetition 1 of 5 for repeatedTestInGerman
INFO: About to execute repetition 2 of 5 for repeatedTestInGerman
INFO: About to execute repetition 3 of 5 for repeatedTestInGerman
INFO: About to execute repetition 4 of 5 for repeatedTestInGerman
INFO: About to execute repetition 5 of 5 for repeatedTestInGerman</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.logging.Logger</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.RepeatedTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.RepetitionInfo</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.TestInfo</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">RepeatedTestsDemo</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="c1">// ...</span>

    <span class="nd">@BeforeEach</span>
    <span class="kt">void</span> <span class="nf">beforeEach</span><span class="o">(</span><span class="nc">TestInfo</span> <span class="n">testInfo</span><span class="o">,</span> <span class="nc">RepetitionInfo</span> <span class="n">repetitionInfo</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">currentRepetition</span> <span class="o">=</span> <span class="n">repetitionInfo</span><span class="o">.</span><span class="na">getCurrentRepetition</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">totalRepetitions</span> <span class="o">=</span> <span class="n">repetitionInfo</span><span class="o">.</span><span class="na">getTotalRepetitions</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">methodName</span> <span class="o">=</span> <span class="n">testInfo</span><span class="o">.</span><span class="na">getTestMethod</span><span class="o">().</span><span class="na">get</span><span class="o">().</span><span class="na">getName</span><span class="o">();</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"About to execute repetition %d of %d for %s"</span><span class="o">,</span> <span class="c1">//</span>
            <span class="n">currentRepetition</span><span class="o">,</span> <span class="n">totalRepetitions</span><span class="o">,</span> <span class="n">methodName</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@RepeatedTest</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">repeatedTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ...</span>
    <span class="o">}</span>

    <span class="nd">@RepeatedTest</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">repeatedTestWithRepetitionInfo</span><span class="o">(</span><span class="nc">RepetitionInfo</span> <span class="n">repetitionInfo</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">repetitionInfo</span><span class="o">.</span><span class="na">getTotalRepetitions</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@RepeatedTest</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"{displayName} {currentRepetition}/{totalRepetitions}"</span><span class="o">)</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"Repeat!"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">customDisplayName</span><span class="o">(</span><span class="nc">TestInfo</span> <span class="n">testInfo</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Repeat! 1/1"</span><span class="o">,</span> <span class="n">testInfo</span><span class="o">.</span><span class="na">getDisplayName</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@RepeatedTest</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">name</span> <span class="o">=</span> <span class="nc">RepeatedTest</span><span class="o">.</span><span class="na">LONG_DISPLAY_NAME</span><span class="o">)</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"Details..."</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">customDisplayNameWithLongPattern</span><span class="o">(</span><span class="nc">TestInfo</span> <span class="n">testInfo</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Details... :: repetition 1 of 1"</span><span class="o">,</span> <span class="n">testInfo</span><span class="o">.</span><span class="na">getDisplayName</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@RepeatedTest</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">5</span><span class="o">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"Wiederholung {currentRepetition} von {totalRepetitions}"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">repeatedTestInGerman</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ...</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>ユニコードテーマを有効にした <code>ConsoleLauncher</code> を使うと次のような出力が得られるでしょう。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>├─ RepeatedTestsDemo ✔
│  ├─ repeatedTest() ✔
│  │  ├─ repetition 1 of 10 ✔
│  │  ├─ repetition 2 of 10 ✔
│  │  ├─ repetition 3 of 10 ✔
│  │  ├─ repetition 4 of 10 ✔
│  │  ├─ repetition 5 of 10 ✔
│  │  ├─ repetition 6 of 10 ✔
│  │  ├─ repetition 7 of 10 ✔
│  │  ├─ repetition 8 of 10 ✔
│  │  ├─ repetition 9 of 10 ✔
│  │  └─ repetition 10 of 10 ✔
│  ├─ repeatedTestWithRepetitionInfo(RepetitionInfo) ✔
│  │  ├─ repetition 1 of 5 ✔
│  │  ├─ repetition 2 of 5 ✔
│  │  ├─ repetition 3 of 5 ✔
│  │  ├─ repetition 4 of 5 ✔
│  │  └─ repetition 5 of 5 ✔
│  ├─ Repeat! ✔
│  │  └─ Repeat! 1/1 ✔
│  ├─ Details... ✔
│  │  └─ Details... {two-colons} repetition 1 of 1 ✔
│  └─ repeatedTestInGerman() ✔
│     ├─ Wiederholung 1 von 5 ✔
│     ├─ Wiederholung 2 von 5 ✔
│     ├─ Wiederholung 3 von 5 ✔
│     ├─ Wiederholung 4 von 5 ✔
│     └─ Wiederholung 5 von 5 ✔</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-parameterized-tests"><a class="anchor" href="#writing-tests-parameterized-tests"></a>2.15. パラメタライズテスト</h3>
<div class="paragraph">
<p>パラメタライズテストは複数の異なる引数でテストメソッドを実行する機能です。
テストメソッドを <code>@Test</code> ではなく <code><a href="../api/org.junit.jupiter.params/org/junit/jupiter/params/ParameterizedTest.html">@ParameterizedTest</a></code> で修飾します。
メソッドの引数を提供する <em>ソース</em> を少なくとも1つは宣言しなければなりません。
テストメソッドは <em>ソース</em> の提供するそれぞれの値を引数として <em>消費</em> します。</p>
</div>
<div class="paragraph">
<p>次のコード例では <code>@ValueSource</code> で <code>String</code> の配列を与えています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@ValueSource</span><span class="o">(</span><span class="n">strings</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"racecar"</span><span class="o">,</span> <span class="s">"radar"</span><span class="o">,</span> <span class="s">"able was I ere I saw elba"</span> <span class="o">})</span>
<span class="kt">void</span> <span class="nf">palindromes</span><span class="o">(</span><span class="nc">String</span> <span class="n">candidate</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertTrue</span><span class="o">(</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">isPalindrome</span><span class="o">(</span><span class="n">candidate</span><span class="o">));</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>パラメタライズテストを実行すると、それぞれのテストメソッドの呼び出しを別々に報告します。
例えば、<code>ConsoleLauncher</code> は次のように出力するでしょう。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>palindromes(String) ✔
├─ [1] candidate=racecar ✔
├─ [2] candidate=radar ✔
└─ [3] candidate=able was I ere I saw elba ✔</pre>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-parameterized-tests-setup"><a class="anchor" href="#writing-tests-parameterized-tests-setup"></a>2.15.1. 必要な準備</h4>
<div class="paragraph">
<p>パラメタライズテストを実行するには、依存ライブラリに <code>junit-jupiter-params</code> を追加しなければなりません。
詳しくは <a href="#dependency-metadata">依存ライブラリに関するメタデータ</a> を参照してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-parameterized-tests-consuming-arguments"><a class="anchor" href="#writing-tests-parameterized-tests-consuming-arguments"></a>2.15.2. 引数を消費するということについて</h4>
<div class="paragraph">
<p>パラメタライズテストでは基本的に指定した <em>ソース</em> から直接値を <em>消費</em> します。
このとき、<em>ソース</em> から取得した値の（配列の）添え字と、メソッド引数の順序の対応関係は1対1になります（<a href="#writing-tests-parameterized-tests-sources-CsvSource">@CsvSource</a> を参照）。
しかし、<em>ソース</em> から取得した値を <em>集約</em> して、メソッド引数の1つに渡すこともできます（<a href="#writing-tests-parameterized-tests-argument-aggregation">引数の集約</a> を参照）。
また、メソッド引数には <code>ParameterResolver</code> が注入する引数（例えば <code>TestInfo</code> や <code>TestReporter</code> など）を宣言できます。
パラメタライズテストにおけるメソッド引数の宣言規則は次のとおりです。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>0 個以上の <em>添え字に対応する引数</em> は先頭で宣言しなければなりません。</p>
</li>
<li>
<p>0 個以上の <em>集約する引数</em> はその次に宣言しなければなりません。</p>
</li>
<li>
<p>0 個以上の <code>ParameterResolver</code> が注入する引数は最後に宣言しなければなりません。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>「添え字に対応する引数」とは、<code>ArgumentsProvider</code> の提供する <code>Arguments</code> に対する添え字のことで、添え字に対応する引数へ値を渡します。
「集約する引数」とは、<code>ArgumentAccessor</code> 型の引数か、<code>@AggregateWith</code> で修飾した引数のことです。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">AutoCloseable 型の引数について</div>
<div class="paragraph">
<p><code>java.lang.AutoCloseable</code> やその派生インターフェイスの <code>java.io.Closeable</code> を実装した型の引数は、<code>@AfterEach</code> メソッドを実行した後、自動的に閉じます。
また、テストメソッドから <code>AfterEachCallback</code> 拡張を呼び出した場合は、テストメソッドを実行した後、自動的に閉じます。</p>
</div>
<div class="paragraph">
<p>この振る舞いを無効化するには <code>@ParameterizedTest</code> の <code>autoCloseArguments</code> 属性に <code>false</code> を設定します。
特に、<code>AutoCloseable</code> を実装した引数を同じパラメタライズテストメソッドで何回も再利用するなら、毎回閉じられないように設定しておきましょう。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-parameterized-tests-sources"><a class="anchor" href="#writing-tests-parameterized-tests-sources"></a>2.15.3. 引数の源</h4>
<div class="paragraph">
<p>JUnit Jupiter はいくつか <em>ソース</em> のアノテーションを同梱しています。
このセクションではそれぞれのアノテーションについて簡単な使い方を説明してきます。
詳細は <code><a href="../api/org.junit.jupiter.params/org/junit/jupiter/params/provider/package-summary.html">org.junit.jupiter.params.provider</a></code> パッケージの Javadoc を参照してください。</p>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-sources-ValueSource"><a class="anchor" href="#writing-tests-parameterized-tests-sources-ValueSource"></a>@ValueSource</h5>
<div class="paragraph">
<p><code>@ValueSource</code> はソースアノテーションの中でも簡単なものの1つです。
配列やリテラル値を、1引数のテストメソッドに渡すことができます。</p>
</div>
<div class="paragraph">
<p><code>@ValueSource</code> の対応しているリテラルのデータ型は次のとおりです。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>short</code></p>
</li>
<li>
<p><code>byte</code></p>
</li>
<li>
<p><code>int</code></p>
</li>
<li>
<p><code>long</code></p>
</li>
<li>
<p><code>float</code></p>
</li>
<li>
<p><code>double</code></p>
</li>
<li>
<p><code>char</code></p>
</li>
<li>
<p><code>boolean</code></p>
</li>
<li>
<p><code>java.lang.String</code></p>
</li>
<li>
<p><code>java.lang.Class</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>例えば、次のコード例では <code>1, 2, 3</code> それぞれを引数として <code>@ParameterizedTest</code> で修飾したテストメソッドを実行します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@ValueSource</span><span class="o">(</span><span class="n">ints</span> <span class="o">=</span> <span class="o">{</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span> <span class="o">})</span>
<span class="kt">void</span> <span class="nf">testWithValueSource</span><span class="o">(</span><span class="kt">int</span> <span class="n">argument</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertTrue</span><span class="o">(</span><span class="n">argument</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">argument</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-sources-null-and-empty"><a class="anchor" href="#writing-tests-parameterized-tests-sources-null-and-empty"></a>null および空値</h5>
<div class="paragraph">
<p>コーナーケースや <em>不正な入力</em> を与えられたときの振る舞いを確かめるには、パラメタライズテストで <code>null</code> や <em>空値</em> を渡せるようにすると便利です。
1引数のテストメソッドへ <code>null</code> や空値を渡すためのアノテーションには次のようなものがあります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="../api/org.junit.jupiter.params/org/junit/jupiter/params/provider/NullSource.html">@NullSource</a></code>: <code>@ParameterizedTest</code> で修飾したメソッドの引数に <code>null</code> を渡します。</p>
<div class="ulist">
<ul>
<li>
<p>プリミティブ型の引数には使用できません</p>
</li>
</ul>
</div>
</li>
<li>
<p><code><a href="../api/org.junit.jupiter.params/org/junit/jupiter/params/provider/EmptySource.html">@EmptySource</a></code>: <code>@ParameterizedTest</code> で修飾したメソッドの引数に <em>空値</em> を渡します。対応している引数の型は参照型（<code>java.lang.String, java.util.List, java.util.Set, java.util.Map</code>）と配列型（<code>int[]</code>, <code>char[][]</code> など）です。</p>
<div class="ulist">
<ul>
<li>
<p>これらのデータ型から派生した型には未対応です。</p>
</li>
</ul>
</div>
</li>
<li>
<p><code><a href="../api/org.junit.jupiter.params/org/junit/jupiter/params/provider/NullAndEmptySource.html">@NullAndEmptySource</a></code>: <code>@NullSource</code> と <code>@EmptySource</code> の <em>合成アノテーション</em> で、両方の使い方ができます。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>パラメタライズテストへ <em>空白</em> に相当するさまざま文字列を渡したいときは、<a href="#writing-tests-parameterized-tests-sources-ValueSource">@ValueSource</a> を使うといいでしょう。
具体的には <code>@ValueSource(strings = {"&#160;", "&#160;&#160;&#160;", "\t", "\n"})</code> のように記述できます。</p>
</div>
<div class="paragraph">
<p>次のコード例のように、<code>@NullSource</code> と <code>@EmptySource</code> に <code>@ValueSource</code> を組み合わせると、<code>null</code> や <em>空値</em> や <em>空白</em> を幅広く入力させることができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@NullSource</span>
<span class="nd">@EmptySource</span>
<span class="nd">@ValueSource</span><span class="o">(</span><span class="n">strings</span> <span class="o">=</span> <span class="o">{</span> <span class="s">" "</span><span class="o">,</span> <span class="s">"   "</span><span class="o">,</span> <span class="s">"\t"</span><span class="o">,</span> <span class="s">"\n"</span> <span class="o">})</span>
<span class="kt">void</span> <span class="nf">nullEmptyAndBlankStrings</span><span class="o">(</span><span class="nc">String</span> <span class="n">text</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertTrue</span><span class="o">(</span><span class="n">text</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">text</span><span class="o">.</span><span class="na">trim</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">());</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>合成アノテーションの <code>@NullAndEmptySource</code> を使うと少し短くなります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@NullAndEmptySource</span>
<span class="nd">@ValueSource</span><span class="o">(</span><span class="n">strings</span> <span class="o">=</span> <span class="o">{</span> <span class="s">" "</span><span class="o">,</span> <span class="s">"   "</span><span class="o">,</span> <span class="s">"\t"</span><span class="o">,</span> <span class="s">"\n"</span> <span class="o">})</span>
<span class="kt">void</span> <span class="nf">nullEmptyAndBlankStrings</span><span class="o">(</span><span class="nc">String</span> <span class="n">text</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertTrue</span><span class="o">(</span><span class="n">text</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">text</span><span class="o">.</span><span class="na">trim</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">());</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
どちらの場合でも <code>nullEmptyAndBlankStrings(String)</code> メソッドは6回実行されます。
<code>null</code> で1回、空値で1回、<code>@ValueSource</code> の提供する空白文字で4回です。
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-sources-EnumSource"><a class="anchor" href="#writing-tests-parameterized-tests-sources-EnumSource"></a>@EnumSource</h5>
<div class="paragraph">
<p><code>@EnumSource</code> を使うと列挙型の定数が使いやすくなります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@EnumSource</span><span class="o">(</span><span class="nc">ChronoUnit</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithEnumSource</span><span class="o">(</span><span class="nc">TemporalUnit</span> <span class="n">unit</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertNotNull</span><span class="o">(</span><span class="n">unit</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>value</code> 属性は任意です。
未指定なら先頭のメソッド引数の型を使用します。
先頭のメソッド引数の型が列挙型でなければテストは失敗します。
前のコード例では、先頭のメソッド引数の型 <code>TemporalUnit</code> は列挙型ではありません（<code>ChronoUnit</code> の実装するインターフェイスです）。
ですので、<code>@EnumSource</code> の <code>value</code> 属性に列挙型を指定しなければなりません。
引数の型を <code>ChronoUnit</code> へ変更すれば、<code>value</code> 属性の指定は不要になります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@EnumSource</span>
<span class="kt">void</span> <span class="nf">testWithEnumSourceWithAutoDetection</span><span class="o">(</span><span class="nc">ChronoUnit</span> <span class="n">unit</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertNotNull</span><span class="o">(</span><span class="n">unit</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>names</code> 属性には使用する定数名を指定できます。
未指定なら全ての定数を使用します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@EnumSource</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"DAYS"</span><span class="o">,</span> <span class="s">"HOURS"</span> <span class="o">})</span>
<span class="kt">void</span> <span class="nf">testWithEnumSourceInclude</span><span class="o">(</span><span class="nc">ChronoUnit</span> <span class="n">unit</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertTrue</span><span class="o">(</span><span class="nc">EnumSet</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="nc">ChronoUnit</span><span class="o">.</span><span class="na">DAYS</span><span class="o">,</span> <span class="nc">ChronoUnit</span><span class="o">.</span><span class="na">HOURS</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="n">unit</span><span class="o">));</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>mode</code> 属性を指定するとテストメソッドに渡す定数を細かく制御できます。
次のコード例では指定した名前に一致する定数を除外したり、指定した正規表現がマッチする定数を選択したりします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@EnumSource</span><span class="o">(</span><span class="n">mode</span> <span class="o">=</span> <span class="no">EXCLUDE</span><span class="o">,</span> <span class="n">names</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"ERAS"</span><span class="o">,</span> <span class="s">"FOREVER"</span> <span class="o">})</span>
<span class="kt">void</span> <span class="nf">testWithEnumSourceExclude</span><span class="o">(</span><span class="nc">ChronoUnit</span> <span class="n">unit</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertFalse</span><span class="o">(</span><span class="nc">EnumSet</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="nc">ChronoUnit</span><span class="o">.</span><span class="na">ERAS</span><span class="o">,</span> <span class="nc">ChronoUnit</span><span class="o">.</span><span class="na">FOREVER</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="n">unit</span><span class="o">));</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@EnumSource</span><span class="o">(</span><span class="n">mode</span> <span class="o">=</span> <span class="no">MATCH_ALL</span><span class="o">,</span> <span class="n">names</span> <span class="o">=</span> <span class="s">"^.*DAYS$"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithEnumSourceRegex</span><span class="o">(</span><span class="nc">ChronoUnit</span> <span class="n">unit</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertTrue</span><span class="o">(</span><span class="n">unit</span><span class="o">.</span><span class="na">name</span><span class="o">().</span><span class="na">endsWith</span><span class="o">(</span><span class="s">"DAYS"</span><span class="o">));</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-sources-MethodSource"><a class="anchor" href="#writing-tests-parameterized-tests-sources-MethodSource"></a>@MethodSource</h5>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.params/org/junit/jupiter/params/provider/MethodSource.html">@MethodSource</a></code> では、テストクラスやそれ以外のクラスに定義した、1つ以上の <em>ファクトリ</em> メソッドを指定できます。</p>
</div>
<div class="paragraph">
<p>テストクラスを <code>@TestInstance(Lifecycle.PER_CLASS)</code> で修飾している場合を除いて、テストクラス中のファクトリメソッドは <code>static</code> 宣言したものにしなければいけません。
一方、外部のクラスに定義したファクトリメソッドは必ず <code>static</code> 宣言したものにしなければいけません。
あと、ファクトリメソッドに指定するメソッドは引数を宣言できません。</p>
</div>
<div class="paragraph">
<p>ファクトリメソッドは <em>引数に渡す値</em> の <em>ストリーム</em> を生成しなければなりません。
ストリームのそれぞれの要素は <code>@ParameterizedTest</code> で修飾したメソッドを呼び出すたびに渡されます。
一般的には <code>Arguments</code> の <code>Stream</code> つまり <code>Stream&lt;Arguments&gt;</code> という形式で表現する場合が多いようです。
ただし、ファクトリメソッドの返り値型は他にもいろいろな型になります。
JUnit は安全に <code>Stream</code> へ変換できる型を「ストリーム」と呼びます（それぞれのプリミティブ型に対応する <code>Stream</code> や、オブジェクト型の配列、プリミティブ型の配列、<code>Collection</code> や <code>Iterator</code> や <code>Iterable</code> など）。
そして、<code>Arguments</code> のインスタンスとして渡せるものならなんでも「ストリームの要素」になります（オブジェクト型の配列や、単一のリテラル値など）。</p>
</div>
<div class="paragraph">
<p>テストメソッドの引数が1つだけなら、引数と同じ型の <code>Stream</code> を返すファクトリメソッドを使用できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@MethodSource</span><span class="o">(</span><span class="s">"stringProvider"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithExplicitLocalMethodSource</span><span class="o">(</span><span class="nc">String</span> <span class="n">argument</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertNotNull</span><span class="o">(</span><span class="n">argument</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">static</span> <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">stringProvider</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span> <span class="s">"banana"</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@MethodSource</code> で明示的にメソッド名を指定したくないときのために、JUnit Jupiter では <code>@ParameterizedTest</code> で修飾したメソッド名と同じ名前のメソッドを探索して、 <em>ファクトリメソッド</em> として使うようになっています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@MethodSource</span>
<span class="kt">void</span> <span class="nf">testWithDefaultLocalMethodSource</span><span class="o">(</span><span class="nc">String</span> <span class="n">argument</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertNotNull</span><span class="o">(</span><span class="n">argument</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">static</span> <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">testWithDefaultLocalMethodSource</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span> <span class="s">"banana"</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>ファクトリメソッドの返り値型には、プリミティブ型に対応する <code>Stream</code> を使用できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@MethodSource</span><span class="o">(</span><span class="s">"range"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithRangeMethodSource</span><span class="o">(</span><span class="kt">int</span> <span class="n">argument</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertNotEquals</span><span class="o">(</span><span class="mi">9</span><span class="o">,</span> <span class="n">argument</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">static</span> <span class="nc">IntStream</span> <span class="nf">range</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">20</span><span class="o">).</span><span class="na">skip</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>パラメタライズテストに複数の引数を宣言した場合、ファクトリメソッドの返り値型は <code>Arguments</code> を要素型とするコレクション、ストリーム、配列にするか、オブジェクト型の配列にしなければなりません（対応している返り値型について詳しくは <code><a href="../api/org.junit.jupiter.params/org/junit/jupiter/params/provider/MethodSource.html">@MethodSource</a></code> の Javadoc を参照してください）。
<code>arguments(Object&#8230;&#8203;)</code> は <code>Arguments</code> インターフェイスに定義した static ファクトリメソッドです。
代わりに <code>Arguments.of(Object&#8230;&#8203;)</code> を使うこともできます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@MethodSource</span><span class="o">(</span><span class="s">"stringIntAndListProvider"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithMultiArgMethodSource</span><span class="o">(</span><span class="nc">String</span> <span class="n">str</span><span class="o">,</span> <span class="kt">int</span> <span class="n">num</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
    <span class="n">assertTrue</span><span class="o">(</span><span class="n">num</span> <span class="o">&gt;=</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">num</span> <span class="o">&lt;=</span><span class="mi">2</span><span class="o">);</span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
<span class="o">}</span>

<span class="kd">static</span> <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">Arguments</span><span class="o">&gt;</span> <span class="nf">stringIntAndListProvider</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
        <span class="n">arguments</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">)),</span>
        <span class="n">arguments</span><span class="o">(</span><span class="s">"lemon"</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"x"</span><span class="o">,</span> <span class="s">"y"</span><span class="o">))</span>
    <span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>外部のクラスで <code>static</code> 宣言した <em>ファクトリメソッド</em> は <em>完全修飾メソッド名</em> で指定できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">package</span> <span class="nn">example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.stream.Stream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.params.ParameterizedTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.params.provider.MethodSource</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">ExternalMethodSourceDemo</span> <span class="o">{</span>

    <span class="nd">@ParameterizedTest</span>
    <span class="nd">@MethodSource</span><span class="o">(</span><span class="s">"example.StringsProviders#tinyStrings"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">testWithExternalMethodSource</span><span class="o">(</span><span class="nc">String</span> <span class="n">tinyString</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// test with tiny string</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">StringsProviders</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">tinyStrings</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"."</span><span class="o">,</span> <span class="s">"oo"</span><span class="o">,</span> <span class="s">"OOO"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-sources-CsvSource"><a class="anchor" href="#writing-tests-parameterized-tests-sources-CsvSource"></a>@CsvSource</h5>
<div class="paragraph">
<p><code>@CsvSource</code> を使うと、引数のリストをカンマ区切りで表現できます（例えば文字列リテラル）。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvSource</span><span class="o">({</span>
    <span class="s">"apple,         1"</span><span class="o">,</span>
    <span class="s">"banana,        2"</span><span class="o">,</span>
    <span class="s">"'lemon, lime', 0xF1"</span><span class="o">,</span>
    <span class="s">"strawberry,    700_000"</span>
<span class="o">})</span>
<span class="kt">void</span> <span class="nf">testWithCsvSource</span><span class="o">(</span><span class="nc">String</span> <span class="n">fruit</span><span class="o">,</span> <span class="kt">int</span> <span class="n">rank</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertNotNull</span><span class="o">(</span><span class="n">fruit</span><span class="o">);</span>
    <span class="n">assertNotEquals</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">rank</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>既定の区切り文字はカンマ（<code>,</code>）ですが、<code>delimiter</code> 属性で別の文字を指定できます。
<code>delimiterString</code> 属性には区切り文字ではなく区切り文字列を指定できます。
両方の属性を同時に設定することはできません。</p>
</div>
<div class="paragraph">
<p>既定の囲み文字は一重引用符（<code>'</code>）です。
この次の具体例にあるとおり、<code>'lemon, lime'</code> のように記述できます。
<code>emptyValue</code> 属性が未指定なら <code>''</code> は空文字列になります。
囲み文字すら無い完全な <em>空値</em> は <code>null</code> になります。
<code>nullValues</code> 属性に指定した1つ以上の文字列のいずれかに対応する値は <code>null</code> になります（この次の具体例で <code>NIL</code> の例を参照してください）。
プリミティブ型のメソッド引数に <code>null</code> を渡すと <code>ArgumentConversionException</code> をスローします。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>nullValues</code> 属性にどんな値を設定しても、<em>囲み文字で囲んでない</em> 空値は常に <code>null</code> になります。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>既定では、囲み文字があってもなくても、CSV の列の値の前後の空白は除去します。
<code>ignoreLeadingAndTrailingWhitespace</code> 属性に <code>false</code> を設定すると、空白を除去しなくなります（JUnit Jupiter 5.8 で導入された機能です）。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">サンプルコード</th>
<th class="tableblock halign-left valign-top">引数に渡される値のリスト</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@CsvSource({ "apple, banana" })</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"apple"</code>, <code>"banana"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@CsvSource({ "apple, 'lemon, lime'" })</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"apple"</code>, <code>"lemon, lime"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@CsvSource({ "apple, ''" })</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"apple"</code>, <code>""</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@CsvSource({ "apple, " })</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"apple"</code>, <code>null</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@CsvSource(value = { "apple, banana, NIL" }, nullValues = "NIL")</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"apple"</code>, <code>"banana"</code>, <code>null</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@CsvSource(value = { " apple , banana" }, ignoreLeadingAndTrailingWhitespace = false)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>" apple "</code>, <code>" banana"</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-sources-CsvFileSource"><a class="anchor" href="#writing-tests-parameterized-tests-sources-CsvFileSource"></a>@CsvFileSource</h5>
<div class="paragraph">
<p><code>@CsvFileSource</code> を使うとクラスパスやローカルファイルシステムに配置した CSV ファイルを使用できます。
CSV ファイルの各行ごとに、パラメタライズテストのテストメソッドを実行します。</p>
</div>
<div class="paragraph">
<p>既定の区切り文字はカンマ（<code>,</code>）ですが、<code>delimiter</code> 属性で別の文字を指定できます。
<code>delimiterString</code> 属性には区切り文字ではなく区切り文字列を指定できます。
両方の属性を同時に設定することはできません。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">CSVファイル中のコメント行の扱い</div>
<code>\#</code> で始まる行はコメントと見做して、すべて無視します。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvFileSource</span><span class="o">(</span><span class="n">resources</span> <span class="o">=</span> <span class="s">"/two-column.csv"</span><span class="o">,</span> <span class="n">numLinesToSkip</span> <span class="o">=</span> <span class="mi">1</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithCsvFileSourceFromClasspath</span><span class="o">(</span><span class="nc">String</span> <span class="n">country</span><span class="o">,</span> <span class="kt">int</span> <span class="n">reference</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertNotNull</span><span class="o">(</span><span class="n">country</span><span class="o">);</span>
    <span class="n">assertNotEquals</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">reference</span><span class="o">);</span>
<span class="o">}</span>

<span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvFileSource</span><span class="o">(</span><span class="n">files</span> <span class="o">=</span> <span class="s">"src/test/resources/two-column.csv"</span><span class="o">,</span> <span class="n">numLinesToSkip</span> <span class="o">=</span> <span class="mi">1</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithCsvFileSourceFromFile</span><span class="o">(</span><span class="nc">String</span> <span class="n">country</span><span class="o">,</span> <span class="kt">int</span> <span class="n">reference</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertNotNull</span><span class="o">(</span><span class="n">country</span><span class="o">);</span>
    <span class="n">assertNotEquals</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">reference</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">two-column.csv</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="csv">Country, reference
Sweden, 1
Poland, 2
"United States of America", 3
France, 700_000</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@CsvSource</code> と違って、<code>@CsvFileSource</code> では囲み文字として二重引用符（<code>"</code>）を使います。
前の例では <code>"United States of America"</code> のように使っています。
<code>emptyValue</code> 属性が未指定なら <code>""</code> は空文字列になります。
囲み文字すら無い完全な <em>空値</em> は <code>null</code> になります。
<code>nullValues</code> 属性に指定した1つ以上の文字列のいずれかに対応する値は <code>null</code> になります。
プリミティブ型のメソッド引数に <code>null</code> を渡すと <code>ArgumentConversionException</code> をスローします。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>nullValues</code> 属性にどんな値を設定しても、<em>囲み文字で囲んでない</em> 空値は常に <code>null</code> になります。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>既定では、囲み文字があってもなくても、CSV の列の値の前後の空白は除去します。
<code>ignoreLeadingAndTrailingWhitespace</code> 属性に <code>false</code> を設定すると、空白を除去しなくなります（JUnit Jupiter 5.8 で導入された機能です）。</p>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-sources-ArgumentsSource"><a class="anchor" href="#writing-tests-parameterized-tests-sources-ArgumentsSource"></a>@ArgumentsSource</h5>
<div class="paragraph">
<p><code>@ArgumentsSource</code> は自作の再利用可能な <code>ArgumentsProvider</code> を指定するために使います。
<code>ArgumentsProvider</code> の実装クラスはトップレベルクラスか <code>static</code> 宣言した内部クラスにしなければいけません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@ArgumentsSource</span><span class="o">(</span><span class="nc">MyArgumentsProvider</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithArgumentsSource</span><span class="o">(</span><span class="nc">String</span> <span class="n">argument</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertNotNull</span><span class="o">(</span><span class="n">argument</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyArgumentsProvider</span> <span class="kd">implements</span> <span class="nc">ArgumentsProvider</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Stream</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Arguments</span><span class="o">&gt;</span> <span class="nf">provideArguments</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span> <span class="s">"banana"</span><span class="o">).</span><span class="na">map</span><span class="o">(</span><span class="nl">Arguments:</span><span class="o">:</span><span class="n">of</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-parameterized-tests-argument-conversion"><a class="anchor" href="#writing-tests-parameterized-tests-argument-conversion"></a>2.15.4. 引数の変換</h4>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-argument-conversion-widening"><a class="anchor" href="#writing-tests-parameterized-tests-argument-conversion-widening"></a>ワイドニング変換</h5>
<div class="paragraph">
<p>JUnit Jupiter はパラメタライズテストに渡される引数の <a href="https://docs.oracle.com/javase/specs/jls/se8/html/jls-5.html#jls-5.1.2">プリミティブ型のワイドニング変換</a> に対応しています。
例えば、テストメソッドを <code>@ValueSource(ints = { 1, 2, 3 })</code> で修飾した場合、メソッド引数の型には <code>int, long, float, double</code> が使用できます。</p>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-argument-conversion-implicit"><a class="anchor" href="#writing-tests-parameterized-tests-argument-conversion-implicit"></a>暗黙的な型変換</h5>
<div class="paragraph">
<p>JUnit Jupiter は <code>@CsvSource</code> に必要な暗黙の型変換処理をいくつも提供しています。
メソッド引数の型によって、異なる変換処理を実行するということです。</p>
</div>
<div class="paragraph">
<p>例えば、パラメタライズテストのメソッド引数の型が <code>TimeUnit</code> で、ソースのデータ型が <code>String</code> なら、<code>TimeUnit</code> 列挙型の対応する定数へ自動的に変換します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@ValueSource</span><span class="o">(</span><span class="n">strings</span> <span class="o">=</span> <span class="s">"SECONDS"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithImplicitArgumentConversion</span><span class="o">(</span><span class="nc">ChronoUnit</span> <span class="n">argument</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertNotNull</span><span class="o">(</span><span class="n">argument</span><span class="o">.</span><span class="na">name</span><span class="o">());</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>String</code> からは、次のようなメソッド引数の型へ暗黙的に型変換します。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>String</code> リテラルで10進数記法、16進数記法、8進数記法の数値を指定した場合、<code>byte, short, int, long</code> の対応するプリミティブ型か、プリミティブ型に対応するラッパークラスへ変換します。
</td>
</tr>
</table>
</div>
<table id="writing-tests-parameterized-tests-argument-conversion-implicit-table" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Target Type</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code>/<code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"true"</code>                                 &#8594; <code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte</code>/<code>Byte</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"15"</code>, <code>"0xF"</code>, or <code>"017"</code>              &#8594; <code>(byte) 15</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>char</code>/<code>Character</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"o"</code>                                    &#8594; <code>'o'</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>short</code>/<code>Short</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"15"</code>, <code>"0xF"</code>, or <code>"017"</code>              &#8594; <code>(short) 15</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code>/<code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"15"</code>, <code>"0xF"</code>, or <code>"017"</code>              &#8594; <code>15</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code>/<code>Long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"15"</code>, <code>"0xF"</code>, or <code>"017"</code>              &#8594; <code>15L</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>float</code>/<code>Float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"1.0"</code>                                  &#8594; <code>1.0f</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>double</code>/<code>Double</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"1.0"</code>                                  &#8594; <code>1.0d</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Enum</code> の派生クラス</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SECONDS"</code>                              &#8594; <code>TimeUnit.SECONDS</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.io.File</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"/path/to/file"</code>                        &#8594; <code>new File("/path/to/file")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"java.lang.Integer"</code>                    &#8594; <code>java.lang.Integer.class</code> <em>（内部クラスを指定するときは <code>$</code> を使う。例えば <code>"java.lang.Thread$State"</code>）</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"byte"</code>                                 &#8594; <code>byte.class</code> <em>（プリミティブ型に対応しています）</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"char[]"</code>                               &#8594; <code>char[].class</code> <em>（配列型に対応しています）</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.math.BigDecimal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"123.456e789"</code>                          &#8594; <code>new BigDecimal("123.456e789")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.math.BigInteger</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"1234567890123456789"</code>                  &#8594; <code>new BigInteger("1234567890123456789")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.net.URI</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"https://junit.org/"</code>                   &#8594; <code>URI.create("https://junit.org/")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.net.URL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"https://junit.org/"</code>                   &#8594; <code>new URL("https://junit.org/")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.nio.charset.Charset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"UTF-8"</code>                                &#8594; <code>Charset.forName("UTF-8")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.nio.file.Path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"/path/to/file"</code>                        &#8594; <code>Paths.get("/path/to/file")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.Duration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"PT3S"</code>                                 &#8594; <code>Duration.ofSeconds(3)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.Instant</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"1970-01-01T00:00:00Z"</code>                 &#8594; <code>Instant.ofEpochMilli(0)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.LocalDateTime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2017-03-14T12:34:56.789"</code>              &#8594; <code>LocalDateTime.of(2017, 3, 14, 12, 34, 56, 789_000_000)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.LocalDate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2017-03-14"</code>                           &#8594; <code>LocalDate.of(2017, 3, 14)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.LocalTime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"12:34:56.789"</code>                         &#8594; <code>LocalTime.of(12, 34, 56, 789_000_000)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.MonthDay</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"--03-14"</code>                              &#8594; <code>MonthDay.of(3, 14)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.OffsetDateTime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2017-03-14T12:34:56.789Z"</code>             &#8594; <code>OffsetDateTime.of(2017, 3, 14, 12, 34, 56, 789_000_000, ZoneOffset.UTC)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.OffsetTime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"12:34:56.789Z"</code>                        &#8594; <code>OffsetTime.of(12, 34, 56, 789_000_000, ZoneOffset.UTC)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.Period</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"P2M6D"</code>                                &#8594; <code>Period.of(0, 2, 6)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.YearMonth</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2017-03"</code>                              &#8594; <code>YearMonth.of(2017, 3)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.Year</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2017"</code>                                 &#8594; <code>Year.of(2017)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.ZonedDateTime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2017-03-14T12:34:56.789Z"</code>             &#8594; <code>ZonedDateTime.of(2017, 3, 14, 12, 34, 56, 789_000_000, ZoneOffset.UTC)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.ZoneId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"Europe/Berlin"</code>                        &#8594; <code>ZoneId.of("Europe/Berlin")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.ZoneOffset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"+02:30"</code>                               &#8594; <code>ZoneOffset.ofHoursMinutes(2, 30)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.util.Currency</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"JPY"</code>                                  &#8594; <code>Currency.getInstance("JPY")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.util.Locale</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"en"</code>                                   &#8594; <code>new Locale("en")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.util.UUID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"d043e930-7b3b-48e3-bdbe-5a3ccfb833db"</code> &#8594; <code>UUID.fromString("d043e930-7b3b-48e3-bdbe-5a3ccfb833db")</code></p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="writing-tests-parameterized-tests-argument-conversion-implicit-fallback"><a class="anchor" href="#writing-tests-parameterized-tests-argument-conversion-implicit-fallback"></a>文字列からオブジェクトへ変換するときの代替処理</h6>
<div class="paragraph">
<p>JUnit Jupiter は文字列からメソッド引数の型への型変換（前のセクションで表に列挙した）だけでなく、文字列からの変換処理が未定義の場合の代替処理として、自動的に単一の <em>ファクトリメソッド</em> あるいは、単一の <em>ファクトリコンストラクタ</em> を探索し、実行できます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>ファクトリメソッド</em>: 可視性は <code>package</code> 以上。<code>static</code> 宣言している。引数は <code>String</code> 1つ。返り値は対象データ型のインスタンスである、対象データ型に定義したメソッド。メソッド名は自由です。</p>
</li>
<li>
<p><em>ファクトリコンストラクタ</em>: 可視性は <code>package</code> 以上。引数は <code>String</code> 1 つ。対象データ型はトップレベルクラスか <code>static</code> 宣言したインナークラスにしなければいけません。</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<em>ファクトリメソッド</em> を複数発見したときは何も見つからなかったものとします。<em>ファクトリメソッド</em> と <em>ファクトリコンストラクタ</em> が見つかったときはファクトリメソッドを優先して使用します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>次のコード例は、ファクトリメソッド <code>Book.fromTitle(String)</code> で <code>"42 Cats"</code> から作成した <code>Book</code> のインスタンスをテストメソッドに渡しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@ValueSource</span><span class="o">(</span><span class="n">strings</span> <span class="o">=</span> <span class="s">"42 Cats"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithImplicitFallbackArgumentConversion</span><span class="o">(</span><span class="nc">Book</span> <span class="n">book</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="s">"42 Cats"</span><span class="o">,</span> <span class="n">book</span><span class="o">.</span><span class="na">getTitle</span><span class="o">());</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Book</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nf">Book</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Book</span> <span class="nf">fromTitle</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Book</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getTitle</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">title</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-argument-conversion-explicit"><a class="anchor" href="#writing-tests-parameterized-tests-argument-conversion-explicit"></a>明示的な型変換</h5>
<div class="paragraph">
<p>暗黙的な型変換に頼れない場合は、メソッド引数を <code>@ConvertWith</code> で修飾し、<code>ArgumentConverter</code> を指定することでデータ型を変換します。
<code>ArgumentConverter</code> の実装クラスはトップレベルクラスか <code>static</code> 宣言したインナークラスにしなければいけません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@EnumSource</span><span class="o">(</span><span class="nc">ChronoUnit</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithExplicitArgumentConversion</span><span class="o">(</span>
        <span class="nd">@ConvertWith</span><span class="o">(</span><span class="nc">ToStringArgumentConverter</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="nc">String</span> <span class="n">argument</span><span class="o">)</span> <span class="o">{</span>

    <span class="n">assertNotNull</span><span class="o">(</span><span class="nc">ChronoUnit</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">argument</span><span class="o">));</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ToStringArgumentConverter</span> <span class="kd">extends</span> <span class="nc">SimpleArgumentConverter</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="nc">Object</span> <span class="nf">convert</span><span class="o">(</span><span class="nc">Object</span> <span class="n">source</span><span class="o">,</span> <span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">targetType</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">targetType</span><span class="o">,</span> <span class="s">"Can only convert to String"</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">source</span> <span class="k">instanceof</span> <span class="nc">Enum</span><span class="o">&lt;?&gt;)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="o">((</span><span class="nc">Enum</span><span class="o">&lt;?&gt;)</span> <span class="n">source</span><span class="o">).</span><span class="na">name</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">source</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>データ型を変換するだけなら、<code>TypedArgumentConverter</code> を継承すれば、定型的な型チェックを省略できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ToLengthArgumentConverter</span> <span class="kd">extends</span> <span class="nc">TypedArgumentConverter</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">protected</span> <span class="nf">ToLengthArgumentConverter</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="nc">Integer</span> <span class="nf">convert</span><span class="o">(</span><span class="nc">String</span> <span class="n">source</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">source</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span> <span class="n">source</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">:</span> <span class="mi">0</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>引数の明示的な型変換を実装するのは、テストや拡張機能の作者の責任です。
それゆえに、<code>junit-jupiter-params</code> では参照実装として <code>JavaTimeArgumentConverter</code> だけを提供しています。
合成アノテーションの <code>JavaTimeConversionPattern</code> と一緒に使います。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@ValueSource</span><span class="o">(</span><span class="n">strings</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"01.01.2017"</span><span class="o">,</span> <span class="s">"31.12.2017"</span> <span class="o">})</span>
<span class="kt">void</span> <span class="nf">testWithExplicitJavaTimeConverter</span><span class="o">(</span>
        <span class="nd">@JavaTimeConversionPattern</span><span class="o">(</span><span class="s">"dd.MM.yyyy"</span><span class="o">)</span> <span class="nc">LocalDate</span> <span class="n">argument</span><span class="o">)</span> <span class="o">{</span>

    <span class="n">assertEquals</span><span class="o">(</span><span class="mi">2017</span><span class="o">,</span> <span class="n">argument</span><span class="o">.</span><span class="na">getYear</span><span class="o">());</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-parameterized-tests-argument-aggregation"><a class="anchor" href="#writing-tests-parameterized-tests-argument-aggregation"></a>2.15.5. 引数の集約</h4>
<div class="paragraph">
<p>既定では、パラメタライズテストに渡すそれぞれの <em>引数</em> は、1つ1つのメソッド引数に対応します。
つまり、複数の引数をかたまりとして提供するソースには、それだけ多くのメソッド引数が必要になるのです。</p>
</div>
<div class="paragraph">
<p>そういう場合はメソッド引数を複数宣言する代わりに <code><a href="../api/org.junit.jupiter.params/org/junit/jupiter/params/aggregator/ArgumentsAccessor.html">ArgumentsAccessor</a></code> を使用します。
この API を使用すると、複数の引数を単一のメソッド引数に渡すことができるようになります。
また、データ型の変換は <a href="#writing-tests-parameterized-tests-argument-conversion-implicit">暗黙的な型変換</a> と同様に行われます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvSource</span><span class="o">({</span>
    <span class="s">"Jane, Doe, F, 1990-05-20"</span><span class="o">,</span>
    <span class="s">"John, Doe, M, 1990-10-22"</span>
<span class="o">})</span>
<span class="kt">void</span> <span class="nf">testWithArgumentsAccessor</span><span class="o">(</span><span class="nc">ArgumentsAccessor</span> <span class="n">arguments</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Person</span> <span class="n">person</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Person</span><span class="o">(</span><span class="n">arguments</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span>
                               <span class="n">arguments</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span>
                               <span class="n">arguments</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="nc">Gender</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
                               <span class="n">arguments</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="nc">LocalDate</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">person</span><span class="o">.</span><span class="na">getFirstName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"Jane"</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="nc">Gender</span><span class="o">.</span><span class="na">F</span><span class="o">,</span> <span class="n">person</span><span class="o">.</span><span class="na">getGender</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="nc">Gender</span><span class="o">.</span><span class="na">M</span><span class="o">,</span> <span class="n">person</span><span class="o">.</span><span class="na">getGender</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Doe"</span><span class="o">,</span> <span class="n">person</span><span class="o">.</span><span class="na">getLastName</span><span class="o">());</span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1990</span><span class="o">,</span> <span class="n">person</span><span class="o">.</span><span class="na">getDateOfBirth</span><span class="o">().</span><span class="na">getYear</span><span class="o">());</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>_ <code>ArgumentsAccessor</code> 型の引数には自動的に <code>ArgumentsAccessor</code> のインスタンスが注入されます。_</p>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-argument-aggregation-custom"><a class="anchor" href="#writing-tests-parameterized-tests-argument-aggregation-custom"></a>独自の集約</h5>
<div class="paragraph">
<p>パラメタライズテストの中で直接 <code>ArgumentsAccessor</code> から引数へアクセスする代わりに、独自の再利用可能な <em>アグリゲーター</em> を使用できるようになっています。</p>
</div>
<div class="paragraph">
<p>独自のアグリゲーターをパラメタライズテストで使用するには、互換性のあるデータ型のメソッド引数を <code>@AggregateWith</code> で修飾し、<code><a href="../api/org.junit.jupiter.params/org/junit/jupiter/params/aggregator/ArgumentsAggregator.html">ArgumentsAggregator</a></code> インターフェイスの実装クラスを指定します。
テストメソッドを実行するとき、メソッド引数には集約した結果が渡されます。
<code>ArgumentsAggregator</code> の実装クラスはトップレベルクラスか <code>static</code> 宣言したインナークラスにしなければいけません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvSource</span><span class="o">({</span>
    <span class="s">"Jane, Doe, F, 1990-05-20"</span><span class="o">,</span>
    <span class="s">"John, Doe, M, 1990-10-22"</span>
<span class="o">})</span>
<span class="kt">void</span> <span class="nf">testWithArgumentsAggregator</span><span class="o">(</span><span class="nd">@AggregateWith</span><span class="o">(</span><span class="nc">PersonAggregator</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="nc">Person</span> <span class="n">person</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// perform assertions against person</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PersonAggregator</span> <span class="kd">implements</span> <span class="nc">ArgumentsAggregator</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">aggregateArguments</span><span class="o">(</span><span class="nc">ArgumentsAccessor</span> <span class="n">arguments</span><span class="o">,</span> <span class="nc">ParameterContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="n">arguments</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span>
                          <span class="n">arguments</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span>
                          <span class="n">arguments</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="nc">Gender</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
                          <span class="n">arguments</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="nc">LocalDate</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>コードベースのあちこちで、テストメソッドの複数の引数を <code>@AggregateWith(MyTypeAggregator.class)</code> で修飾しているような場合、<code>@AggregateWith(MyTypeAggregator.class)</code> のメタアノテーションとなる <code>@CsvToMyType</code> のような <em>合成アノテーション</em> が欲しくなるでしょう。
次のコード例は <code>PersonAggregator</code> を使用する <code>@CsvToPerson</code> アノテーションを定義しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvSource</span><span class="o">({</span>
    <span class="s">"Jane, Doe, F, 1990-05-20"</span><span class="o">,</span>
    <span class="s">"John, Doe, M, 1990-10-22"</span>
<span class="o">})</span>
<span class="kt">void</span> <span class="nf">testWithCustomAggregatorAnnotation</span><span class="o">(</span><span class="nd">@CsvToPerson</span> <span class="nc">Person</span> <span class="n">person</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// perform assertions against person</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">PARAMETER</span><span class="o">)</span>
<span class="nd">@AggregateWith</span><span class="o">(</span><span class="nc">PersonAggregator</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">CsvToPerson</span> <span class="o">{</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-parameterized-tests-display-names"><a class="anchor" href="#writing-tests-parameterized-tests-display-names"></a>2.15.6. 表示名の変更</h4>
<div class="paragraph">
<p>パラメタライズテストの表示名には、呼び出し回数を表す数値と、全てのメソッド引数の文字列表現が含まれています。
<code>ArgumentsAccessor</code> や <code>ArgumentAggregator</code> 以外のメソッド引数の値の前には、バイトコードに含まれている引数名が指定されています（テストコードをコンパイルするときに <code>-parameters</code> フラグを指定した場合です）。</p>
</div>
<div class="paragraph">
<p>しかし、<code>@ParameterizedTest</code> の <code>name</code> 属性に指定した文字列パターンで表示名は変更できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"Display name of container"</span><span class="o">)</span>
<span class="nd">@ParameterizedTest</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"{index} ==&gt; the rank of ''{0}'' is {1}"</span><span class="o">)</span>
<span class="nd">@CsvSource</span><span class="o">({</span> <span class="s">"apple, 1"</span><span class="o">,</span> <span class="s">"banana, 2"</span><span class="o">,</span> <span class="s">"'lemon, lime', 3"</span> <span class="o">})</span>
<span class="kt">void</span> <span class="nf">testWithCustomDisplayNames</span><span class="o">(</span><span class="nc">String</span> <span class="n">fruit</span><span class="o">,</span> <span class="kt">int</span> <span class="n">rank</span><span class="o">)</span> <span class="o">{</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>前のコード例を <code>ConsoleLauncher</code> で実行すると、次のように出力されます。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Display name of container ✔
├─ 1 ==&gt; the rank of 'apple' is 1 ✔
├─ 2 ==&gt; the rank of 'banana' is 2 ✔
└─ 3 ==&gt; the rank of 'lemon, lime' is 3 ✔</pre>
</div>
</div>
<div class="paragraph">
<p><code>name</code> 属性に指定できるのは <code>MessageFormat</code> が対応している文字列パターンです。
一重引用符（<code>'</code>）を使いたいときは2つ続けて（<code>''</code>）のようにしなければなりません。</p>
</div>
<div class="paragraph">
<p>表示名の文字列パターンが対応しているプレースホルダは次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">プレースホルダ</th>
<th class="tableblock halign-left valign-top">内容</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{displayName}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">メソッド名</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{index}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1から数え始める呼び出し回数</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{arguments}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">カンマ区切りにした引数の値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{argumentsWithNames}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">カンマ区切りにした引数の名前と値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{0}</code>, <code>{1}</code>, &#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">位置に対応する引数の値</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
引数を表示名に含めるとき、最大文字列長を超過するなら文字列表現は短縮されます。最大文字列長は <code>junit.jupiter.params.displayname.argument.maxlength</code> で指定できます。初期値は 512 文字です。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>@MethodSource</code> や <code>@ArgumentSource</code> を使うときは引数に名前を指定できます。
表示名の文字列パターンに引数の名前が含まれているときは、指定した名前が使われます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"A parameterized test with named arguments"</span><span class="o">)</span>
<span class="nd">@ParameterizedTest</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"{index}: {0}"</span><span class="o">)</span>
<span class="nd">@MethodSource</span><span class="o">(</span><span class="s">"namedArguments"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithNamedArguments</span><span class="o">(</span><span class="nc">File</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
<span class="o">}</span>

<span class="kd">static</span> <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">Arguments</span><span class="o">&gt;</span> <span class="nf">namedArguments</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">arguments</span><span class="o">(</span><span class="nc">Named</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"An important file"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"path1"</span><span class="o">))),</span>
        <span class="n">arguments</span><span class="o">(</span><span class="nc">Named</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"Another file"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"path2"</span><span class="o">))));</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>A parameterized test with named arguments ✔
├─ 1: An important file ✔
└─ 2: Another file ✔</pre>
</div>
</div>
<div class="paragraph">
<p>プロジェクトに含まれる全てのパラメタライズテストで使用する表示名の文字列パターンを指定するには、<code>junit-platform.properties</code> を次のように記述します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="properties"><span class="py">junit.jupiter.params.displayname.default</span> <span class="p">=</span> <span class="s">{index}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>パラメタライズテストの表示名を決定する規則は次のとおりです。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>@ParameterizedTest</code> の <code>name</code> 属性の値</p>
</li>
<li>
<p>（存在するなら）<code>junit-platform.properties</code> で指定された <code>junit.jupiter.params.displayname.default</code> の値</p>
</li>
<li>
<p><code>@ParameterizedTest</code> に定義された定数 <code>DEFAULT_DISPLAY_NAME</code> の値</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-parameterized-tests-lifecycle-interop"><a class="anchor" href="#writing-tests-parameterized-tests-lifecycle-interop"></a>2.15.7. ライフサイクルと相互運用性</h4>
<div class="paragraph">
<p>パラメタライズテストのそれぞれの呼び出しには、普通の <code>@Test</code> メソッドを呼び出すのと同じライフサイクルが伴います。
例えば、<code>@BeforeEach</code> は毎回呼び出されるということです。
<a href="#writing-tests-dynamic-tests">実行時にテストを生成する</a> と同様に、IDE からはそれぞれの呼び出し結果が1つのツリーにぶら下がるように見えることになります。
同じテストクラスで <code>@ParameterizedTest</code> と普通の <code>@Test</code> を混ぜて使用できます。</p>
</div>
<div class="paragraph">
<p><code>@ParameterizedTest</code> と <code>ParameterResolver</code> 拡張を組み合わせて使用するとしても、メソッド引数の前のほうには <code>@ArgumentSource</code> で解決する引数を定義しなければなりません。
テストクラスにパラメタライズテストと普通のテストメソッドを定義している、かつ、普通のテストメソッドにはパラメタライズテストと異なる引数を定義しているとしたら、普通のテストメソッドを実行するとき、<code>@BeforeEach</code> などのライフサイクルメソッドやテストクラスのコンストラクタでは、<code>@ArgumentSource</code> による引数の解決は行われません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@BeforeEach</span>
<span class="kt">void</span> <span class="nf">beforeEach</span><span class="o">(</span><span class="nc">TestInfo</span> <span class="n">testInfo</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@ParameterizedTest</span>
<span class="nd">@ValueSource</span><span class="o">(</span><span class="n">strings</span> <span class="o">=</span> <span class="s">"apple"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithRegularParameterResolver</span><span class="o">(</span><span class="nc">String</span> <span class="n">argument</span><span class="o">,</span> <span class="nc">TestReporter</span> <span class="n">testReporter</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">testReporter</span><span class="o">.</span><span class="na">publishEntry</span><span class="o">(</span><span class="s">"argument"</span><span class="o">,</span> <span class="n">argument</span><span class="o">);</span>
<span class="o">}</span>

<span class="nd">@AfterEach</span>
<span class="kt">void</span> <span class="nf">afterEach</span><span class="o">(</span><span class="nc">TestInfo</span> <span class="n">testInfo</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-test-templates"><a class="anchor" href="#writing-tests-test-templates"></a>2.16. テストのテンプレート化</h3>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/TestTemplate.html">@TestTemplate</a></code> で修飾したメソッドは、普通のテストメソッドではなくテンプレートとして使われます。
登録したプロバイダーの返す呼び出しコンテキストの数と同じだけ呼び出す前提で設計します。
つまり、定義済みの <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/TestTemplateInvocationContextProvider.html">TestTemplateInvocationContextProvider</a></code> 拡張と組み合わせて使用しなければなりません。
それぞれの呼び出しは、普通の <code>@Test</code> メソッドと完全に同じライフサイクルメソッドと拡張機能に対応しています。
具体的な使い方は <a href="#extensions-test-templates">テストテンプレートに呼び出し元のコンテキストを与える</a> を参照してください。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="#writing-tests-repeated-tests">繰り返しテスト</a> と <a href="#writing-tests-parameterized-tests">パラメタライズテスト</a> はテストのテンプレート化機能で実装されています。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-dynamic-tests"><a class="anchor" href="#writing-tests-dynamic-tests"></a>2.17. 実行時にテストを生成する</h3>
<div class="paragraph">
<p>JUnit Jupiter における基本的な <code>@Test</code> アノテーション（<a href="#writing-tests-annotations">アノテーション</a> を参照）は、JUnit 4 の <code>@Test</code> と非常によく似た機能を提供します。
あるメソッドがテストを実装したものであることを示しているのです。
これらのテストはコンパイル時に確定するため、ある意味静的なものであり、実行時に振る舞いを変更できません。
<em>仮定（Assumption）は動的な振る舞いの基本的な形態ではありますが、その表現力は意図的に制限されています。</em></p>
</div>
<div class="paragraph">
<p>JUnit Jupiter では、これまでの標準的なテストとは全く異なる新しいテストプログラミングモデルとして <em>動的テスト</em> を導入しました。
<code>@TestFactory</code> で修飾したファクトリメソッドで、実行時にテストメソッドを生成するのです。</p>
</div>
<div class="paragraph">
<p>普通のテストメソッドと違って、<code>@TestFactory</code> で修飾したメソッドはテストメソッドではなく、ファクトリメソッドなのです。
ファクトリメソッドで、動的テストを生成するのです。
具体的には、<code>@TestFactory</code> で修飾したファクトリメソッドの返り値は、単独の <code>DynamicNode</code> か、<code>DynamicNode</code> を要素とする <code>Stream, Collection, Iterable, Iterator</code> あるいは配列にします。
<code>DynamicNode</code> の派生クラス <code>DynamicContainer</code> および <code>DynamicTest</code> はインスタンス化可能です。
<code>DynamicContainer</code> は <em>表示名</em> と <code>DynamicNode</code> のリストを組み合わせたもので、任意の入れ子構造を作成できます。
<code>DynamicTest</code> は遅延評価（実行）するインスタンスで、実行時に、非決定論的なテストを表現できます。</p>
</div>
<div class="paragraph">
<p><code>@TestFactory</code> メソッドの返り値が <code>Stream</code> の場合、<code>Files.lines()</code> のようにリソースを安全に使うため、<code>stream.close()</code> で閉じないといけいません。</p>
</div>
<div class="paragraph">
<p><code>@Test</code> メソッドと同じく、<code>@TestFactory</code> メソッドの可視性は <code>private</code> にできません。
また、<code>static</code> 宣言することもできません。
さらに、<code>ParameterResolvers</code> でメソッド引数を解決できます。</p>
</div>
<div class="paragraph">
<p><code>DynamicTest</code> は実行時に生成するテストケースで、<em>表示名</em> と <code>Executable</code> を組み合わせたものです。
<code>Executable</code> は <code>@FunctionalInterface</code> の実装クラスのことで、動的クラスにおいては <em>ラムダ式</em> や <em>メソッド参照</em> として記述できます。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">動的テストのライフサイクル</div>
動的テストのライフサイクルは普通のテストメソッドとは大きく異なります。特に違うのは、動的テストにはライフサイクルメソッドの呼び出しが伴わないことです。
つまり、<code>@TestFactory</code> メソッドを呼び出すときは <code>@BeforeEach</code> や <code>@AfterEach</code> メソッド（および関連する拡張機能）も呼び出されるのですが、動的テスト自体を実行するときは呼び出されないのです。
言い換えると、動的テストの実装であるラムダ式からテストクラスのインスタンスフィールドへアクセスするとしても、同じ <code>@TestFactory</code> メソッドの生成したそれぞれの動的テストを呼び出している間に、フィールドを初期化するライフサイクルメソッドは呼び出されないのです。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>JUnit Jupiter 5.8.0 の時点では、ファクトリメソッドでしか動的テストを生成できませんが、将来的には登録方式でも生成できるようになるでしょう。</p>
</div>
<div class="sect3">
<h4 id="writing-tests-dynamic-tests-examples"><a class="anchor" href="#writing-tests-dynamic-tests-examples"></a>2.17.1. 動的テストの具体例</h4>
<div class="paragraph">
<p>次のコード例では <code>DynamicTestsDemo</code> クラスにより動的テストのいろいろな使い方を紹介します。</p>
</div>
<div class="paragraph">
<p>最初のメソッドは返り値の型が間違っているのですが、コンパイル時に検出できないので、実行時に <code>JUnitException</code> をスローします。</p>
</div>
<div class="paragraph">
<p>2つ目から続く6つのメソッドは、<code>DynamicTest</code> を要素とする <code>Collection, Iterable, Iterator, 配列, Stream</code> を返り値の型にしています。
特に動的な振る舞いを説明するものではありませんが、対応している返り値の型は分かると思います。
<code>dynamicTestsFromStream()</code> や <code>dynamicTestsFromIntStream()</code> を見れば、複数の文字列や、数値の範囲に基づく動的なテストを簡単に生成できるのが分かります。</p>
</div>
<div class="paragraph">
<p><code>generateRandomNumberOfTests()</code> は動的テストの本来の性質を活用しています。
乱数を生成する <code>Iterator</code>、表示名を生成するラムダ式、テストロジックを実装したラムダ式を <code>DynamicTest.stream()</code> へ渡しています。
どの辺が本来の性質なのかというと、実行するたびに結果が変化するところです。
動的テストの表現力を証明するためのコード例なので、実際に使用する場合は注意してください。</p>
</div>
<div class="paragraph">
<p><code>generateRandomNumberOfTests()</code> と同じように柔軟性を活用しているのが <code>dynamicTestsFromStreamFactoryMethod()</code> です。
ファクトリメソッドの <code>DynamicTest.stream()</code> へ <code>Stream</code> を渡しているのが違うところです。</p>
</div>
<div class="paragraph">
<p><code>dynamicNodeSingleTest()</code> が単一の <code>DynamicTest</code> を返すようになっているのはあくまでも説明用です。
<code>dynamicNodeSingleContainer()</code> では、<code>DynamicContainer</code> で動的テストの入れ子構造を作成しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">StringUtils</span><span class="o">.</span><span class="na">isPalindrome</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertFalse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertNotNull</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">DynamicContainer</span><span class="o">.</span><span class="na">dynamicContainer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">DynamicTest</span><span class="o">.</span><span class="na">dynamicTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Named</span><span class="o">.</span><span class="na">named</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Collection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.function.Function</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.stream.IntStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.stream.Stream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">example.util.Calculator</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DynamicNode</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DynamicTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Named</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Tag</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.TestFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.function.ThrowingConsumer</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">DynamicTestsDemo</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Calculator</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Calculator</span><span class="o">();</span>

    <span class="c1">// This will result in a JUnitException!</span>
    <span class="nd">@TestFactory</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">dynamicTestsWithInvalidReturnType</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"Hello"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@TestFactory</span>
    <span class="nc">Collection</span><span class="o">&lt;</span><span class="nc">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromCollection</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span>
            <span class="n">dynamicTest</span><span class="o">(</span><span class="s">"1st dynamic test"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">isPalindrome</span><span class="o">(</span><span class="s">"madam"</span><span class="o">))),</span>
            <span class="n">dynamicTest</span><span class="o">(</span><span class="s">"2nd dynamic test"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">multiply</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">2</span><span class="o">)))</span>
        <span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@TestFactory</span>
    <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromIterable</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span>
            <span class="n">dynamicTest</span><span class="o">(</span><span class="s">"3rd dynamic test"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">isPalindrome</span><span class="o">(</span><span class="s">"madam"</span><span class="o">))),</span>
            <span class="n">dynamicTest</span><span class="o">(</span><span class="s">"4th dynamic test"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">multiply</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">2</span><span class="o">)))</span>
        <span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@TestFactory</span>
    <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromIterator</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span>
            <span class="n">dynamicTest</span><span class="o">(</span><span class="s">"5th dynamic test"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">isPalindrome</span><span class="o">(</span><span class="s">"madam"</span><span class="o">))),</span>
            <span class="n">dynamicTest</span><span class="o">(</span><span class="s">"6th dynamic test"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">multiply</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">2</span><span class="o">)))</span>
        <span class="o">).</span><span class="na">iterator</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@TestFactory</span>
    <span class="nc">DynamicTest</span><span class="o">[]</span> <span class="nf">dynamicTestsFromArray</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">DynamicTest</span><span class="o">[]</span> <span class="o">{</span>
            <span class="n">dynamicTest</span><span class="o">(</span><span class="s">"7th dynamic test"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">isPalindrome</span><span class="o">(</span><span class="s">"madam"</span><span class="o">))),</span>
            <span class="n">dynamicTest</span><span class="o">(</span><span class="s">"8th dynamic test"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">multiply</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">2</span><span class="o">)))</span>
        <span class="o">};</span>
    <span class="o">}</span>

    <span class="nd">@TestFactory</span>
    <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromStream</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"racecar"</span><span class="o">,</span> <span class="s">"radar"</span><span class="o">,</span> <span class="s">"mom"</span><span class="o">,</span> <span class="s">"dad"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">text</span> <span class="o">-&gt;</span> <span class="n">dynamicTest</span><span class="o">(</span><span class="n">text</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">isPalindrome</span><span class="o">(</span><span class="n">text</span><span class="o">))));</span>
    <span class="o">}</span>

    <span class="nd">@TestFactory</span>
    <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromIntStream</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Generates tests for the first 10 even integers.</span>
        <span class="k">return</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">iterate</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="o">).</span><span class="na">limit</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
            <span class="o">.</span><span class="na">mapToObj</span><span class="o">(</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">dynamicTest</span><span class="o">(</span><span class="s">"test"</span> <span class="o">+</span> <span class="n">n</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)));</span>
    <span class="o">}</span>

    <span class="nd">@TestFactory</span>
    <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">DynamicTest</span><span class="o">&gt;</span> <span class="nf">generateRandomNumberOfTestsFromIterator</span><span class="o">()</span> <span class="o">{</span>

        <span class="c1">// Generates random positive integers between 0 and 100 until</span>
        <span class="c1">// a number evenly divisible by 7 is encountered.</span>
        <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">inputGenerator</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;()</span> <span class="o">{</span>

            <span class="nc">Random</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">();</span>
            <span class="kt">int</span> <span class="n">current</span><span class="o">;</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
                <span class="n">current</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
                <span class="k">return</span> <span class="n">current</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">current</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">};</span>

        <span class="c1">// Generates display names like: input:5, input:37, input:85, etc.</span>
        <span class="nc">Function</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">displayNameGenerator</span> <span class="o">=</span> <span class="o">(</span><span class="n">input</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="s">"input:"</span> <span class="o">+</span> <span class="n">input</span><span class="o">;</span>

        <span class="c1">// Executes tests based on the current input value.</span>
        <span class="nc">ThrowingConsumer</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">testExecutor</span> <span class="o">=</span> <span class="o">(</span><span class="n">input</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">input</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">);</span>

        <span class="c1">// Returns a stream of dynamic tests.</span>
        <span class="k">return</span> <span class="nc">DynamicTest</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">inputGenerator</span><span class="o">,</span> <span class="n">displayNameGenerator</span><span class="o">,</span> <span class="n">testExecutor</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@TestFactory</span>
    <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromStreamFactoryMethod</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Stream of palindromes to check</span>
        <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"racecar"</span><span class="o">,</span> <span class="s">"radar"</span><span class="o">,</span> <span class="s">"mom"</span><span class="o">,</span> <span class="s">"dad"</span><span class="o">);</span>

        <span class="c1">// Generates display names like: racecar is a palindrome</span>
        <span class="nc">Function</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">displayNameGenerator</span> <span class="o">=</span> <span class="n">text</span> <span class="o">-&gt;</span> <span class="n">text</span> <span class="o">+</span> <span class="s">" is a palindrome"</span><span class="o">;</span>

        <span class="c1">// Executes tests based on the current input value.</span>
        <span class="nc">ThrowingConsumer</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">testExecutor</span> <span class="o">=</span> <span class="n">text</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">isPalindrome</span><span class="o">(</span><span class="n">text</span><span class="o">));</span>

        <span class="c1">// Returns a stream of dynamic tests.</span>
        <span class="k">return</span> <span class="nc">DynamicTest</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">inputStream</span><span class="o">,</span> <span class="n">displayNameGenerator</span><span class="o">,</span> <span class="n">testExecutor</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@TestFactory</span>
    <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromStreamFactoryMethodWithNames</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Stream of palindromes to check</span>
        <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">Named</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;&gt;</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                <span class="n">named</span><span class="o">(</span><span class="s">"racecar is a palindrome"</span><span class="o">,</span> <span class="s">"racecar"</span><span class="o">),</span>
                <span class="n">named</span><span class="o">(</span><span class="s">"radar is also a palindrome"</span><span class="o">,</span> <span class="s">"radar"</span><span class="o">),</span>
                <span class="n">named</span><span class="o">(</span><span class="s">"mom also seems to be a palindrome"</span><span class="o">,</span> <span class="s">"mom"</span><span class="o">),</span>
                <span class="n">named</span><span class="o">(</span><span class="s">"dad is yet another palindrome"</span><span class="o">,</span> <span class="s">"dad"</span><span class="o">)</span>
            <span class="o">);</span>

        <span class="c1">// Returns a stream of dynamic tests.</span>
        <span class="k">return</span> <span class="nc">DynamicTest</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">inputStream</span><span class="o">,</span>
            <span class="n">text</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">isPalindrome</span><span class="o">(</span><span class="n">text</span><span class="o">)));</span>
    <span class="o">}</span>

    <span class="nd">@TestFactory</span>
    <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">DynamicNode</span><span class="o">&gt;</span> <span class="nf">dynamicTestsWithContainers</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="s">"B"</span><span class="o">,</span> <span class="s">"C"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">input</span> <span class="o">-&gt;</span> <span class="n">dynamicContainer</span><span class="o">(</span><span class="s">"Container "</span> <span class="o">+</span> <span class="n">input</span><span class="o">,</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                <span class="n">dynamicTest</span><span class="o">(</span><span class="s">"not null"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertNotNull</span><span class="o">(</span><span class="n">input</span><span class="o">)),</span>
                <span class="n">dynamicContainer</span><span class="o">(</span><span class="s">"properties"</span><span class="o">,</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                    <span class="n">dynamicTest</span><span class="o">(</span><span class="s">"length &gt; 0"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)),</span>
                    <span class="n">dynamicTest</span><span class="o">(</span><span class="s">"not empty"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertFalse</span><span class="o">(</span><span class="n">input</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()))</span>
                <span class="o">))</span>
            <span class="o">)));</span>
    <span class="o">}</span>

    <span class="nd">@TestFactory</span>
    <span class="nc">DynamicNode</span> <span class="nf">dynamicNodeSingleTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">dynamicTest</span><span class="o">(</span><span class="s">"'pop' is a palindrome"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">isPalindrome</span><span class="o">(</span><span class="s">"pop"</span><span class="o">)));</span>
    <span class="o">}</span>

    <span class="nd">@TestFactory</span>
    <span class="nc">DynamicNode</span> <span class="nf">dynamicNodeSingleContainer</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">dynamicContainer</span><span class="o">(</span><span class="s">"palindromes"</span><span class="o">,</span>
            <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"racecar"</span><span class="o">,</span> <span class="s">"radar"</span><span class="o">,</span> <span class="s">"mom"</span><span class="o">,</span> <span class="s">"dad"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">text</span> <span class="o">-&gt;</span> <span class="n">dynamicTest</span><span class="o">(</span><span class="n">text</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">isPalindrome</span><span class="o">(</span><span class="n">text</span><span class="o">)))</span>
        <span class="o">));</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-dynamic-tests-uri-test-source"><a class="anchor" href="#writing-tests-dynamic-tests-uri-test-source"></a>2.17.2. 動的テストのための URI テストソース</h4>
<div class="paragraph">
<p>JUnit Platform の提供する <code>TestSource</code> は、テストやテストコンテナを表現するインターフェイスです。
テストメソッドの作成位置や取得元を IDE およびビルドツールに教えるために使用します。</p>
</div>
<div class="paragraph">
<p>動的テスト（あるいは動的テストコンテナ）の <code>TestSource</code> を作成するときは、 <code>DynamicTest.dynamicTest(String, URI, Executable)</code> や <code>DynamicTest.dynbamicContainer(String, URI, Stream)</code> のようにファクトリメソッドへ <code>java.net.URI</code> を渡すようにします。
JUnit Jupiter は <code>URI</code> を解釈して次のいずれかの実装クラスを生成します。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ClasspathResourceSource</code> </dt>
<dd>
<p><code>URI</code> のプロトコルスキームが <code>classpath</code> のとき。例えば <code>classpath:/test/foo.xml?line=20,column=2</code></p>
</dd>
<dt class="hdlist1"><code>DirectorySource</code> </dt>
<dd>
<p><code>URI</code> がファイルシステム上のディレクトリを指しているとき。</p>
</dd>
<dt class="hdlist1"><code>FileSource</code> </dt>
<dd>
<p><code>URI</code> がファイルシステム上のファイルを指しているとき。</p>
</dd>
<dt class="hdlist1"><code>MethodSource</code> </dt>
<dd>
<p><code>URI</code> のプロトコルスキームが <code>method</code> で、位置が完全修飾メソッド名（FQMN：Fully Qualified Method Name）のとき。例えば <code>method:org.junit.Foo#bar(Java.lang.String, java.lang.String[])</code>
FQMN の形式については <code>DiscoverySelectors.selectMethod(String)</code> の Javadoc を参照してください。</p>
</dd>
<dt class="hdlist1"><code>ClassSource</code> </dt>
<dd>
<p><code>URI</code> のプロトコルスキームが <code>class</code> で、位置が完全修飾クラス名（FQCN：Fully Qualified Class Name）のとき。例えば <code>class:org.junit.Foo#line=42</code></p>
</dd>
<dt class="hdlist1"><code>UriSource</code> </dt>
<dd>
<p>上記のどれにも該当しないとき。</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-declarative-timeouts"><a class="anchor" href="#writing-tests-declarative-timeouts"></a>2.18. タイムアウト</h3>
<div class="paragraph">
<p>テストメソッド、テストファクトリメソッド、テストテンプレート、ライフサイクルメソッドのいずれかを <code>@Timeout</code> で修飾すると、指定した時間を過ぎても終了しなかったら失敗させることができるようになります。
時間単位の初期値は秒ですが、自由に変更できます。</p>
</div>
<div class="paragraph">
<p>次のコード例は <code>@Timeout</code> の使い方を説明しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">TimeoutDemo</span> <span class="o">{</span>

    <span class="nd">@BeforeEach</span>
    <span class="nd">@Timeout</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">setUp</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// fails if execution time exceeds 5 seconds</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@Timeout</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">100</span><span class="o">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="nc">TimeUnit</span><span class="o">.</span><span class="na">MILLISECONDS</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">failsIfExecutionTimeExceeds100Milliseconds</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// fails if execution time exceeds 100 milliseconds</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>assertTimeoutPreemptively()</code> と違って、修飾したメソッドの実行時間は、テストの主スレッドが計測します。
メソッドの実行時間が指定した時間を超過したら、他のスレッドから主スレッドに対して割り込みを発生させます。
どうしてこういう仕組みにしているのかというと、Spring Framework のように、テストメソッドを実行しているスレッドの <code>ThreadLocal</code> でトランザクション状態を管理している場合があるからです。</p>
</div>
<div class="paragraph">
<p>トップレベルクラスを <code>@Timeout</code> で修飾すれば、（<code>@Nested</code> クラスで定義したメソッドも含めて）全てのテストメソッド、テストファクトリ、テストテンプレートに同じ時間制限を適用できます。
それぞれのメソッド（あるいは <code>@Nested</code> クラス）で時間制限を上書きするには <code>@Timeout</code> で修飾します。
クラスを修飾した場合、ライフサイクルメソッドに時間制限は適用されない点に注意してください。</p>
</div>
<div class="paragraph">
<p>テストファクトリを <code>@Timeout</code> で修飾しても、テストファクトリを実行する時間、つまり、動的テストを生成する時間だけがチェックされます。
それぞれの動的テストで実行時間を制限するには <code>assertTimeout()</code> や <code>assertTimeoutPreemptively()</code> を使用してください。</p>
</div>
<div class="paragraph">
<p><code>@RepeatedTest</code> や <code>@ParameterizedTest</code> などのテストテンプレートについては、それぞれのテストメソッドについて <code>@Timeout</code> で指定した時間制限が適用されます。</p>
</div>
<div class="paragraph">
<p>次の <a href="#running-tests-config-params">設定パラメータ</a> を設定すると、テストメソッドやライフサイクルメソッドの種類に応じて、<code>@Timeout</code> を指定しなかったメソッドのタイムアウト時間を変更できます。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>junit.jupiter.execution.timeout.default</code></dt>
<dd>
<p>全てのテストメソッドとライフサイクルメソッドのタイムアウト時間。</p>
</dd>
<dt class="hdlist1"><code>junit.jupiter.execution.timeout.testable.method.default</code></dt>
<dd>
<p>全てのテストメソッドのタイムアウト時間。</p>
</dd>
<dt class="hdlist1"><code>junit.jupiter.execution.timeout.test.method.default</code></dt>
<dd>
<p><code>@Test</code> で修飾したメソッドのタイムアウト時間。</p>
</dd>
<dt class="hdlist1"><code>junit.jupiter.execution.timeout.testtemplate.method.default</code></dt>
<dd>
<p><code>@TestTemplate</code> で修飾したメソッドのタイムアウト時間。</p>
</dd>
<dt class="hdlist1"><code>junit.jupiter.execution.timeout.testfactory.method.default</code></dt>
<dd>
<p><code>@TestFactory</code> で修飾したメソッドのタイムアウト時間。</p>
</dd>
<dt class="hdlist1"><code>junit.jupiter.execution.timeout.lifecycle.method.default</code></dt>
<dd>
<p>全てのライフサイクルメソッドのタイムアウト時間。</p>
</dd>
<dt class="hdlist1"><code>junit.jupiter.execution.timeout.beforeall.method.default</code></dt>
<dd>
<p><code>@BeforeAll</code> で修飾したメソッドのタイムアウト時間。</p>
</dd>
<dt class="hdlist1"><code>junit.jupiter.execution.timeout.beforeeach.method.default</code></dt>
<dd>
<p><code>@BeforeEach</code> で修飾したメソッドのタイムアウト時間。</p>
</dd>
<dt class="hdlist1"><code>junit.jupiter.execution.timeout.aftereach.method.default</code></dt>
<dd>
<p><code>@AfterEach</code> で修飾したメソッドのタイムアウト時間。</p>
</dd>
<dt class="hdlist1"><code>junit.jupiter.execution.timeout.afterall.method.default</code></dt>
<dd>
<p><code>@AfterAll</code> で修飾したメソッドのタイムアウト時間。</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>より抽象度の低い設定項目は、抽象度の高い設定項目の値を上書きします。
具体的には、<code>junit.jupiter.execution.timeout.test.method.default</code> は <code>junit.jupiter.execution.timeout.testable.method.default</code> を上書きし、<code>junit.jupiter.execution.timeout.testable.method.default</code> は <code>junit.jupiter.execution.timeout.default</code> を上書きします。</p>
</div>
<div class="paragraph">
<p>設定パラメータに記述する値の形式は <code>&lt;number&gt; [ns|μs|ms|s|m|h|d]</code> です（大文字小文字は区別しません）。
数値と時間単位の間の空白は無視します。
時間単位を指定しなかった場合は秒として解釈します。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. 設定パラメータにおけるタイムアウト時間の設定例</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">設定値</th>
<th class="tableblock halign-left valign-top">アノテーションで同じ結果になる記述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>42</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Timeout(42)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>42 ns</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Timeout(value = 42, unit = NANOSECONDS)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>42 μs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Timeout(value = 42, unit = MICROSECONDS)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>42 ms</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Timeout(value = 42, unit = MILLISECONDS)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>42 s</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Timeout(value = 42, unit = SECONDS)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>42 m</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Timeout(value = 42, unit = MINUTES)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>42 h</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Timeout(value = 42, unit = HOURS)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>42 d</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Timeout(value = 42, unit = DAYS)</code></p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="writing-tests-declarative-timeouts-polling"><a class="anchor" href="#writing-tests-declarative-timeouts-polling"></a>2.18.1. ポーリングテストで @Timeout を使用する</h4>
<div class="paragraph">
<p>非同期処理を実行するコードでは、結果に対するアサーションを実行する前に、定期的に結果を確認するようなテストを書く場合があります。
そういうロジックは <code>CountDownLatch</code> のような同期のための仕組みで実装できる場合もありますが、できない場合が問題です。
例えば、テスト対象のコードが外部のメッセージブローカーのチャンネルにメッセージを送信する場合、送信が成功（完了）するまでアサーションを実行できません。
非同期処理をテストするコードでは、テストスイート全体がハングアップしないようタイムアウト時間を設定しなければなりません。</p>
</div>
<div class="paragraph">
<p>非同期処理のテストで定期的に結果を確認するためにタイムアウト時間を設定すれば、テストが永遠に止まらないことを避けられます。
次のコード例のように、<code>@Timeout</code> で「指定した時間まで待ち続ける」ロジックを簡単に記述できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Test</span>
<span class="nd">@Timeout</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span> <span class="c1">// Poll at most 5 seconds</span>
<span class="kt">void</span> <span class="nf">pollUntil</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">asynchronousResultNotAvailable</span><span class="o">())</span> <span class="o">{</span>
        <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">250</span><span class="o">);</span> <span class="c1">// custom poll interval</span>
    <span class="o">}</span>
    <span class="c1">// Obtain the asynchronous result and perform assertions</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
非同期処理のテストにおいて、定期的な確認時間を指定する以上の柔軟性が必要なときは、外部ライブラリの <a href="https://github.com/awaitility/awaitility">Awaitility</a> を検討してください。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-declarative-timeouts-mode"><a class="anchor" href="#writing-tests-declarative-timeouts-mode"></a>2.18.2. 全体で @Timeout を無効化する</h4>
<div class="paragraph">
<p>テスト対象のソースコードをデバッガで調べていると、タイムアウト時間を固定値にしたテストが失敗になってしまう場合があります。</p>
</div>
<div class="paragraph">
<p>JUnit Jupiter の設定パラメータ <code>junit.jupiter.execution.timeout.mode</code> には3種類の値（<code>enabled, disabled, disabled_on_debug</code>）を指定できます。初期値は <code>enabled</code> です。
<code>disabled_on_debug</code> にすると、JVM をデバッグモードで実行しているかどうかを <code>-agentlib:jdwp</code> フラグの有無で判断します。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-parallel-execution"><a class="anchor" href="#writing-tests-parallel-execution"></a>2.19. 並列実行</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">並列実行機能は実験的な機能です</div>
JUnit チームがこの機能を改善して、正式機能へ <a href="#api-evolution">昇格</a> できるよう、試用してフィードバックを提供してください。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>JUnit Jupiter はテストを1スレッドで逐次的に実行します。
5.3 から導入された並列実行機能は、テスト実行時間を短縮するための機能で、使用するには明示的な設定が必要でした。
設定パラメータの <code>junit.jupiter.execution.parallel.enabled</code> を <code>true</code> 指定しなければなりません。
設定する場所は <code>Junit-platform.properties</code> です（他の設定項目については <a href="#running-tests-config-params">設定パラメータの構成</a> を参照してください）。</p>
</div>
<div class="paragraph">
<p>この設定項目を有効化するのは、テストを並列実行するための最初の一歩にすぎません。
設定項目を有効化しただけではテストの実行方法は変わりません。
テストツリーを構成するどのノードを並行して実行するかは、実行モードによって異なります。
実行モードに指定できる値は次の2つです。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>SAME_THREAD</code></dt>
<dd>
<p>強制的に親ノードと同じスレッドで実行します。
例えば、テストメソッドに指定した場合、同じテストクラスの全ての <code>@BeforeAll</code> と <code>@AfterAll</code> は同じスレッドで実行します。</p>
</dd>
<dt class="hdlist1"><code>CONCURRENT</code></dt>
<dd>
<p>リソースロックにより同じスレッドでの実行を強制されない限り、並行して実行します。</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>基本的にテストツリーのノードの実行モードは <code>SAME_THREAD</code> になっています。
これは設定パラメータの <code>junit.jupiter.execution.parallel.mode.default</code> で変更できます。
実行モードは <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/parallel/Execution.html">@Execution</a></code> アノテーションでも変更できます。
このアノテーションで修飾した要素やその子要素は、それぞれのテストクラスの中で並列に実行するようになります。</p>
</div>
<div class="listingblock">
<div class="title">設定例：全てのテストを並列に実行する</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="properties"><span class="py">junit.jupiter.execution.parallel.enabled</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">junit.jupiter.execution.parallel.mode.default</span> <span class="p">=</span> <span class="s">concurrent</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>一部の例外を除いて、既定の実行モードは全てのノードに適用されます。
例外は、インスタンスライフサイクル管理がクラス単位（per-class）になっているテストクラスと、<code>@TestMethodOrder</code> で <a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/MethodOrderer.Random.html">MethodOrderer.Random</a>` 以外の <code>{MethodOrder}</code> を指定しているテストクラスです。
前者の場合、テストの作成者はテストクラスがスレッド安全であることを保証しなければなりません。
後者の場合、並行実行と実行順序の指定が矛盾してしまいます。
それゆえに、どちらの場合もテストクラスやテストメソッドが <code>@Execution(CONCURRENT)</code> で修飾されている場合だけ、並行して実行するようになっています。</p>
</div>
<div class="paragraph">
<p>宣言的な <a href="#writing-tests-parallel-execution-synchronization">同期化機構</a> が使われているとしても、テストツリーの全てのノードの実行モードが <code>CONCURRENT</code> になっているなら、<a href="#writing-tests-parallel-execution-config">設定パラメータ</a> に応じて全てを並行して実行します。
<a href="#running-tests-capturing-output">標準出力や標準エラー出力をキャプチャーする</a> は独立して有効化しなければなりません。</p>
</div>
<div class="paragraph">
<p>さらに、トップレベルクラスの既定の実行モードを <code>junit.jupiter.execution.parallel.mode.classes.default</code> で変更できます。
両方の設定項目を組み合わせれば、テストクラスは並列に実行するけど、テストメソッドは同じスレッドで実行させることができます。</p>
</div>
<div class="listingblock">
<div class="title">設定例：トップレベルクラスは並列に実行し、テストメソッドは同じスレッドで実行する</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="properties"><span class="py">junit.jupiter.execution.parallel.enabled</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">junit.jupiter.execution.parallel.mode.default</span> <span class="p">=</span> <span class="s">same_thread</span>
<span class="py">junit.jupiter.execution.parallel.mode.classes.default</span> <span class="p">=</span> <span class="s">concurrent</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>逆に、同じテストクラスのテストメソッドは並列に実行するけど、トップレベルクラスは逐次的に実行させることもできます。</p>
</div>
<div class="listingblock">
<div class="title">設定例：トップレベルクラスは逐次的に実行し、テストメソッドは並列に実行する</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="properties"><span class="py">junit.jupiter.execution.parallel.enabled</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">junit.jupiter.execution.parallel.mode.default</span> <span class="p">=</span> <span class="s">concurrent</span>
<span class="py">junit.jupiter.execution.parallel.mode.classes.default</span> <span class="p">=</span> <span class="s">same_thread</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>次の図は、設定パラメータ <code>junit.jupiter.execution.parallel.mode.default</code> と <code>junit.jupiter.execution.parallel.mode.classes.default</code> の値の全ての（4種類の）組み合わせについて、2つのトップレベルクラス <code>A</code> と <code>B</code> それぞれに定義した2つのテストメソッドがどのように実行させるかを示しています。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/writing-tests_execution_mode.svg" alt="writing tests execution mode">
</div>
<div class="title">Default execution mode configuration combinations</div>
</div>
<div class="paragraph">
<p>設定パラメータ <code>junit.jupiter.execution.parallel.mode.classes.default</code> を指定しなかったときは、代わりに <code>junit.jupiter.execution.parallel.mode.default</code> の設定値を使用します。</p>
</div>
<div class="sect3">
<h4 id="writing-tests-parallel-execution-config"><a class="anchor" href="#writing-tests-parallel-execution-config"></a>2.19.1. 設定方法</h4>
<div class="paragraph">
<p>並列度とスレッドプールサイズの最大値は <code><a href="../api/org.junit.platform.engine/org/junit/platform/engine/support/hierarchical/ParallelExecutionConfigurationStrategy.html">ParallelExecutionConfigurationStrategy</a></code> で設定します。
JUnit Platform は <code>dynamic</code> と <code>fixed</code> という2種類の実装を提供しています。
自分で作成する場合は <code>custom</code> を指定します。</p>
</div>
<div class="paragraph">
<p>To select a strategy, set the <code>junit.jupiter.execution.parallel.config.strategy</code>
configuration parameter to one of the following options.
設定パラメータ <code>junit.jupiter.execution.parallel.config.strategy</code> に指定できるのは次の値です。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>dynamic</code></dt>
<dd>
<p>利用できるCPU数（CPUコア数）に、設定パラメータ <code>junit.jupiter.execution.parallel.config.dynamic.factor</code> の値（初期値は <code>1</code> ）を乗じた値を並列度とします。</p>
</dd>
<dt class="hdlist1"><code>fixed</code></dt>
<dd>
<p>設定パラメータ <code>junit.jupiter.execution.parallel.config.fixed.parallelism</code> で並列度を指定します。</p>
</dd>
<dt class="hdlist1"><code>custom</code></dt>
<dd>
<p><code><a href="../api/org.junit.platform.engine/org/junit/platform/engine/support/hierarchical/ParallelExecutionConfigurationStrategy.html">ParallelExecutionConfigurationStrategy</a></code> の実装クラス（の完全修飾クラス名）を設定パラメータの <code>junit.jupiter.execution.parallel.config.custom.class</code> に指定します。</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>未設定の場合、係数 <code>1</code> の <code>dynamic</code> が指定されたものとします。
つまり、並列度はCPU数（CPUコア数）と等しくなります。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">並列度は並行動作するスレッド数の最大値そのものではありません</div>
並行して実行するテストの数（スレッド数）は、並列度の設定値を超過する場合があります（JUnit Jupiter は設定値を超過しないことを保証しません）。
例えば、次のセクションで説明している同期化機構 <code>ForkJoinPool</code> では、設定した並列度を満たすだけのテストを実行し続けるために、並列度を越える数のスレッドを生成する場合があります。
したがって、テストを実行するリソースをきちんと制御したければ、並列度を制御するロジックを自分で作成しなければなりません。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-parallel-execution-synchronization"><a class="anchor" href="#writing-tests-parallel-execution-synchronization"></a>2.19.2. 同期化</h4>
<div class="paragraph">
<p>JUnit Jupiter は、実行モードを制御する <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/parallel/Execution.html">@Execution</a></code> アノテーションに加えて、宣言的に同期させるための <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/parallel/ResourceLock.html">@ResourceLock</a></code> アノテーションを提供しています。
テストクラスやテストメソッドなど、同期アクセスの必要な共有リソースを <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/parallel/ResourceLock.html">@ResourceLock</a></code> で修飾することで、安全に実行できることを保証します。
共有リソースを区別する名前は文字列で指定します。
独自の文字列を指定するか、<code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/parallel/Resources.html">Resources</a></code> の定義済み定数 <code>SYSTEM_PROPERTIES, SYSTEM_OUT, SYSTEM_ERR, LOCALE, TIME_ZONE</code> を使用できます。</p>
</div>
<div class="paragraph">
<p>次のコード例に登場するテストを <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/parallel/ResourceLock.html">@ResourceLock</a></code> を <em>使わないで</em> 並列に実行すると、実行結果が <em>フレーキー（flaky）</em> になってしまいます。
JVM の同じシステムプロパティの読み書きには潜在的に競合状態があるため、ある時は成功し、ある時は失敗するようになってしまうのです。</p>
</div>
<div class="paragraph">
<p>共有リソースにアクセスするテストクラスやテストメソッドは <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/parallel/ResourceLock.html">@ResourceLock</a></code> で修飾します。
JUnit Jupiter はこのアノテーションを参照して、並列に実行するテストが衝突しないことを保証します。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">テストを独立して実行する</div>
<div class="paragraph">
<p>ほとんどのテストクラスは同期化せずに実行できるけど、一部のテストクラスは独立して実行させたい場合、後者のテストクラスを <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/parallel/Isolated.html">@Isolated</a></code> で修飾するといいでしょう。
そうすれば、他のクラスは同時に（並行して）実行しつつ、<code>{Isonated}</code> で修飾したテストクラスだけは逐次的に実行できます。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>文字列で指定した名前だけでなく、アクセスモードを指定して共有リソースを識別できます。
共有リソースに読み取りアクセス（<code>READ</code>）をする2つのテストは並列に実行できるけど、読み取りアクセスと書き込みアクセスの両方（<code>READ_WRITE</code>）が必要な2つのテストは並列に実行できません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Execution</span><span class="o">(</span><span class="no">CONCURRENT</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">SharedResourcesDemo</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Properties</span> <span class="n">backup</span><span class="o">;</span>

    <span class="nd">@BeforeEach</span>
    <span class="kt">void</span> <span class="nf">backup</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">backup</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Properties</span><span class="o">();</span>
        <span class="n">backup</span><span class="o">.</span><span class="na">putAll</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">getProperties</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@AfterEach</span>
    <span class="kt">void</span> <span class="nf">restore</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">setProperties</span><span class="o">(</span><span class="n">backup</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@ResourceLock</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="no">SYSTEM_PROPERTIES</span><span class="o">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="no">READ</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">customPropertyIsNotSetByDefault</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assertNull</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"my.prop"</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@ResourceLock</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="no">SYSTEM_PROPERTIES</span><span class="o">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="no">READ_WRITE</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">canSetCustomPropertyToApple</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">"my.prop"</span><span class="o">,</span> <span class="s">"apple"</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span> <span class="nc">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"my.prop"</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@ResourceLock</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="no">SYSTEM_PROPERTIES</span><span class="o">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="no">READ_WRITE</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">canSetCustomPropertyToBanana</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">"my.prop"</span><span class="o">,</span> <span class="s">"banana"</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"banana"</span><span class="o">,</span> <span class="nc">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"my.prop"</span><span class="o">));</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-built-in-extensions"><a class="anchor" href="#writing-tests-built-in-extensions"></a>2.20. 組み込みの拡張機能</h3>
<div class="paragraph">
<p>JUnit チームとしては、再利用可能な拡張機能を別のライブラリで提供することを推奨しています。
ですが、JUnit Jupiter API のアーティファクトには、ユーザーが頻繁に使用するであろう便利な拡張機能を同梱しています（依存ライブラリを追加しなくても使用できます）。</p>
</div>
<div class="sect3">
<h4 id="writing-tests-built-in-extensions-TempDirectory"><a class="anchor" href="#writing-tests-built-in-extensions-TempDirectory"></a>2.20.1. 一時ディレクトリ</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">一時ディレクトリ <code>@TempDir</code> は実験的な機能です</div>
JUnit チームがこの機能を改善して、正式機能へ <a href="#api-evolution">昇格</a> できるよう、試用してフィードバックを提供してください。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><a href="https://github.com/junit-team/junit5/tree/HEAD/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/TempDirectory.java">TempDirectory</a></code> 拡張機能は、一時的にテストが使用するディレクトリの作成と後始末をするための拡張機能です。
テストメソッド単位や、テストクラス単位で使用できます。
始めから登録されている拡張機能です。
<code>java.nio.file.Path</code> や <code>java.io.File</code> のフィールドを <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/io/TempDir.html">@TempDir</a></code> で修飾して使用します。
また、テストメソッドやライフサイクルメソッドについて、<code>java.nio.file.Path</code> や <code>java.io.File</code> の引数を <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/io/TempDir.html">@TempDir</a></code> で修飾して使用します。</p>
</div>
<div class="paragraph">
<p>次のコード例では、テストメソッドの引数を <code>@TempDir</code> で修飾しています。
作成された一時ディレクトリにファイルを作成し、その内容を確認しているのが分かります。</p>
</div>
<div class="listingblock">
<div class="title">一時ディレクトリを使用するテストメソッド</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">writeItemsToFile</span><span class="o">(</span><span class="nd">@TempDir</span> <span class="nc">Path</span> <span class="n">tempDir</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="nc">Path</span> <span class="n">file</span> <span class="o">=</span> <span class="n">tempDir</span><span class="o">.</span><span class="na">resolve</span><span class="o">(</span><span class="s">"test.txt"</span><span class="o">);</span>

    <span class="k">new</span> <span class="nf">ListWriter</span><span class="o">(</span><span class="n">file</span><span class="o">).</span><span class="na">write</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"c"</span><span class="o">);</span>

    <span class="n">assertEquals</span><span class="o">(</span><span class="n">singletonList</span><span class="o">(</span><span class="s">"a,b,c"</span><span class="o">),</span> <span class="nc">Files</span><span class="o">.</span><span class="na">readAllLines</span><span class="o">(</span><span class="n">file</span><span class="o">));</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>複数の引数を修飾すれば、複数の一時ディレクトリを作成し、注入できます。</p>
</div>
<div class="listingblock">
<div class="title">複数の一時ディレクトリを使用するテストメソッド</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">copyFileFromSourceToTarget</span><span class="o">(</span><span class="nd">@TempDir</span> <span class="nc">Path</span> <span class="n">source</span><span class="o">,</span> <span class="nd">@TempDir</span> <span class="nc">Path</span> <span class="n">target</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="nc">Path</span> <span class="n">sourceFile</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="na">resolve</span><span class="o">(</span><span class="s">"test.txt"</span><span class="o">);</span>
    <span class="k">new</span> <span class="nf">ListWriter</span><span class="o">(</span><span class="n">sourceFile</span><span class="o">).</span><span class="na">write</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"c"</span><span class="o">);</span>

    <span class="nc">Path</span> <span class="n">targetFile</span> <span class="o">=</span> <span class="nc">Files</span><span class="o">.</span><span class="na">copy</span><span class="o">(</span><span class="n">sourceFile</span><span class="o">,</span> <span class="n">target</span><span class="o">.</span><span class="na">resolve</span><span class="o">(</span><span class="s">"test.txt"</span><span class="o">));</span>

    <span class="n">assertNotEquals</span><span class="o">(</span><span class="n">sourceFile</span><span class="o">,</span> <span class="n">targetFile</span><span class="o">);</span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="n">singletonList</span><span class="o">(</span><span class="s">"a,b,c"</span><span class="o">),</span> <span class="nc">Files</span><span class="o">.</span><span class="na">readAllLines</span><span class="o">(</span><span class="n">targetFile</span><span class="o">));</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
テストクラス全体あるいはテストメソッド（アノテーションで修飾する場所によって異なります）に対して単一の一時ディレクトリを提供する、という昔の振る舞いに戻すときは、設定パラメータ <code>junit.jupiter.tempdir.scope</code> に <code>per_context</code> を設定します。
この設定パラメータは将来のリリースで廃止予定です。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>コンストラクタ引数では <code>@TempDir</code> を使用できません。
ライフサイクルメソッドと特定のテストメソッドで同じ一時ディレクトリを使用するときは、テストクラスのインスタンスフィールドを <code>@TempDir</code> で修飾してください。</p>
</div>
<div class="paragraph">
<p>次のコード例では <code>static</code> フィールドの一時ディレクトリを <em>共有</em> ディレクトリとして使うようになっています。
こうすると、テストクラスの全てのライフサイクルメソッドとテストメソッドは同じ <code>sharedTempDir</code> へアクセスできます。
インスタンスフィールドを使えば、それぞれテストメソッドが別のディレクトリを使うようにできるので、隔離性は高まります。</p>
</div>
<div class="listingblock">
<div class="title">A test class that shares a temporary directory across test methods</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">SharedTempDirectoryDemo</span> <span class="o">{</span>

    <span class="nd">@TempDir</span>
    <span class="kd">static</span> <span class="nc">Path</span> <span class="n">sharedTempDir</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">writeItemsToFile</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">Path</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sharedTempDir</span><span class="o">.</span><span class="na">resolve</span><span class="o">(</span><span class="s">"test.txt"</span><span class="o">);</span>

        <span class="k">new</span> <span class="nf">ListWriter</span><span class="o">(</span><span class="n">file</span><span class="o">).</span><span class="na">write</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"c"</span><span class="o">);</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="n">singletonList</span><span class="o">(</span><span class="s">"a,b,c"</span><span class="o">),</span> <span class="nc">Files</span><span class="o">.</span><span class="na">readAllLines</span><span class="o">(</span><span class="n">file</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">anotherTestThatUsesTheSameTempDir</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// use sharedTempDir</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="migrating-from-junit4"><a class="anchor" href="#migrating-from-junit4"></a>3. JUnit 4 から移行する</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JUnit Jupiter のプログラミングモデルや拡張モデルは、直接的に JUnit 4 の <code>Rules</code> や <code>Runners</code> へ対応していません。
しかし、JUnit Jupiter へ移行するために既存のソースコードやテスト用の拡張機能や、独自のテスト基盤を全て書き換えてくれるとは考えられません。</p>
</div>
<div class="paragraph">
<p>そこで、新しい JUnit Platform で JUnit 3 と JUnit 4 のテストコードを実行できる、<em>JUnit Vintage テストエンジン</em> という安全な移行パスを提供することにしました。
JUnit Jupiter 専用のクラスとアノテーションが所属するのは <code>org.junit.jupiter</code> パッケージなので、JUnit 4 が同じクラスパスに存在していても、衝突することはありません。
既存の JUnit 4 のテストを保守しながら、JUnit Jupiter のテストを安全に追加できるのです。
また、JUnit チームは JUnit 4.x リリースの保守と不具合対応を継続していくつもりなので、開発者の皆さまは自分たちの都合に合わせて、十分な時間をかけて JUnit Jupiter へ移行できます。</p>
</div>
<div class="sect2">
<h3 id="migrating-from-junit4-running"><a class="anchor" href="#migrating-from-junit4-running"></a>3.1. JUnit Platform で JUnit 4 のテストを実行する</h3>
<div class="paragraph">
<p>実行時クラスパスに <code>junit-vintage-engine</code> を置いてください。
それだけで、JUnit Platform launcher は自動的に JUnit 3 と JUnit 4 のテストを発見できるようになります。</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/junit-team/junit5-samples"><code>junit5-samples</code></a> リポジトリを見て、Gradle や Maven の設定方法を確認してください。</p>
</div>
<div class="sect3">
<h4 id="migrating-from-junit4-categories-support"><a class="anchor" href="#migrating-from-junit4-categories-support"></a>3.1.1. カテゴリー（Categories）の対応</h4>
<div class="paragraph">
<p><em>JUnit Vintage テストエンジン</em> は、<code>@Category</code> で修飾したテストクラスやテストメソッドについて、指定したカテゴリの完全修飾クラス名を <a href="#running-tests-tags">タグ</a> として公開します。
例えば、テストメソッドを <code>@Category(Example.class)</code> で修飾しているなら、<code>"com.acme.Example"</code> というタグとして公開します。
JUnit 4 の <code>Categories</code> ランナーは、JUnit Vintage テストエンジンの公開したタグからテストを選択したり発見したりできます。
そして、このタグの情報はテストを実行する前に参照できるようになっています（<a href="#running-tests">テストを実行する</a> を参照）。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="migrating-from-junit4-tips"><a class="anchor" href="#migrating-from-junit4-tips"></a>3.2. 移行のポイント</h3>
<div class="paragraph">
<p>JUnit 4 のテストを JUnit Jupiter へ移行するときは、次のような話題に注意してください。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>アノテーションは <code>org.junit.jupiter.api</code> パッケージで探す</p>
</li>
<li>
<p>アサーションは <code>org.junit.jupiter.api.Assertions</code> クラスで探す</p>
<div class="ulist">
<ul>
<li>
<p><code>org.junit.Assert</code> のアサーションや、外部ライブラリのアサーション（https://joel-costigliola.github.io/assertj/[AssertJ]  <a href="https://hamcrest.org/JavaHamcrest/">Hamcrest</a> <a href="https://truth.dev/">Truth</a> など）をそのまま利用できます</p>
</li>
</ul>
</div>
</li>
<li>
<p>アサンプションは <code>org.junit.jupiter.api.Assumptions</code> クラスで探す</p>
<div class="ulist">
<ul>
<li>
<p>JUnit Jupiter 5.4 から JUnit 4 の <code>org.junit.Assume</code> クラスのアサンプションを使用できるようになりました。
特に、テストを失敗させる代わりに中断させるため、JUnit 4 の <code>AssumptionViolatedException</code> をスローします。</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>@Before</code> と <code>@After</code> の代わりに <code>@BeforeEach</code> と <code>@AfterEach</code> を使用する</p>
</li>
<li>
<p><code>@BeforeClass</code> と <code>@AfterClass</code> の代わりに <code>@BeforeAll</code> と <code>@AfterAll</code> を使用する</p>
</li>
<li>
<p><code>@Ignore</code> の代わりに <code>@Disabled</code> を使用する。あるいは組み込みの <a href="#writing-tests-conditional-execution">条件に基づくテスト実行</a> を使用する</p>
<div class="ulist">
<ul>
<li>
<p><a href="#migrating-from-junit4-ignore-annotation-support">JUnit 4 の <code>@Ignore</code> 対応</a> も参照してください</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>@Category</code> の代わりに <code>@Tag</code> を使用する</p>
</li>
<li>
<p><code>@RunWith</code> の代わりに <code>@ExtendWith</code> を使用する</p>
</li>
<li>
<p><code>@Rule</code> と <code>@ClassRule</code> の代わりに <code>@ExtendWith</code> と <code>@RegisterExtension</code> を使用する</p>
<div class="ulist">
<ul>
<li>
<p><a href="#migrating-from-junit4-rule-support">JUnit 4 の <code>Rule</code> 対応（制限付き）</a> も参照してください</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="migrating-from-junit4-rule-support"><a class="anchor" href="#migrating-from-junit4-rule-support"></a>3.3. JUnit 4 の <code>Rule</code> 対応（制限付き）</h3>
<div class="paragraph">
<p>前に述べたとおり、JUnit Jupiter は直接的に JUnit 4 の Rule へ対応していません。
JUnit チームも、大企業を含む多数の組織が独自のルールを活用していることは理解しているつもりです。
そこで、そういう組織に段階的な移行パスを提供するため、JUnit 4 Rule の一部をそのまま JUnit Jupiter で再実装することにしました。
アダプターを使用する実装になっているので、JUnit Jupiter の拡張モデルにおける意味論的な互換性は限定的です。
例えば、テストの全体的な実行フローを完全に変更するのは不可能です。</p>
</div>
<div class="paragraph">
<p>JUnit Jupiter の <code>junit-jupiter-migrationsupport</code> モジュールが対応している <code>Rule</code> （と一部の派生クラス）は次のとおりです。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.junit.rules.ExternalResource</code> (including <code>org.junit.rules.TemporaryFolder</code>)</p>
</li>
<li>
<p><code>org.junit.rules.Verifier</code> (including <code>org.junit.rules.ErrorCollector</code>)</p>
</li>
<li>
<p><code>org.junit.rules.ExpectedException</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>JUnit 4 ではメソッドだけでなくフィールドも Rule で修飾できるようになっていました。
クラスレベルの拡張機能を追加することで、そういう <code>Rule</code> の使い方をしている従来のコードベースを <em>そのまま</em> 、import 文すら変更せずに実行できるようになります。</p>
</div>
<div class="paragraph">
<p>テストクラスを <code><a href="../api/org.junit.jupiter.migrationsupport/org/junit/jupiter/migrationsupport/rules/EnableRuleMigrationSupport.html">@EnableRuleMigrationSupport</a></code> で修飾すると、制限付きの <code>Rule</code> 対応を実現できます（クラス単位で切り替えます）。
このアノテーションは <em>合成アノテーション</em> で、全ての移行機能（<code>VerifierSupport, ExternalResourceSupport, ExpectedExceptionSupport</code>）を有効化します。
代わりにテストクラスを <code>@EnableJunit4MigrationSupport</code> で修飾すると、<code>Rule</code> の移行機能を登録するだけでなく JUnit 4 の <code>@Ignore</code> アノテーションの移行機能も登録します（<a href="#migrating-from-junit4-ignore-annotation-support">JUnit 4 の <code>@Ignore</code> 対応</a> を参照）。</p>
</div>
<div class="paragraph">
<p>とはいえ、これから JUnit 5 のために拡張機能を作成するなら、JUnit 4 のルールモデルではなく、JUnit Jupiter の拡張モデルを使用してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="migrating-from-junit4-ignore-annotation-support"><a class="anchor" href="#migrating-from-junit4-ignore-annotation-support"></a>3.4. JUnit 4 の <code>@Ignore</code> 対応</h3>
<div class="paragraph">
<p>JUnit Jupiter へのスムーズ移行パスを実現するため、<code>junit-jupiter-migrationsupport</code> モジュールは JUnit 4 の <code>@Ignore</code> アノテーションに対応する機能を提供しています。</p>
</div>
<div class="paragraph">
<p>JUnit Jupiter のテストで <code>@Ignore</code> を使うには、<em>テスト依存ライブラリ</em> に <code>junit-jupiter-migrationsupport</code> モジュールを追加して、テストクラスを <code>@ExtendWith(IgnoreCondition.class)</code> で修飾するか、<code><a href="../api/org.junit.jupiter.migrationsupport/org/junit/jupiter/migrationsupport/EnableJUnit4MigrationSupport.html">@EnableJUnit4MigrationSupport</a></code> で修飾します（後者は <a href="#migrating-from-junit4-rule-support">JUnit 4 の <code>Rule</code> 対応（制限付き）</a> と同時に <code>IgnoreCondition</code> を自動的に登録します）。
<code>IgnoreCondition</code> は <code>@Ignore</code> で修飾したテストクラスやテストメソッドを無効化する <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/ExecutionCondition.html">ExecutionCondition</a></code> の実装クラスです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.junit.Ignore</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.migrationsupport.EnableJUnit4MigrationSupport</span><span class="o">;</span>

<span class="c1">// @ExtendWith(IgnoreCondition.class)</span>
<span class="nd">@EnableJUnit4MigrationSupport</span>
<span class="kd">class</span> <span class="nc">IgnoredTestsDemo</span> <span class="o">{</span>

    <span class="nd">@Ignore</span>
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testWillBeIgnored</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testWillBeExecuted</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-tests"><a class="anchor" href="#running-tests"></a>4. テストを実行する</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="running-tests-ide"><a class="anchor" href="#running-tests-ide"></a>4.1. IDE でテストを実行する</h3>
<div class="sect3">
<h4 id="running-tests-ide-intellij-idea"><a class="anchor" href="#running-tests-ide-intellij-idea"></a>4.1.1. IntelliJ IDEA</h4>
<div class="paragraph">
<p>IntelliJ IDEA は 2016.2 から JUnit Platform でテストを実行できるようになりました。
詳しくは <a href="https://blog.jetbrains.com/idea/2016/08/using-junit-5-in-intellij-idea/">IntelliJ IDEA ブログの投稿</a> を参照してください。
ただし、実際には IntelliJ IDEA 2017.3 より新しいバージョンを使うことを推奨します。
プロジェクトで使用している <code>junit-platform-launcher, junit-jupiter-engine, junit-vintage-engine</code> のバージョンに対応した jar ファイルを自動的にダウンロードして使用するようになっているからです。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
2017.3 より前のバージョンの IntelliJ IDEA は特定バージョンの JUnit 5 が同梱しています。
ですから、それより新しいバージョンの JUnit Jupiter でテストを実行すると、異なるバージョンのライブラリが同時に存在することになり、衝突してしまうからです。
そういう場合は、次の手順に従って、IntelliJ IDEA の同梱する JUnit 5 より新しいバージョンを使うようにしてください。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>IDE の同梱する JUnit 5 と異なるバージョン（例えば 5.9.0-SNAPSHOT）を使用するには、対応するバージョンの <code>junit-platform-launcher, junit-jupiter-engine, junit-vintage-engine</code> の jar ファイルをクラスパスに配置しなければなりません。</p>
</div>
<div class="listingblock">
<div class="title">Gradle の依存ライブラリを追加する</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">testImplementation</span><span class="o">(</span><span class="n">platform</span><span class="o">(</span><span class="s2">"org.junit:junit-bom:5.9.0-SNAPSHOT"</span><span class="o">))</span>
<span class="c1">// Only needed to run tests in a version of IntelliJ IDEA that bundles older versions</span>
<span class="n">testRuntimeOnly</span><span class="o">(</span><span class="s2">"org.junit.platform:junit-platform-launcher"</span><span class="o">)</span>
<span class="n">testRuntimeOnly</span><span class="o">(</span><span class="s2">"org.junit.jupiter:junit-jupiter-engine"</span><span class="o">)</span>
<span class="n">testRuntimeOnly</span><span class="o">(</span><span class="s2">"org.junit.vintage:junit-vintage-engine"</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Maven の依存ライブラリを追加する</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;dependencies&gt;</span>
    <span class="c">&lt;!-- Only needed to run tests in a version of IntelliJ IDEA that bundles older versions --&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.junit.platform<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>junit-platform-launcher<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.junit.jupiter<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>junit-jupiter-engine<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.junit.vintage<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>junit-vintage-engine<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;dependencyManagement&gt;</span>
    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.junit<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>junit-bom<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>5.9.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;/dependencyManagement&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-ide-eclipse"><a class="anchor" href="#running-tests-ide-eclipse"></a>4.1.2. Eclipse</h4>
<div class="paragraph">
<p>Eclipse IDE は Eclipse Oxygen.1a (4.7.1a) から JUnit Platform でテストを実行できるようになりました。</p>
</div>
<div class="paragraph">
<p>詳しい使い方は公式ドキュメントの <a href="https://www.eclipse.org/eclipse/news/4.7.1a/#junit-5-support">Eclipse Project Oxygen.1a (4.7.1a) - New and Noteworthy</a> <em>Eclipse support for JUnit 5</em> を参照してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-ide-netbeans"><a class="anchor" href="#running-tests-ide-netbeans"></a>4.1.3. NetBeans</h4>
<div class="paragraph">
<p>NetBeans は <a href="https://netbeans.apache.org/download/nb100/nb100.html">Apache NetBeans 10.0 release</a> から JUnit Platform で JUnit Jupiter のテストを実行できるようになりました。</p>
</div>
<div class="paragraph">
<p>詳しい使い方は公式ドキュメントの <a href="https://netbeans.apache.org/download/nb100/index.html#" class="bare">https://netbeans.apache.org/download/nb100/index.html#</a><em>junit_5[Apache NetBeans 10.0 release notes] _JUnit 5</em> を参照してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-ide-vscode"><a class="anchor" href="#running-tests-ide-vscode"></a>4.1.4. Visual Studio Code</h4>
<div class="paragraph">
<p><a href="https://code.visualstudio.com/">Visual Studio Code</a> では、 <a href="https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-test">Java Test Runner 拡張</a> を使うと JUnit Platform で JUnit Jupiter のテストを実行できます。
Java Test Runner 拡張は <a href="https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-pack">Java Extension Pack</a> の一部として一緒にインストールできます。</p>
</div>
<div class="paragraph">
<p>詳しい使い方は公式ドキュメントの <a href="https://code.visualstudio.com/docs/languages/java#" class="bare">https://code.visualstudio.com/docs/languages/java#</a><em>testing[Java in Visual Studio Code] _Testing</em> を参照してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-ide-other"><a class="anchor" href="#running-tests-ide-other"></a>4.1.5. 他の IDE</h4>
<div class="paragraph">
<p>前述した以外のエディターや IDE を使用する場合のため、JUnit チームは JUnit 5 の使用を支援する2種類の方法を提供しています。
1つは <a href="#running-tests-console-launcher">コンソールランチャー</a> をコマンドラインで実行する方法です。
もう1つは <a href="#running-tests-junit-platform-runner">JUnit 4 based Runner</a> を実行する方法で、こちらはエディタや IDE が JUnit 4 に対応している場合に使用できる方法です。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="running-tests-build"><a class="anchor" href="#running-tests-build"></a>4.2. ビルドツールでテストを実行する</h3>
<div class="sect3">
<h4 id="running-tests-build-gradle"><a class="anchor" href="#running-tests-build-gradle"></a>4.2.1. Gradle</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">JUnit Platform Gradle プラグインの開発は修了しました</div>
<div class="paragraph">
<p>JUnit チームの開発していた <code>junit-platform-gradle-plugin</code> は JUnit Platform 1.2 で廃止予定になり、1.3 の開発は中止しました。
代わりに Gradle の標準 <code>test</code> タスクを使用してください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Gradle は <a href="https://docs.gradle.org/4.6/release-notes.html">4.6</a> から JUnit Platform で <a href="https://docs.gradle.org/current/userguide/java_testing.html#using_junit5">直接的にテストを実行できる</a> ようになりました。
この機能を使用するには <code>build.gradle</code> の <code>test</code> タスクで <code>useJUnitPlatform()</code> を呼び出すようにします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">test</span> <span class="o">{</span>
    <span class="n">useJUnitPlatform</span><span class="o">()</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#running-tests-tags">タグ</a> や <a href="#running-tests-tag-expressions">タグ記法</a> で実行するテストを選択したり、テスト実行エンジンを指定できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">test</span> <span class="o">{</span>
    <span class="n">useJUnitPlatform</span> <span class="o">{</span>
        <span class="n">includeTags</span><span class="o">(</span><span class="s2">"fast"</span><span class="o">,</span> <span class="s2">"smoke &amp; feature-a"</span><span class="o">)</span>
        <span class="c1">// excludeTags("slow", "ci")</span>
        <span class="n">includeEngines</span><span class="o">(</span><span class="s2">"junit-jupiter"</span><span class="o">)</span>
        <span class="c1">// excludeEngines("junit-vintage")</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>使用可能な全ての設定項目については <a href="https://docs.gradle.org/current/userguide/java_plugin.html#sec:java_test">公式ドキュメント</a> を参照してください。</p>
</div>
<div class="sect4">
<h5 id="running-tests-build-gradle-config-params"><a class="anchor" href="#running-tests-build-gradle-config-params"></a>設定パラメータの構成</h5>
<div class="paragraph">
<p>現在の Gradle の標準 <code>test</code> タスクには、JUnit Platform がテストを発見したり実行したりするための <a href="#running-tests-config-params">設定パラメータ</a> を指定する DSL が存在しません。
代わりにシステムプロパティや <code>junit-platform.properties</code> ファイルで指定します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">test</span> <span class="o">{</span>
    <span class="c1">// ...</span>
    <span class="n">systemProperty</span><span class="o">(</span><span class="s2">"junit.jupiter.conditions.deactivate"</span><span class="o">,</span> <span class="s2">"*"</span><span class="o">)</span>
    <span class="n">systemProperty</span><span class="o">(</span><span class="s2">"junit.jupiter.extensions.autodetection.enabled"</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span>
    <span class="n">systemProperty</span><span class="o">(</span><span class="s2">"junit.jupiter.testinstance.lifecycle.default"</span><span class="o">,</span> <span class="s2">"per_class"</span><span class="o">)</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running-tests-build-gradle-engines-configure"><a class="anchor" href="#running-tests-build-gradle-engines-configure"></a>テスト実行エンジンの構成</h5>
<div class="paragraph">
<p>1度に複数のテストを実行するには、クラスパスに <code>TestEngine</code> の実装クラスが存在しなければなりません。</p>
</div>
<div class="paragraph">
<p>JUnit Jupiter で作成したテストを実行するには、JUnit Jupiter の集約アーティファクトを <code>testImplementation</code> 依存関係で指定しなければなりません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">testImplementation</span><span class="o">(</span><span class="s2">"org.junit.jupiter:junit-jupiter:5.9.0-SNAPSHOT"</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>JUnit 4 で作成したテストを JUnit Platform で実行するには、JUnit 4 のアーティファクトを <code>testImplementation</code> 依存関係に指定するだけでなく、JUnit Vintage のアーティファクトを <code>testRuntimeOnly</code> 依存関係に指定しなければなりません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">testImplementation</span><span class="o">(</span><span class="s2">"junit:junit:4.13.2"</span><span class="o">)</span>
    <span class="n">testRuntimeOnly</span><span class="o">(</span><span class="s2">"org.junit.vintage:junit-vintage-engine:5.9.0-SNAPSHOT"</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running-tests-build-gradle-logging"><a class="anchor" href="#running-tests-build-gradle-logging"></a>ログ出力の設定（任意）</h5>
<div class="paragraph">
<p>JUnit は警告情報やデバッグ情報を出力するため、Java の標準ログ API （<code>java.util.logging</code> パッケージ、<em>JUL</em> と呼ばれる）を使用します。
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/logging/LogManager.html">LogManager</a></code> の設定方法について詳しくは <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.logging/java/util/logging/LogManager.html">公式ドキュメント</a> を参照してください。</p>
</div>
<div class="paragraph">
<p>JUL のログ出力は <a href="https://logging.apache.org/log4j/2.x/">Log4j</a> や <a href="https://logback.qos.ch/">Logback</a> のようなロギングフレームワークへ転送できます。
使用するロギングフレームワークが <code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/logging/LogManager.html">LogManager</a></code> の実装クラスを提供している場合、システムプロパティの <code>java.util.logging.manager</code> へ <em>完全修飾クラス名</em> を指定してください。
Log4j&#160;2.x を使用する場合は次のように記述します（詳しくは <a href="https://logging.apache.org/log4j/2.x/log4j-jul/index.html">Log4j JDK Logging Adapter</a> を参照）。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">test</span> <span class="o">{</span>
    <span class="n">systemProperty</span><span class="o">(</span><span class="s2">"java.util.logging.manager"</span><span class="o">,</span> <span class="s2">"org.apache.logging.log4j.jul.LogManager"</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>ロギングフレームワークとして <a href="https://logback.qos.ch/">Logback</a> を使用するなら、<code>runtime</code> 依存関係に <a href="https://www.slf4j.org/legacy.html#jul-to-slf4j">JUL to SLF4J Bridge</a> を追加するといいでしょう。</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-build-maven"><a class="anchor" href="#running-tests-build-maven"></a>4.2.2. Maven</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">JUnit Platform Maven Surefire Provider プラグインの開発は修了しました</div>
<div class="paragraph">
<p>JUnit チームの開発していた <code>junit-platform-surefire-provider</code> は JUnit Platform 1.3 で廃止予定になり、1.4 の開発は中止しました。
代わりに Maven Surefire で直接的に実行するようにしてください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Maven Surefire および Maven Failsafe では <a href="https://issues.apache.org/jira/browse/SUREFIRE-1330">2.22.0</a> から JUnit Platform で <a href="https://maven.apache.org/surefire/maven-surefire-plugin/examples/junit-platform.html">直接的にテストを実行できる</a> ようになりました。
<code><a href="https://github.com/junit-team/junit5-samples/tree/HEAD/junit5-jupiter-starter-maven">junit5-jupiter-starter-maven</a></code> プロジェクトの <code>pom.xml</code> ファイルを見ると、Maven Surefire プラグインをどのように設定するのか分かります。</p>
</div>
<div class="sect4">
<h5 id="running-tests-build-maven-engines-configure"><a class="anchor" href="#running-tests-build-maven-engines-configure"></a>テスト実行エンジンの構成</h5>
<div class="paragraph">
<p>Maven Surefire や Maven Failsafe で1度に複数のテストを実行するには、クラスパスに <code>TestEngine</code> の実装クラスが存在しなければなりません。</p>
</div>
<div class="paragraph">
<p>JUnit Jupiter で作成したテストを実行するには、JUnit Jupiter API と JUnit Jupiter <code>TestEngine</code> （の実装クラス）の依存ライブラリを <code>test</code> スコープで追加しなければなりません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;dependencies&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.junit.jupiter<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>junit-jupiter<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>5.9.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.22.2<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>maven-failsafe-plugin<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.22.2<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
<span class="nt">&lt;/build&gt;</span>
<span class="c">&lt;!-- ... --&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>JUnit 4 で作成したテストを JUnit Jupiter で作成したテストと一緒に実行するには、JUnit 4 と JUnit Vintage <code>TestEngine</code> （の実装クラス）の依存ライブラリを <code>test</code> スコープで追加しなければなりません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;dependencies&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>4.13.2<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.junit.vintage<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>junit-vintage-engine<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>5.9.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
<span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.22.2<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>maven-failsafe-plugin<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.22.2<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
<span class="nt">&lt;/build&gt;</span>
<span class="c">&lt;!-- ... --&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running-tests-build-maven-filter-test-class-names"><a class="anchor" href="#running-tests-build-maven-filter-test-class-names"></a>名前でテストクラスを選択する</h5>
<div class="paragraph">
<p>Maven Surefire プラグインは、完全修飾クラス名が次のようなパス文字列パターンに一致するテストクラスを探索します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>**/Test*.java</p>
</li>
<li>
<p>**/*Test.java</p>
</li>
<li>
<p>**/*Tests.java</p>
</li>
<li>
<p>**/*TestCase.java</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>さらに、初期設定では全ての入れ子クラス（<code>static</code> メンバークラスも含めて）を無視します。</p>
</div>
<div class="paragraph">
<p>しかし、この振る舞いは明示的に <code>pom.xml</code> へ <code>include</code> ルールと <code>exclude</code> ルールを追加することで変更できます。
例えば、<code>static</code> メンバークラスを無視する振る舞いを止めさせるには次のように <code>exclude</code> ルールを記述します。</p>
</div>
<div class="listingblock">
<div class="title">Maven Surefire の <code>exclude</code> ルールを上書きする</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.22.2<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
                <span class="nt">&lt;excludes&gt;</span>
                    <span class="nt">&lt;exclude/&gt;</span>
                <span class="nt">&lt;/excludes&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
<span class="nt">&lt;/build&gt;</span>
<span class="c">&lt;!-- ... --&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>詳しくは公式ドキュメントの <a href="https://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html">Inclusions and Exclusions of Tests</a> を参照してください。</p>
</div>
</div>
<div class="sect4">
<h5 id="running-tests-build-maven-filter-tags"><a class="anchor" href="#running-tests-build-maven-filter-tags"></a>タグでテストクラスを選択する</h5>
<div class="paragraph">
<p><a href="#running-tests-tags">タグ</a> や <a href="#running-tests-tag-expressions">タグ記法</a> で実行するテストを選択できます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>タグ</em> や <em>タグ記法</em> を含むテストクラスを選択するには <code>groups</code> を使用します</p>
</li>
<li>
<p><em>タグ</em> や <em>タグ記法</em> を含むテストクラスを除外するには <code>excludedGroups</code> を使用します</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.22.2<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
                <span class="nt">&lt;groups&gt;</span>acceptance | !feature-a<span class="nt">&lt;/groups&gt;</span>
                <span class="nt">&lt;excludedGroups&gt;</span>integration, regression<span class="nt">&lt;/excludedGroups&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
<span class="nt">&lt;/build&gt;</span>
<span class="c">&lt;!-- ... --&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running-tests-build-maven-config-params"><a class="anchor" href="#running-tests-build-maven-config-params"></a>設定パラメータの構成</h5>
<div class="paragraph">
<p>JUnit Platform がテストを発見したり実行したりするための <a href="#running-tests-config-params">設定パラメータ</a> は <code>configurationParameters</code> で指定します。
<code>configurationProperties</code> には、 Java の <code>Properties</code> 記法でキーと値の対を記述します。
<code>junit-platform.properties</code> ファイルでも指定できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.22.2<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
                <span class="nt">&lt;properties&gt;</span>
                    <span class="nt">&lt;configurationParameters&gt;</span>
                        junit.jupiter.conditions.deactivate = *
                        junit.jupiter.extensions.autodetection.enabled = true
                        junit.jupiter.testinstance.lifecycle.default = per_class
                    <span class="nt">&lt;/configurationParameters&gt;</span>
                <span class="nt">&lt;/properties&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
<span class="nt">&lt;/build&gt;</span>
<span class="c">&lt;!-- ... --&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-build-ant"><a class="anchor" href="#running-tests-build-ant"></a>4.2.3. Ant</h4>
<div class="paragraph">
<p>Starting with version <code>1.10.3</code> of <a href="https://ant.apache.org/">Ant</a>, a new
<a href="https://ant.apache.org/manual/Tasks/junitlauncher.html"><code>junitlauncher</code></a> task has
been introduced to provide native support for launching tests on the JUnit Platform. The
<code>junitlauncher</code> task is solely responsible for launching the JUnit Platform and passing
it the selected collection of tests. The JUnit Platform then delegates to registered test
engines to discover and execute the tests.</p>
</div>
<div class="paragraph">
<p>The <code>junitlauncher</code> task attempts to align as close as possible with native Ant
constructs such as
<a href="https://ant.apache.org/manual/Types/resources.html#collection">resource collections</a>
for allowing users to select the tests that they want executed by test engines. This
gives the task a consistent and natural feel when compared to many other core Ant tasks.</p>
</div>
<div class="paragraph">
<p>Starting with version <code>1.10.6</code> of Ant, the <code>junitlauncher</code> task supports
<a href="https://ant.apache.org/manual/Tasks/junitlauncher.html#fork">forking the tests in a separate JVM</a>.</p>
</div>
<div class="paragraph">
<p>The <code>build.xml</code> file in the <code><a href="https://github.com/junit-team/junit5-samples/tree/HEAD/junit5-jupiter-starter-ant">junit5-jupiter-starter-ant</a></code> project demonstrates how to use
the task and can serve as a starting point.</p>
</div>
<div class="sect4">
<h5 id="basic-usage"><a class="anchor" href="#basic-usage"></a>Basic Usage</h5>
<div class="paragraph">
<p>The following example demonstrates how to configure the <code>junitlauncher</code> task to select a
single test class (i.e., <code>org.myapp.test.MyFirstJUnit5Test</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;path</span> <span class="na">id=</span><span class="s">"test.classpath"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- The location where you have your compiled classes --&gt;</span>
    <span class="nt">&lt;pathelement</span> <span class="na">location=</span><span class="s">"${build.classes.dir}"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/path&gt;</span>

<span class="c">&lt;!-- ... --&gt;</span>

<span class="nt">&lt;junitlauncher&gt;</span>
    <span class="nt">&lt;classpath</span> <span class="na">refid=</span><span class="s">"test.classpath"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">"org.myapp.test.MyFirstJUnit5Test"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/junitlauncher&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>test</code> element allows you to specify a single test class that you want to be selected
and executed. The <code>classpath</code> element allows you to specify the classpath to be used to
launch the JUnit Platform. This classpath will also be used to locate test classes that
are part of the execution.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates how to configure the <code>junitlauncher</code> task to select
test classes from multiple locations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;path</span> <span class="na">id=</span><span class="s">"test.classpath"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- The location where you have your compiled classes --&gt;</span>
    <span class="nt">&lt;pathelement</span> <span class="na">location=</span><span class="s">"${build.classes.dir}"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/path&gt;</span>
<span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;junitlauncher&gt;</span>
    <span class="nt">&lt;classpath</span> <span class="na">refid=</span><span class="s">"test.classpath"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;testclasses</span> <span class="na">outputdir=</span><span class="s">"${output.dir}"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;fileset</span> <span class="na">dir=</span><span class="s">"${build.classes.dir}"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">"org/example/**/demo/**/"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/fileset&gt;</span>
        <span class="nt">&lt;fileset</span> <span class="na">dir=</span><span class="s">"${some.other.dir}"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">"org/myapp/**/"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/fileset&gt;</span>
    <span class="nt">&lt;/testclasses&gt;</span>
<span class="nt">&lt;/junitlauncher&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the <code>testclasses</code> element allows you to select multiple test
classes that reside in different locations.</p>
</div>
<div class="paragraph">
<p>For further details on usage and configuration options please refer to the official Ant
documentation for the
<a href="https://ant.apache.org/manual/Tasks/junitlauncher.html"><code>junitlauncher</code> task</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="running-tests-console-launcher"><a class="anchor" href="#running-tests-console-launcher"></a>4.3. コンソールランチャー</h3>
<div class="paragraph">
<p><code><a href="../api/org.junit.platform.console/org/junit/platform/console/ConsoleLauncher.html">ConsoleLauncher</a></code> はコマンドラインから JUnit Platform を実行するための Java アプリケーションです。
JUnit Jupiter のテストを実行した結果をコンソールに出力できるし、JUnit Vintage のテスト実行エンジンも使用できます。</p>
</div>
<div class="paragraph">
<p>依存ライブラリを一緒にした実行可能 jar ファイル <code>junit-platform-console-standalone-1.9.0-SNAPSHOT.jar</code> は <a href="https://search.maven.org/">Maven Central</a> で公開されています。
JUnit Platform リポジトリの <a href="https://repo1.maven.org/maven2/org/junit/platform/junit-platform-console-standalone">junit-platform-console-standalone</a> ディレクトリを参照してください。
jar ファイルは次のように実行します。</p>
</div>
<div class="paragraph">
<p><code>java -jar junit-platform-console-standalone-1.9.0-SNAPSHOT.jar &lt;<a href="#running-tests-console-launcher-options">コンソールランチャーの引数（フラグ）</a>&gt;</code></p>
</div>
<div class="paragraph">
<p>実行結果は次のようになるでしょう。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>├─ JUnit Vintage
│  └─ example.JUnit4Tests
│     └─ standardJUnit4Test ✔
└─ JUnit Jupiter
   ├─ StandardTests
   │  ├─ succeedingTest() ✔
   │  └─ skippedTest() ↷ for demonstration purposes
   └─ A special test case
      ├─ Custom test name containing spaces ✔
      ├─ ╯°□°)╯ ✔
      └─ 😱 ✔

Test run finished after 64 ms
[         5 containers found      ]
[         0 containers skipped    ]
[         5 containers started    ]
[         0 containers aborted    ]
[         5 containers successful ]
[         0 containers failed     ]
[         6 tests found           ]
[         1 tests skipped         ]
[         5 tests started         ]
[         0 tests aborted         ]
[         5 tests successful      ]
[         0 tests failed          ]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">終了コード</div>
テストコンテナやテストが1つでも失敗すると <code><a href="../api/org.junit.platform.console/org/junit/platform/console/ConsoleLauncher.html">ConsoleLauncher</a></code> はステータスコード <code>1</code> で終了します。
コマンドラインオプションで <code>--fail-if-no-tests</code> フラグを指定した場合、1つもテストが見つからないときは、ステータスコード <code>2</code> で終了します。
それ以外の場合、ステータスコード <code>0</code> で終了します。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="running-tests-console-launcher-options"><a class="anchor" href="#running-tests-console-launcher-options"></a>4.3.1. コンソールランチャーの引数（フラグ）</h4>
<div class="listingblock">
<div class="content">
<pre>Usage: ConsoleLauncher [-h] [--disable-ansi-colors] [--disable-banner]
                       [--fail-if-no-tests] [--scan-modules] [--scan-classpath[=PATH[;|:
                       PATH...]]]... [--details=MODE] [--details-theme=THEME]
                       [--reports-dir=DIR] [-c=CLASS]... [--config=KEY=VALUE]... [-cp=PATH
                       [;|:PATH...]]... [-d=DIR]... [-e=ID]... [-E=ID]...
                       [--exclude-package=PKG]... [-f=FILE]... [--include-package=PKG]...
                       [-m=NAME]... [-n=PATTERN]... [-N=PATTERN]... [-o=NAME]...
                       [-p=PKG]... [-r=RESOURCE]... [-t=TAG]... [-T=TAG]... [-u=URI]...
Launches the JUnit Platform from the console.
  -h, --help                 Display help information.
      --disable-ansi-colors  Disable ANSI colors in output (not supported by all
                               terminals).
      --disable-banner       Disable print out of the welcome message.
      --details=MODE         Select an output details mode for when tests are executed.
                               Use one of: none, summary, flat, tree, verbose. If 'none'
                               is selected, then only the summary and test failures are
                               shown. Default: tree.
      --details-theme=THEME  Select an output details tree theme for when tests are
                               executed. Use one of: ascii, unicode. Default: unicode.
      -cp, --classpath, --class-path=PATH[;|:PATH...]
                             Provide additional classpath entries -- for example, for
                               adding engines and their dependencies. This option can be
                               repeated.
      --fail-if-no-tests     Fail and return exit status code 2 if no tests are found.
      --reports-dir=DIR      Enable report output into a specified local directory (will
                               be created if it does not exist).
      --scan-modules         EXPERIMENTAL: Scan all resolved modules for test discovery.
  -o, --select-module=NAME   EXPERIMENTAL: Select single module for test discovery. This
                               option can be repeated.
      --scan-classpath, --scan-class-path[=PATH[;|:PATH...]]
                             Scan all directories on the classpath or explicit classpath
                               roots. Without arguments, only directories on the system
                               classpath as well as additional classpath entries supplied
                               via -cp (directories and JAR files) are scanned. Explicit
                               classpath roots that are not on the classpath will be
                               silently ignored. This option can be repeated.
  -u, --select-uri=URI       Select a URI for test discovery. This option can be repeated.
  -f, --select-file=FILE     Select a file for test discovery. This option can be
                               repeated.
  -d, --select-directory=DIR Select a directory for test discovery. This option can be
                               repeated.
  -p, --select-package=PKG   Select a package for test discovery. This option can be
                               repeated.
  -c, --select-class=CLASS   Select a class for test discovery. This option can be
                               repeated.
  -m, --select-method=NAME   Select a method for test discovery. This option can be
                               repeated.
  -r, --select-resource=RESOURCE
                             Select a classpath resource for test discovery. This option
                               can be repeated.
  -n, --include-classname=PATTERN
                             Provide a regular expression to include only classes whose
                               fully qualified names match. To avoid loading classes
                               unnecessarily, the default pattern only includes class
                               names that begin with "Test" or end with "Test" or
                               "Tests". When this option is repeated, all patterns will
                               be combined using OR semantics. Default: [^(Test.*|.+[.$]
                               Test.*|.*Tests?)$]
  -N, --exclude-classname=PATTERN
                             Provide a regular expression to exclude those classes whose
                               fully qualified names match. When this option is repeated,
                               all patterns will be combined using OR semantics.
      --include-package=PKG  Provide a package to be included in the test run. This
                               option can be repeated.
      --exclude-package=PKG  Provide a package to be excluded from the test run. This
                               option can be repeated.
  -t, --include-tag=TAG      Provide a tag or tag expression to include only tests whose
                               tags match. When this option is repeated, all patterns
                               will be combined using OR semantics.
  -T, --exclude-tag=TAG      Provide a tag or tag expression to exclude those tests whose
                               tags match. When this option is repeated, all patterns
                               will be combined using OR semantics.
  -e, --include-engine=ID    Provide the ID of an engine to be included in the test run.
                               This option can be repeated.
  -E, --exclude-engine=ID    Provide the ID of an engine to be excluded from the test
                               run. This option can be repeated.
      --config=KEY=VALUE     Set a configuration parameter for test discovery and
                               execution. This option can be repeated.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-console-launcher-argument-files"><a class="anchor" href="#running-tests-console-launcher-argument-files"></a>4.3.2. コンソールランチャーの引数（@-files）</h4>
<div class="paragraph">
<p>OSによっては、実行するコマンドライン文字列の長さが上限値に達してしまう場合があります。</p>
</div>
<div class="paragraph">
<p>JUnit Platform 1.3 から <code>ConsoleLauncher</code> は <em>引数ファイル</em> を渡せるようになりました（<em>@-files</em> と呼ばれています）。
引数ファイルはコマンドライン引数を羅列したテキストファイルです。
この機能は <a href="https://github.com/remkop/picocli">picocli</a> のコマンドライン文字列パーサーで実装されており、コマンドライン引数に <code>@</code> で始まる項目があれば、対応するファイルの内容をコマンドライン引数に追加するようになっています。</p>
</div>
<div class="paragraph">
<p>引数ファイルでは、それぞれの引数を空白文字や改行文字で分割します。
引数自体に空白文字を含めるには、その引数全体を一重引用符や二重引用符で囲まなければなりません。
例えば <code>"-f=My Files/Stuff.java"</code> のように記述します。</p>
</div>
<div class="paragraph">
<p>指定した引数ファイルが存在しないか、読み取れない場合、ただの1引数として扱います。
おそらく「使用できない引数」という警告メッセージが出力されるでしょう。
コマンドを実行するとき、システムプロパティ <code>picocli.trace</code> に <code>DEBUG</code> を指定すると問題の解決に役立つ情報が出力されるでしょう。</p>
</div>
<div class="paragraph">
<p>複数の引数ファイルを使用するときはコマンドライン引数に <em>@-files</em> を複数指定します。
ファイル名を完全パスで指定した場合以外は、実行時ディレクトリからの相対パスとして解釈します。</p>
</div>
<div class="paragraph">
<p><code>@</code> から始まるフラグ名を使いたいときは、<code>@@</code> のように2つ続けて記述します。
例えば <code>@@somearg</code> は <code>@somearg</code> として扱われるようになります（引数ファイルとして展開しません）。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="running-tests-junit-platform-runner"><a class="anchor" href="#running-tests-junit-platform-runner"></a>4.4. JUnit 4 で JUnit Platform を実行する</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title"><code>JUnitPlatform</code> ランナーは廃止予定です</div>
<div class="paragraph">
<p>JUnit チームが <code>JUnitPlatform</code> ランナーを開発したのは、JUnit 4 で作成したテスト（テストスイート）を実行するための暫定措置です。</p>
</div>
<div class="paragraph">
<p>ここ数年の間に、さまざまなビルドツールや IDE は JUnit Platform を直接的に実行できるようになりました。</p>
</div>
<div class="paragraph">
<p>また、<code>junit-platform-suite-engine</code> モジュールで <code>@Suite</code> が使えるようになったため、<code>JUnitPlatform</code> ランナーは不要になりました。
詳しくは <a href="#junit-platform-suite-engine">JUnit Platform テストスイートエンジン</a> を参照してください。</p>
</div>
<div class="paragraph">
<p>以上の理由により、JUnit Platform 1.8 から <code>JUnitPlatform</code> ランナーは廃止予定になりました。
おそらく JUnit Platform 2.0 で削除するでしょう。</p>
</div>
<div class="paragraph">
<p><code>JUnitPlatform</code> ランナーを使用している場合は <code>@Suite</code> に対応した <code>junit-platform-suite-engine</code> モジュールへ移行してください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>JUnitPlatform</code> ランナーは、JUnit Platform の提供するプログラミングモデルで作成したテストを、JUnit 4 の環境で実行するテストランナーです。</p>
</div>
<div class="paragraph">
<p>テストクラスを <code>@RunWith(JUnitPlatform.class)</code> で修飾すれば、JUnit Platform には対応していないけど JUnit 4 に対応した IDE やビルドツールからテストを実行できるようになります。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
JUnit Platform には JUnit 4 にない機能が存在します。
したがって <code>JUnitPlatform</code> ランナーは JUnit Platform の提供する機能の一部だけしか対応していません。
特にテスト結果のレポート機能には違いがあります（<a href="#running-tests-junit-platform-runner-technical-names">表示名と部品名</a> を参照）。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="running-tests-junit-platform-runner-setup"><a class="anchor" href="#running-tests-junit-platform-runner-setup"></a>4.4.1. 準備</h4>
<div class="paragraph">
<p><code>JUnitPlatform</code> ランナーを使用するには以降で説明するアーティファクトや依存ライブラリをクラスパスに配置しなければなりません。
具体的なグループID、アーティファクトID、バージョンについては <a href="#dependency-metadata">依存ライブラリに関するメタデータ</a> を参照してください。</p>
</div>
<div class="sect4">
<h5 id="running-tests-junit-platform-runner-setup-explicit-dependencies"><a class="anchor" href="#running-tests-junit-platform-runner-setup-explicit-dependencies"></a>明示的な依存関係</h5>
<div class="ulist">
<ul>
<li>
<p><code>junit-platform-runner</code> <code>test</code> スコープ。<code>JUnitPlatform</code> ランナーそのものです</p>
</li>
<li>
<p><code>junit-4.13.2.jar</code> <code>test</code> スコープ。JUnit 4 です</p>
</li>
<li>
<p><code>junit-jupiter-api</code> <code>test</code> スコープ。JUnit Jupiter でテストを作成するための API です</p>
</li>
<li>
<p><code>junit-jupiter-engine</code> <code>testRuntime</code> スコープ。JUnit Jupiter のための <code>TestEngine</code> 実装です</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="running-tests-junit-platform-runner-setup-transitive-dependencies"><a class="anchor" href="#running-tests-junit-platform-runner-setup-transitive-dependencies"></a>推移的依存関係</h5>
<div class="ulist">
<ul>
<li>
<p><code>junit-platform-suite-api</code> <code>test</code> スコープ。</p>
</li>
<li>
<p><code>junit-platform-suite-commons</code> <code>test</code> スコープ。</p>
</li>
<li>
<p><code>junit-platform-launcher</code> <code>test</code> スコープ。</p>
</li>
<li>
<p><code>junit-platform-engine</code> <code>test</code> スコープ。</p>
</li>
<li>
<p><code>junit-platform-commons</code> <code>test</code> スコープ。</p>
</li>
<li>
<p><code>opentest4j</code> <code>test</code> スコープ。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-junit-platform-runner-technical-names"><a class="anchor" href="#running-tests-junit-platform-runner-technical-names"></a>4.4.2. 表示名と部品名</h4>
<div class="paragraph">
<p><code>@RunWith(JUnitPlatform.class)</code> で修飾したテストクラスを実行するときの <em>表示名</em> を変更するには、テストクラスを <code>@SuiteDisplayName</code> で修飾して、設定します。</p>
</div>
<div class="paragraph">
<p>初期設定では、テストアーティファクトの <em>表示名</em> を使うようになっています。
しかし、Gradle や Maven 等のビルドツールで <code>JUnitPlatform</code> ランナーを実行して、テスト結果のレポートを作成するときは、テストアーティファクトの <em>部品名</em> が必要になります。
例えば、テストクラスの省略形（表示名）や特殊文字を含む表示名ではなく、完全修飾クラス名が必要になる、といった具合です。
テスト結果のレポートを作成するときに部品名を使用できるようにするには、テストクラスを <code>@UseTechnicalNames</code> で修飾してください。</p>
</div>
<div class="paragraph">
<p>テストクラスを <code>@UseTechnicalNames</code> で修飾すると、<code>@SuiteDisplayName</code> で指定した表示名を上書きします。</p>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-junit-platform-runner-single-test"><a class="anchor" href="#running-tests-junit-platform-runner-single-test"></a>4.4.3. 単独のテストクラス</h4>
<div class="paragraph">
<p>テストクラスを <code>@RunWith(JUnitPlatform.class)</code> で修飾するのは <code>JUnitPlatform</code> ランナーを使用する方法の1つです。
次のコード例ではテストメソッドを JUnit Jupiter の <code>@Test</code> で修飾しているのがポイントです（ <code>org.junit.Test</code> ではなく <code>org.junit.jupiter.api.Test</code> を使用しています）。
さらに、テストクラスの可視性が <code>public</code> になっているのもポイントです。
そうしないと JUnit 4 のテストクラスとして認識しない IDE やビルドツールがあるからです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">fail</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.runner.RunWith</span><span class="o">;</span>

<span class="nd">@RunWith</span><span class="o">(</span><span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">runner</span><span class="o">.</span><span class="na">JUnitPlatform</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JUnitPlatformClassDemo</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">succeedingTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="cm">/* no-op */</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">failingTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">fail</span><span class="o">(</span><span class="s">"Failing for failing's sake."</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-junit-platform-runner-test-suite"><a class="anchor" href="#running-tests-junit-platform-runner-test-suite"></a>4.4.4. テストスイート</h4>
<div class="paragraph">
<p>次のコード例のように、複数のテストクラスをまとめたテストスイートがあるとします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.junit.platform.suite.api.SelectPackages</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.suite.api.SuiteDisplayName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.runner.RunWith</span><span class="o">;</span>

<span class="nd">@RunWith</span><span class="o">(</span><span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">runner</span><span class="o">.</span><span class="na">JUnitPlatform</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@SuiteDisplayName</span><span class="o">(</span><span class="s">"JUnit Platform Suite Demo"</span><span class="o">)</span>
<span class="nd">@SelectPackages</span><span class="o">(</span><span class="s">"example"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JUnitPlatformSuiteDemo</span> <span class="o">{</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>JUnitPlatformSuiteDemo</code> クラスは <code>example</code> パッケージとそのサブパッケージに配置した全てのテストクラスを発見し、実行します。
初期設定では <code>Test</code> で始まるか、<code>Test</code> や <code>Tests</code> で終わる名前のクラスが対象になります。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">さらに細かい設定</div>
<code>@SelectPackages</code> 以外にもテストを発見したり選択したりするための設定項目があります。
詳しくは <code><a href="../api/org.junit.platform.suite.api/org/junit/platform/suite/api/package-summary.html">org.junit.platform.suite.api</a></code> の Javadoc を参照してください。
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<code>@RunWith(JUnitPlatform.class)</code> で修飾したテストスイートクラスやテストクラスは JUnit Platform から直接的に実行 <strong>できません</strong> （IDE のドキュメントに記載されている "JUnit 5" テストとしても実行できません）。
JUnit 4 でしか実行できません。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="running-tests-config-params"><a class="anchor" href="#running-tests-config-params"></a>4.5. 設定パラメータの構成</h3>
<div class="paragraph">
<p>テストクラスの選択や、テスト実行エンジンの指定、テストクラスを探索するパッケージの指定といった基盤機能の説明に加えて、特定のテスト実行エンジンやリスナー、拡張機能に固有の設定パラメータについても理解しておいたほうがいいでしょう。
例えば、JUnit Jupiter テスト実行エンジンには次のようなユースケースを想定した設定パラメータが用意されています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#writing-tests-test-instance-lifecycle-changing-default">インスタンスライフサイクル管理の初期値を変更する</a></p>
</li>
<li>
<p><a href="#extensions-registration-automatic-enabling">拡張機能の自動検出を有効化する</a></p>
</li>
<li>
<p><a href="#extensions-conditions-deactivation">条件を不活性にする</a></p>
</li>
<li>
<p><a href="#writing-tests-display-name-generator-default">表示名生成ロジックの初期値を変更する</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>設定パラメータ</em> は文字列ベースのキーと値の対の集合です。
JUnit Platform を実行するときは次のように注入します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#launcher-api"><code>Launcher</code> API</a> のパラメータを構築する <code>LauncherDiscoveryRequestBuilder</code> の <code>configurationParameter()</code> メソッドや <code>configurationParameters()</code> メソッドを使用します。
JUnit Platform を実行するツールによって渡し方は異なります。</p>
<div class="ulist">
<ul>
<li>
<p><a href="#running-tests-console-launcher">コンソールランチャー</a>: <code>--config</code> フラグを使用します。</p>
</li>
<li>
<p><a href="#running-tests-build-gradle-config-params">設定パラメータの構成</a>: DSL を使用します（<code>systemProperty</code> や <code>systemProperties</code>）。</p>
</li>
<li>
<p><a href="#running-tests-build-maven-config-params">設定パラメータの構成</a>: <code>configurationParameters</code> 要素を使用します。</p>
</li>
</ul>
</div>
</li>
<li>
<p>JVM のシステムプロパティを使用します。</p>
</li>
<li>
<p>JUnit Platform の独自設定ファイルを使用します。Java の <code>Properties</code> ファイルとして作成した <code>junit-platform.properties</code> をクラスパスの最上位に配置します。</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
設定パラメータを読み取る順序は固定されています。
つまり、<code>Launcher</code> に直接指定したパラメータは、システムプロパティや設定ファイルなど他の方法で指定したパラメータを上書きするのです。
同様に、システムプロパティで指定したパラメータは、設定ファイルで指定したパラメータを上書きします。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="running-tests-config-params-deactivation-pattern"><a class="anchor" href="#running-tests-config-params-deactivation-pattern"></a>4.5.1. パターンマッチ記法</h4>
<div class="paragraph">
<p>このセクションでは、次のような機能のために <em>設定パラメータ</em> へ記述するパターンマッチの記法を説明します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#extensions-conditions-deactivation">条件を不活性にする</a></p>
</li>
<li>
<p><a href="#launcher-api-listeners-custom-deactivation">テスト実行リスナーを不活性にする</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>設定値の文字列パターンがアスタリスク * 1つだけなら、全ての候補クラスにマッチします。
そうでなければ、設定値をカンマ区切り文字列（それぞれの文字列パターンは完全修飾クラス名（FQCN））と見做して、それぞれの文字列パターンと候補クラスが一致するか評価します。
文字列パターン中のドット（<code>.</code>）は、FQCN 中のドット（<code>.</code>）か、＄マーク（<code>$</code>）とマッチします。
文字列パターン中のアスタリスク（*）は、FQCN 中の連続する任意の1文字以上の文字列とマッチします。
それ以外の文字は、FQCN 中の同じ文字とマッチします。</p>
</div>
<div class="paragraph">
<p>具体例です。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>*: 全ての候補クラスとマッチします</p>
</li>
<li>
<p>org.junit.*: <code>org.junit</code> パッケージとそのサブパッケージに配置した全ての候補クラスとマッチします
any of its subpackages.</p>
</li>
<li>
<p>{asterrisk}.MyCustomImpl: 単純クラス名が <code>MyCustomImpl</code> になる全ての候補クラスとマッチします</p>
</li>
<li>
<p>{asterrisk}System{asterrisk}: FQCN に <code>System</code> を含む全ての候補クラスとマッチします</p>
</li>
<li>
<p>{asterrisk}System{asterrisk}, {asterrisk}Unit{asterrisk}: FQCN に <code>System</code> あるいは <code>Unit</code> を含む全ての候補クラスとマッチします</p>
</li>
<li>
<p><code>org.example.MyCustomImpl</code>: FQCN が完全に <code>org.example.MyCustomImpl</code> と一致する候補クラスとマッチします</p>
</li>
<li>
<p><code>org.example.MyCustomImpl, org.example.TheirCustomImpl</code>: FQCN が完全に <code>org.example.MyCustomImpl</code> と一致する、あるいは <code>org.example.TheirCustomImpl</code> と一致する候補クラスとマッチします</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="running-tests-tags"><a class="anchor" href="#running-tests-tags"></a>4.6. タグ</h3>
<div class="paragraph">
<p>タグはテストクラスに印を付けたり、テストクラスを選択するための機能です。
テストコンテナやテストクラスにタグを追加するためのプログラミングモデルは、テストフレームワークが提供しています。
例えば、JUnit Jupiter でテストを作成するなら <code>@Tag</code> アノテーション（<a href="#writing-tests-tagging-and-filtering">タグ付けと選択</a> を参照）を使用し、JUnit 4 で作成したテストなら Vintage テスト実行エンジンが <code>@Category</code> アノテーションをタグに写像します（<a href="#migrating-from-junit4-categories-support">カテゴリー（Categories）の対応</a> を参照）。
他のテストフレームワークも、ユーザーがタグを定義するために使用できる独自のアノテーションを提供しているでしょう。</p>
</div>
<div class="sect3">
<h4 id="running-tests-tag-syntax-rules"><a class="anchor" href="#running-tests-tag-syntax-rules"></a>4.6.1. タグの構文規則</h4>
<div class="paragraph">
<p>タグを指定する方法がなんであれ、JUnit Platform は次の規則で解釈します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>null</code> や <em>空白文字</em> は使用できません</p>
</li>
<li>
<p>トリムしたタグ値には、空白文字を使用できません</p>
</li>
<li>
<p>トリムしたタグ値には、ISO 制御文字を使用できません</p>
</li>
<li>
<p>トリムしたタグ値には、次のいずれかの文字（<em>予約文字</em>）を使用できません</p>
<div class="ulist">
<ul>
<li>
<p><code>,</code>: <em>カンマ</em></p>
</li>
<li>
<p><code>(</code>: <em>開き括弧</em></p>
</li>
<li>
<p><code>)</code>: <em>閉じ括弧</em></p>
</li>
<li>
<p><code>&amp;</code>: <em>アンパサンド</em></p>
</li>
<li>
<p><code>|</code>: <em>縦線</em></p>
</li>
<li>
<p><code>!</code>: <em>感嘆符</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the above context, "trimmed" means that leading and trailing whitespace
characters have been removed.
NOTE: 「トリムした」というのは、文字列の先頭や末尾から連続する1文字以上の空白文字を削除するということです。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-tag-expressions"><a class="anchor" href="#running-tests-tag-expressions"></a>4.6.2. タグ記法</h4>
<div class="paragraph">
<p>タグ記法は <code>!</code> と <code>&amp;</code> と <code>|</code> を演算子として使用するブール式です。
<code>(</code> と <code>)</code> で演算子の優先度を変更できるようになっています。</p>
</div>
<div class="paragraph">
<p>特殊記法として <code>any()</code> と <code>none()</code> を使用できます。
前者はあらゆるタグと <em>一致する</em> ことを評価し、後者はあらゆるタグと <em>一致しない</em> ことを評価します。
これらの特殊記法は通常のタグ記法と組み合わせて使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. 演算子の優先度（降順：上のほうが優先）</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">演算子</th>
<th class="tableblock halign-left valign-top">意味</th>
<th class="tableblock halign-left valign-top">結合の方向</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>!</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">否定</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">右</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">かつ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">左</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">あるいは</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">左</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>テストを複数の軸でタグ付けしているときは、タグ記法を使うと実行するテストを選択するのに役立ちます。
タグでテスト種類（<em>micro</em>、<em>integration</em>、<em>end-to-end</em> など）や機能（<strong>product</strong>、<strong>catalog</strong>、<strong>shipping</strong> など）を説明しているときは、次のように使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">タグ記法</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">選択されたテストクラス</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">product</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>product</strong> を指定したテストクラス</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog | shipping</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>catalog</strong> あるいは <strong>shipping</strong> を指定したテストクラス</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">catalog &amp; shipping</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>catalog</strong> と <strong>shipping</strong> を指定したテストクラス</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">product &amp; !end-to-end</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>product</strong> を指定したテストクラスの中で <strong>end-to-end</strong> を指定していないもの</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(micro | integration) &amp; (product | shipping)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>micro</em> あるいは <em>integration</em> を指定したテストクラスの中で <strong>product</strong> あるいは <strong>shipping</strong> を指定しているもの</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="running-tests-capturing-output"><a class="anchor" href="#running-tests-capturing-output"></a>4.7. 標準出力や標準エラー出力をキャプチャーする</h3>
<div class="paragraph">
<p>JUnit Platform は 1.3 から <code>System.out</code> と <code>System.err</code> に出力した内容をキャプチャーする機能をオプトイン方式で提供しています。
この機能を有効化するには、システムプロパティや設定ファイル（<a href="#running-tests-config-params">設定パラメータの構成</a> を参照）で <code>junit.platform.output.capture.stdout</code> あるいは <code>junit.platform.output.capture.stderr</code> に <code>true</code> を設定します。
また、実行時の出力バッファサイズをテストコンテナやテストクラスごとに変更するときは <code>junit.platform.output.capture.maxBuffer</code> を設定します。</p>
</div>
<div class="paragraph">
<p>この機能を有効化すると、JUnit Platform は標準出力（標準エラー出力）をキャプチャーします。
キャプチャーした内容は、登録済みの <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/TestExecutionListener.html">TestExecutionListener</a></code> へ発行するレポート情報のキー <code>stdout</code>（<code>stderr</code>）で参照できます。
リスナーインスタンスは、テストコンテナやテストクラスの実行が完了する前に、レポート情報を参照できます。</p>
</div>
<div class="paragraph">
<p>なお、テストコンテナやテストクラスを実行したスレッドが標準出力（標準エラー出力）に出力した内容しかキャプチャーできません。
他のスレッドが出力した内容は無視されてしまいますし、特に <a href="#writing-tests-parallel-execution">並列実行</a> させている場合は、どのテストコンテナやテストクラスが出力した内容なのか、後から区別できません。</p>
</div>
</div>
<div class="sect2">
<h3 id="running-tests-listeners"><a class="anchor" href="#running-tests-listeners"></a>4.8. リスナーを使用する</h3>
<div class="paragraph">
<p>JUnit Platform の提供するリスナーAPIを使用すると、<code>TestPlan</code> がテストを発見したり実行したりする途中のさまざまなポイントで発火するイベントに、JUnit やサードパーティライブラリだけでなく、ユーザーの作成したコードが反応できるようになります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/LauncherSessionListener.html">LauncherSessionListener</a></code>: <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/LauncherSession.html">LauncherSession</a></code> が開かれた、あるいは、閉じられたイベントを受信します</p>
</li>
<li>
<p><code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/LauncherDiscoveryListener.html">LauncherDiscoveryListener</a></code>: テストの探索中に発生したイベントを受信します</p>
</li>
<li>
<p><code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/TestExecutionListener.html">TestExecutionListener</a></code>: テストの実行中に発生したイベントを受信します</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>基本的に <code>LauncherDiscoveryListener</code> API を使用するのはビルドツールや IDE が独自の機能を提供するためです。
テスト実行時に自動的に登録する場合が多いでしょう。</p>
</div>
<div class="paragraph">
<p><code>LauncherDiscoveryListener</code> と <code>TestExecutionListener</code> API を使用することが多いのは、任意の形式のテスト結果レポートを生成したり、IDE 内の GUI でテストの実行計画を表示したりする場合です。
やはりビルドツールや IDE の提供する実装クラスを実行時に自動的に登録する場合が多いでしょう。
サードパーティライブラリを含む場合もあるようです（いずれにしても自動的に登録するようになっています）。
独自のリスナーを実装、登録することもできます。</p>
</div>
<div class="paragraph">
<p>リスナーを登録したり構成したりする方法については次のドキュメントを参照してください。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#launcher-api-launcher-session-listeners-custom">セッションリスナー（LauncherSessionListener）を登録する</a></p>
</li>
<li>
<p><a href="#launcher-api-launcher-discovery-listeners-custom">テスト発見リスナー（LauncherDiscoveryListener）を登録します</a></p>
</li>
<li>
<p><a href="#launcher-api-listeners-custom">テスト実行リスナー（TestExecutionListener）を登録する</a></p>
</li>
<li>
<p><a href="#launcher-api-listeners-config">テスト実行リスナーの設定</a></p>
</li>
<li>
<p><a href="#launcher-api-listeners-custom-deactivation">テスト実行リスナーを不活性にする</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>JUnit Platform は次のようなリスナーを提供しています。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#running-tests-listeners-flight-recorder">Java Flight Recorder を使用する</a> </dt>
<dd>
<p><code>FlightRecordingExecutionListener</code> と <code>FlightRecordingDiscoveryListener</code>。
テストの探索時と実行時に Java Flight Recorder のイベントを発行します。</p>
</dd>
<dt class="hdlist1"><code><a href="../api/org.junit.platform.reporting/org/junit/platform/reporting/legacy/xml/LegacyXmlReportGeneratingListener.html">LegacyXmlReportGeneratingListener</a></code> </dt>
<dd>
<p><code>TestExecutionListener</code> が、JUnit 4 のテスト結果レポート形式として事実上の標準になっている XML 形式のテスト結果レポートを生成します。
詳しくは <a href="#junit-platform-reporting">JUnit Platform レポート機能</a> を参照してください。</p>
</dd>
<dt class="hdlist1"><code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/listeners/LoggingListener.html">LoggingListener</a></code> </dt>
<dd>
<p><code>TestExecutionListener</code> の生成する全てのログメッセージを <code>BiConsumer</code> の消費するイベントとして生成します（<code>Throwable</code> と <code>Supplier&lt;String&gt;</code> として渡します）。</p>
</dd>
<dt class="hdlist1"><code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/listeners/SummaryGeneratingListener.html">SummaryGeneratingListener</a></code> </dt>
<dd>
<p><code>TestExecutionListener</code> が実行したテストの概要を <code>PrintWriter</code> で（標準出力に）出力します。</p>
</dd>
<dt class="hdlist1"><code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/listeners/UniqueIdTrackingListener.html">UniqueIdTrackingListener</a></code> </dt>
<dd>
<p><code>TestExecutionListener</code> の実行する <code>TestPlan</code> がスキップおよび実行した全てのテストそれぞれに固有の ID を割り当てて追跡し、 <code>TestPlan</code> が完了したら追跡した全ての ID をファイルに記録します。</p>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="running-tests-listeners-flight-recorder"><a class="anchor" href="#running-tests-listeners-flight-recorder"></a>4.8.1. Java Flight Recorder を使用する</h4>
<div class="paragraph">
<p>JUnit Platform は 1.7 から Java Flight Recorder のイベントを生成する機能をオプトイン方式で提供しています。
<a href="https://openjdk.java.net/jeps/328">JEP 328</a> は Java Flight Recorder（JFR）を次のように説明しています。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Flight Recorder はアプリケーション（JVM や OS）の生成したイベントを記録します。
イベントは単一ファイルへ記録します。
イベントを記録したファイルはバグ報告へ添付したり、サポートエンジニアが調査するために使用したりできるので、問題が発生するまでに起きていたことを後から分析できます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>テストを実行しながら Flight Recorder イベントを記録するには次のような設定をしなければなりません。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Java 8 Update 262 以降、あるいは Java 11 以降を使用します。</p>
</li>
<li>
<p><code>org.junit.platform.jfr</code> モジュール（<code>junit-platform-jfr-1.9.0-SNAPSHOT.jar</code>）を、テストランタイムの参照できるクラスパスやモジュールパスへ配置します。</p>
</li>
<li>
<p>テストを実行するときにフライトレコード機能を有効化します。具体的には JVM のコマンドライン引数に次のようなフラグを指定します。</p>
<div class="literalblock">
<div class="content">
<pre>-XX:StartFlightRecording:filename=...</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>適切なコマンドライン引数を構成するには、使用しているビルドツールのドキュメントを参照してください。</p>
</div>
<div class="paragraph">
<p>JDK と一緒に配布されているコマンドラインツールの <a href="https://docs.oracle.com/en/java/javase/14/docs/specs/man/jfr.html">jfr</a> や、https://jdk.java.net/jmc/[JDK Mission Control] を使用すれば、記録したイベントを分析できます。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
今のところ Flight Recorder のイベント記録機能は <em>実験的な機能です</em>。
JUnit チームがこの機能を改善して、正式機能へ <a href="#api-evolution">昇格</a> できるよう、試用してフィードバックを提供してください。
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="extensions"><a class="anchor" href="#extensions"></a>5. 拡張モデル</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="extensions-overview"><a class="anchor" href="#extensions-overview"></a>5.1. 概要</h3>
<div class="paragraph">
<p>JUnit 4 の拡張ポイントである <code>Runner</code> や <code>TestRule</code> や <code>MethodRule</code> に比べると、JUnit Jupiter の拡張モデル <code>Extension</code> API は単純で分かりやすい考え方になっています。
なお、<code>Extension</code> 自体はただのマーカーインターフェイスです。</p>
</div>
</div>
<div class="sect2">
<h3 id="extensions-registration"><a class="anchor" href="#extensions-registration"></a>5.2. 拡張機能を登録する</h3>
<div class="paragraph">
<p>拡張機能を登録する方法は3種類あります。
<a href="#extensions-registration-declarative"><code>@ExtendWith</code></a> を使用する <em>宣言的な</em> 登録と、<a href="#extensions-registration-programmatic"><code>@RegisterExtension</code></a> を使用する <em>手続き的な</em> 登録と、Java の <a href="#extensions-registration-automatic"><code>ServiceLoader</code></a> を使用する <em>自動的な</em> 登録です。</p>
</div>
<div class="sect3">
<h4 id="extensions-registration-declarative"><a class="anchor" href="#extensions-registration-declarative"></a>5.2.1. 宣言的に登録する方法</h4>
<div class="paragraph">
<p>開発者は <code>@ExtendWith(&#8230;&#8203;)</code> に（あるいは自作の <a href="#writing-tests-meta-annotations">合成アノテーション</a> に）登録する拡張機能のクラス参照を指定することで、テストインターフェイスやテストクラスやテストメソッドへ1つ以上の拡張機能を登録できます。
JUnit Jupiter の 5.8 からは、フィールドや、テストクラスのコンストラクタあるいはテストメソッドあるいはライフサイクルメソッドのメソッド引数を <code>@ExtendWith</code> で修飾できるようになりました。</p>
</div>
<div class="paragraph">
<p>例えば、<code>WebServerExtension</code> をテストメソッドへ登録するときは次のように記述します。
ここでは、<code>WebServerExtension</code> が HTTP サーバーを起動し、<code>@WebServerUrl</code> で修飾したメソッド引数へサーバーのURLを注入することを想定しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Test</span>
<span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">WebServerExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">getProductList</span><span class="o">(</span><span class="nd">@WebServerUrl</span> <span class="nc">String</span> <span class="n">serverUrl</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">WebClient</span> <span class="n">webClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">WebClient</span><span class="o">();</span>
    <span class="c1">// Use WebClient to connect to web server using serverUrl and verify response</span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="mi">200</span><span class="o">,</span> <span class="n">webClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">serverUrl</span> <span class="o">+</span> <span class="s">"/products"</span><span class="o">).</span><span class="na">getResponseStatus</span><span class="o">());</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>あるクラスやそのサブクラスに定義した全てのテストメソッドで使用するために <code>WebServerExtension</code> を登録するには、テストクラスを次のように修飾します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">WebServerExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MyTests</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@ExtendWith</code> には複数の拡張機能（クラス参照）を登録できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ExtendWith</span><span class="o">({</span> <span class="nc">DatabaseExtension</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">WebServerExtension</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
<span class="kd">class</span> <span class="nc">MyFirstTests</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>それぞれの拡張機能ごとに <code>@ExtendWith</code> を記述することもできます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">DatabaseExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">WebServerExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MySecondTests</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">拡張機能の登録順序</div>
<div class="paragraph">
<p>クラスやメソッドやメソッド引数について宣言的に登録した拡張は、ソースコードに記述したとおりの順番で登録されます。
例えば、前のコード例の <code>MyFirstTest</code> と <code>MySecondTests</code> なら、どちらも <code>DatabaseExtension</code> と <code>WebServerExtension</code> の <strong>見た目の順番通り</strong> に拡張機能を登録します。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>複数の拡張機能の組み合わせを再利用できるようにしたければ、<code>@ExtendWith</code> を <em>メタアノテーション</em> として使用する独自の <em><a href="#writing-tests-meta-annotations">合成アノテーション</a></em> を作成すればいいでしょう。
そうすれば、<code>@ExtendWith({ DatabaseExtension.class, WebServerExtension.class })</code> を <code>@DatabaseAndWebServerExtension</code> に置き換えられます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Target</span><span class="o">({</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">TYPE</span><span class="o">,</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">METHOD</span> <span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@ExtendWith</span><span class="o">({</span> <span class="nc">DatabaseExtension</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">WebServerExtension</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">DatabaseAndWebServerExtension</span> <span class="o">{</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>前の例ではクラスやメソッドを <code>@ExtendWith</code> で修飾していました。
しかし、フィールドやメソッド引数に対して拡張機能を登録するほうが役に立つ場合があるのです。
乱数を生成する拡張機能があるとして、生成した乱数をフィールドやコンストラクタ引数、テストメソッドの引数、ライフサイクルメソッドの引数に注入できる場合を考えてみましょう。
なお、この拡張機能は <code>@ExtendWith(RandomNumberExtension.class)</code> をメタアノテーションとする <code>@Random</code> アノテーションを提供するものとします。
この拡張機能は次のように使用できるでしょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Target</span><span class="o">({</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">,</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">PARAMETER</span> <span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">RandomNumberExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Random</span> <span class="o">{</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">RandomNumberDemo</span> <span class="o">{</span>

    <span class="c1">// use random number field in test methods and @BeforeEach</span>
    <span class="c1">// or @AfterEach lifecycle methods</span>
    <span class="nd">@Random</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">randomNumber1</span><span class="o">;</span>

    <span class="nc">RandomNumberDemo</span><span class="o">(</span><span class="nd">@Random</span> <span class="kt">int</span> <span class="n">randomNumber2</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// use random number in constructor</span>
    <span class="o">}</span>

    <span class="nd">@BeforeEach</span>
    <span class="kt">void</span> <span class="nf">beforeEach</span><span class="o">(</span><span class="nd">@Random</span> <span class="kt">int</span> <span class="n">randomNumber3</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// use random number in @BeforeEach method</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test</span><span class="o">(</span><span class="nd">@Random</span> <span class="kt">int</span> <span class="n">randomNumber4</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// use random number in test method</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">フィールドを <code>@ExtendWith</code> で修飾した場合の拡張機能の登録順序</div>
<div class="paragraph">
<p>フィールドを <code>@ExtendWith</code> で修飾して宣言的に登録した拡張機能の登録順は、<code>@RegisterExtension</code> で修飾したフィールドや <code>@ExtendWith</code> で修飾した他のフィールドの相対的な関係性を考慮する、意図的にわかりにくくした決定論的アルゴリズムによって決まります。
しかし、<code>@ExtendWith</code> で修飾したフィールド（の登録する拡張機能）の順序は <code>@Order</code> アノテーションで変更できます。
詳しくは <code>@RegisterExtension</code> で修飾したフィールドに関する <a href="#extensions-registration-programmatic-order">拡張機能の登録順序</a> の説明を参照してください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@ExtendWith</code> は <code>static</code> 宣言したフィールドとしなかったフィールドのどちらも修飾できます。
<code>@RegisterExtension</code> で修飾するフィールドを <a href="#extensions-registration-programmatic-static-fields">static 宣言する場合</a> と <a href="#extensions-registration-programmatic-instance-fields">static 宣言しない場合</a> と同じ規則になります。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="extensions-registration-programmatic"><a class="anchor" href="#extensions-registration-programmatic"></a>5.2.2. 手続き的に登録する方法</h4>
<div class="paragraph">
<p>開発者はテストクラスのフィールドを <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/RegisterExtension.html">@RegisterExtension</a></code> で修飾することで、手続き的に拡張機能を登録できます。</p>
</div>
<div class="paragraph">
<p><a href="#extensions-registration-declarative"><code>@ExtendWith</code></a> で <em>宣言的に登録する</em> 場合、アノテーションを使用するしか設定を変更する方法がありませんでした。
しかし、<code>@RegisterExtension</code> で <em>手続き的に登録する</em> 場合、拡張機能のコンストラクタや <code>static</code> 宣言したファクトリメソッドやビルダー API で設定を変更できます。</p>
</div>
<div id="extensions-registration-programmatic-order" class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">拡張機能の登録順序</div>
<div class="paragraph">
<p>初期設定では、<code>@RegisterExtension</code> で手続き的に登録する場合や、フィールドを <code>@ExtendWith</code> で修飾して宣言的に登録する場合、その登録順は意図的にわかりにくくした決定論的アルゴリズムで決まるようになっています。
したがって、再びテストスイートを実行しても、同じ登録順になることが保証されています。再現可能なビルド（プロセス）を保証するためです。
とはいえ、拡張機能の登録順序を明示したい場合もあるでしょう。
そういう場合、<code>@RegisterExtension</code> や <code>@ExtendWith</code> で修飾したフィールドへ <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/Order.html">@Order</a></code> を追加します。</p>
</div>
<div class="paragraph">
<p><code>@Order</code> で修飾しなかったフィールドの相対位置は <em>default</em> すなわち <code>Integer.MAX_VALUE / 2</code> になります。
<code>@Order</code> で修飾したフィールドによる拡張機能の登録順を、<code>@Order</code> で修飾しなかったフィールドによる拡張機能の前あるいは後にできるようにするためです。
<code>default</code> 値より小さい相対位置を指定したフィールド（の拡張機能）は、<code>@Order</code> で修飾しなかったフィールド（の拡張機能）より前に登録します。
同様に、<code>default</code> 値より大きい相対位置を指定したフィールド（の拡張機能）は、<code>@Order</code> で修飾しなかったフィールド（の拡張機能）より後に登録します。
例えば、<em>事前処理</em> を提供する拡張機能を <code>default</code> 値より大きな相対位置で登録すれば最後に登録するようにできるし、<em>事後処理</em> を提供する拡張機能を <code>default</code> 値より小さな相対位置で登録すれば最初に登録するようにできます。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@RegisterExtension</code> で修飾するフィールドは決して <code>null</code> にしてはいけません（参照するとき）。<code>static</code> 宣言したフィールドとしなかったフィールドのどちらも修飾できます。
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="extensions-registration-programmatic-static-fields"><a class="anchor" href="#extensions-registration-programmatic-static-fields"></a>static 宣言したフィールドで拡張機能を登録する</h5>
<div class="paragraph">
<p><code>@RegisterExtension</code> で修飾するフィールドを <code>static</code> 宣言する場合、テストクラスを修飾する <code>@ExtendWith</code> より後に拡張機能を登録します。
このように <em>クラスレベルで登録した拡張機能</em> は、どのような拡張APIでも実装できることになっています（制限はありません）。
クラスレベルのAPIである <code>BeforeAllCallback, AfterAllCallback, TestInstancePostProcessor, TestInstancePreDestroyCallback</code> を実装できますし、メソッドレベルのAPIである <code>BeforeEachCallback</code> なども実装できるのです。</p>
</div>
<div class="paragraph">
<p>次のコード例では、テストクラスのフィールド <code>server</code> を、<code>WebServerExtension</code> のビルダー API で手続き的に初期化しています。
<code>WebServerExtension</code> は自動的にクラスレベルの拡張として登録されます。
ここでは、テストクラスの全てのテストを実行する前に HTTP サーバーを開始し、全てのテストが完了してから HTTP サーバーを停止することになります。
さらに、<code>static</code> 宣言したライフサイクルメソッド <code>@BeforeAll</code> や <code>@AfterAll</code> は、<code>@BeforeEach</code> や <code>@AfterEach</code> や <code>@Test</code> と同じく <code>server</code> フィールドを介して拡張機能のインスタンスを参照できます。</p>
</div>
<div class="listingblock">
<div class="title">static フィールドで拡張機能を登録する（Java）</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">WebServerDemo</span> <span class="o">{</span>

    <span class="nd">@RegisterExtension</span>
    <span class="kd">static</span> <span class="nc">WebServerExtension</span> <span class="n">server</span> <span class="o">=</span> <span class="nc">WebServerExtension</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">enableSecurity</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">getProductList</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">WebClient</span> <span class="n">webClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">WebClient</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">serverUrl</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="na">getServerUrl</span><span class="o">();</span>
        <span class="c1">// Use WebClient to connect to web server using serverUrl and verify response</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">200</span><span class="o">,</span> <span class="n">webClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">serverUrl</span> <span class="o">+</span> <span class="s">"/products"</span><span class="o">).</span><span class="na">getResponseStatus</span><span class="o">());</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="sect5">
<h6 id="extensions-registration-programmatic-static-fields-kotlin"><a class="anchor" href="#extensions-registration-programmatic-static-fields-kotlin"></a>Kotlin における static フィールドの扱い</h6>
<div class="paragraph">
<p>Kotlin には <code>static</code> フィールドという考え方がありません。
しかし、<code>@JvmStatic</code> アノテーションを使うと、コンパイラに <code>private static</code> フィ－ルドを生成させられるようになっています。
<code>public static</code> フィールドを生成させたいときは <code>@JvmField</code> アノテーションを使用します。</p>
</div>
<div class="paragraph">
<p>次のコード例は前の <code>WebServerDemo</code> の Kotlin バージョンです。</p>
</div>
<div class="listingblock">
<div class="title">static フィールドで拡張機能を登録する（Kotlin）</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">KotlinWebServerDemo</span> <span class="p">{</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
        <span class="nd">@JvmStatic</span>
        <span class="nd">@RegisterExtension</span>
        <span class="kd">val</span> <span class="py">server</span> <span class="p">=</span> <span class="nc">WebServerExtension</span><span class="p">.</span><span class="nf">builder</span><span class="p">()</span>
                <span class="p">.</span><span class="nf">enableSecurity</span><span class="p">(</span><span class="k">false</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">build</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nd">@Test</span>
    <span class="k">fun</span> <span class="nf">getProductList</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Use WebClient to connect to web server using serverUrl and verify response</span>
        <span class="kd">val</span> <span class="py">webClient</span> <span class="p">=</span> <span class="nc">WebClient</span><span class="p">()</span>
        <span class="kd">val</span> <span class="py">serverUrl</span> <span class="p">=</span> <span class="n">server</span><span class="p">.</span><span class="n">serverUrl</span>
        <span class="nf">assertEquals</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">webClient</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"$serverUrl/products"</span><span class="p">).</span><span class="n">responseStatus</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="extensions-registration-programmatic-instance-fields"><a class="anchor" href="#extensions-registration-programmatic-instance-fields"></a>インスタンスフィールドで拡張機能を登録する</h5>
<div class="paragraph">
<p><code>@RegisterExtension</code> で修飾したフィールドがインスタンスフィールドの場合、テストクラスをインスタンス化し、登録済みの全ての <code>TestInstancePostProcessor</code> が後処理を実行し（拡張機能が自身のインスタンスをフィールドに注入する可能性もあります）、それから拡張機能を登録します。
したがって <em>インスタンスレベルの拡張機能</em> が <code>BeforeAllCallback, AfterAllCallback, TestInstancePostProcessor</code> のような API を実装していたとしても、呼び出される機会はありません。
初期設定ではインスタンスレベルの拡張機能が登録されるのは、メソッドを修飾した <code>@ExtendWith</code> の拡張機能より <em>後</em> になります。
ただし、テストクラスのセマンティクスをクラス単位（per-class）にしている場合、メソッドを修飾した <code>@ExtendWith</code> の拡張機能より <em>前</em> に登録します。</p>
</div>
<div class="paragraph">
<p>次のコード例ではインスタンスフィールド <code>docs</code> を手続き的に初期化しています。
独自の <code>lookUpDocsDir()</code> メソッドの返り値を <code>DocumentExtension</code> のファクトリメソッド <code>forPath()</code> の引数にしているのです。
<code>DocumentationExtension</code> はメソッドレベルで自動的に登録される拡張機能ということになります。
さらに、<code>@BeforeEach, @AfterEach, @Test</code> で修飾したメソッドから、<code>docs</code> フィールドを介して拡張機能のインスタンスを参照できます。</p>
</div>
<div class="listingblock">
<div class="title">インスタンスフィールドで拡張機能を登録する</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">DocumentationDemo</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="nc">Path</span> <span class="nf">lookUpDocsDir</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// return path to docs dir</span>
    <span class="o">}</span>

    <span class="nd">@RegisterExtension</span>
    <span class="nc">DocumentationExtension</span> <span class="n">docs</span> <span class="o">=</span> <span class="nc">DocumentationExtension</span><span class="o">.</span><span class="na">forPath</span><span class="o">(</span><span class="n">lookUpDocsDir</span><span class="o">());</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">generateDocumentation</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// use this.docs ...</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extensions-registration-automatic"><a class="anchor" href="#extensions-registration-automatic"></a>5.2.3. 自動的に拡張機能を登録する</h4>
<div class="paragraph">
<p>JUnit Jupiter は <a href="#extensions-registration-declarative">宣言的な拡張機能の登録方法</a> と <a href="#extensions-registration-programmatic">手続き的な拡張機能の登録方法</a> に加えて、Java の <code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/ServiceLoader.html">ServiceLoader</a></code> を使用する <em>大局的な拡張機能の登録方法</em> に対応しています。
この方法を使用すると、クラスパスに配置したサードパーティの拡張機能を自動的に検出、登録することができます。</p>
</div>
<div class="paragraph">
<p>具体的には、拡張機能の実装と <code>/META-INF/services/org.junit.jupiter.api.extension.Extension</code> というファイルを jar ファイルに配置します。
<code>org.junit.jupiter.api.extension.Extension</code> には拡張機能の実装クラスの完全修飾クラス名を記述します。</p>
</div>
<div class="sect4">
<h5 id="extensions-registration-automatic-enabling"><a class="anchor" href="#extensions-registration-automatic-enabling"></a>拡張機能の自動検出を有効化する</h5>
<div class="paragraph">
<p>自動検出機能は高度な機能なので、初期設定では無効化されています。
有効化するには <em>設定パラメータ</em> <code>junit.jupiter.extensions.autodetection.enabled</code> に <code>true</code> を設定します。
<code>Launcher</code> に渡す <code>LauncherDiscoveryRequest</code> の値を、システムプロパティや設定ファイル（<a href="#running-tests-config-params">設定パラメータの構成</a> を参照）で指定できます。</p>
</div>
<div class="paragraph">
<p>例えば、システムプロパティを指定するときは次のように実行します。</p>
</div>
<div class="paragraph">
<p><code>-Djunit.jupiter.extensions.autodetection.enabled=true</code></p>
</div>
<div class="paragraph">
<p>自動検出機能を有効にしている場合、JUnit Jupiter の基本拡張（<code>TestInfo</code> や <code>TestReporter</code> のための拡張機能）を登録した後に、<code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/ServiceLoader.html">ServiceLoader</a></code> の検出した拡張機能を登録します。</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extensions-registration-inheritance"><a class="anchor" href="#extensions-registration-inheritance"></a>5.2.4. 拡張機能の継承</h4>
<div class="paragraph">
<p>登録した拡張機能は、テストクラスの階層構造をトップダウン方向に継承していきます。
また、クラスレベルで登録した拡張機能は、メソッドレベルに継承していきます。
さらに、特定の拡張機能はその拡張コンテキストと親のコンテキストについて1度しか登録できません。
後から同じ拡張機能を登録しようとした結果は無視されます。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extensions-conditions"><a class="anchor" href="#extensions-conditions"></a>5.3. 条件付きのテスト実行</h3>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/ExecutionCondition.html">ExecutionCondition</a></code> は <em>条件付きのテスト実行</em> を手続き的に実現する拡張APIです。</p>
</div>
<div class="paragraph">
<p><code>ExecutionCondition</code> はそれぞれのテストコンテナ（テストクラス）ごとに <em>評価され</em>、<code>ExtensionContext</code> よりそのコンテナに含まれる全てのテストを実行するかどうかを決定します。
同じように、<code>ExecutionCondition</code> はそれぞれのテストメソッドごとに <em>評価され</em>、<code>ExtensionContext</code> そのテストメソッドを実行するかどうかを決定します。</p>
</div>
<div class="paragraph">
<p>複数の <code>ExecutionCondition</code> を登録した場合、どちらかの評価結果が <em>disabled</em> ならただちにそのテストコンテナ（あるいはテスト）を無効化します。
つまり、常に登録した全ての条件が評価されるわけではないということです（他の条件がテストを無効と判断しているかもしれません）。
ブール演算の OR 演算子のように短絡評価するのです。</p>
</div>
<div class="paragraph">
<p>具体例は <code><a href="https://github.com/junit-team/junit5/tree/HEAD/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/DisabledCondition.java">DisabledCondition</a></code> や <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/Disabled.html">@Disabled</a></code> のソースコードを参照してください。</p>
</div>
<div class="sect3">
<h4 id="extensions-conditions-deactivation"><a class="anchor" href="#extensions-conditions-deactivation"></a>5.3.1. 条件を不活性にする</h4>
<div class="paragraph">
<p>想定した条件を <em>満たさない場合</em> でもテストスイートを実行できるようになっていると便利なときがあります。
例えば、<em>成功しないことが分かっている</em> としても <code>@Disabled</code> で修飾したテストを実行したい場合があるかもしれません。
そのためには、設定パラメータの <code>junit.jupiter.conditions.deactivate</code> で不活性にする（評価しない）条件を指定します。
<code>Launcher</code> に渡す <code>LauncherDiscoveryRequest</code> の値を、システムプロパティや設定ファイル（<a href="#running-tests-config-params">設定パラメータの構成</a> を参照）で指定できます。</p>
</div>
<div class="paragraph">
<p>例えば、<code>@Disabled</code> をシステムプロパティで不活性化するときは次のように実行します。</p>
</div>
<div class="paragraph">
<p><code>-Djunit.jupiter.conditions.deactivate=org.junit.\*DisabledCondition</code></p>
</div>
<div class="sect4">
<h5 id="extensions-conditions-deactivation-patterns"><a class="anchor" href="#extensions-conditions-deactivation-patterns"></a>パターンマッチ記法</h5>
<div class="paragraph">
<p><a href="#running-tests-config-params-deactivation-pattern">パターンマッチ記法</a> を参照してください。</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extensions-test-instance-factories"><a class="anchor" href="#extensions-test-instance-factories"></a>5.4. テストインスタンスファクトリ</h3>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/TestInstanceFactory.html">TestInstanceFactory</a></code> はテストクラスのインスタンスを <em>作成する</em> ための拡張APIです。</p>
</div>
<div class="paragraph">
<p>一般的な使い方として、DIフレームワークからテストインスタンスを取得したり、<code>static</code> ファクトリメソッドでテストインスタンスを作成することがあると思います。</p>
</div>
<div class="paragraph">
<p><code>TestInstanceFactory</code> が登録されていなければ、テストフレームワークはテストクラスをインスタンス化するため <em>唯一のコンストラクタ</em> を使用します。
<code>ParameterResolver</code> でコンストラクタ引数を解決する場合があるかもしれません。</p>
</div>
<div class="paragraph">
<p><code>TestInstanceFactory</code> を実装した拡張機能を登録できるのは、テストインターフェイスやトップレベルクラス、<code>@Nested</code> で修飾した内部クラスです。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>1つのテストクラスに対して複数の <code>TestInstaneFactory</code> を登録すると、そのクラスの全てのテストや、全ての派生クラス、全ての入れ子クラスについて例外をスローします。
既定クラスや <em>エンクロージングクラス</em> （<code>@Nested</code> で修飾した内部クラス）が登録した <code>TestInstanceFactory</code> は全て <em>継承</em> します。
<code>TestInstanceFactory</code> が一意になることを保証するのはユーザーの仕事なのです。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="extensions-test-instance-post-processing"><a class="anchor" href="#extensions-test-instance-post-processing"></a>5.5. テストインスタンスを作成した後の処理</h3>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/TestInstancePostProcessor.html">TestInstancePostProcessor</a></code> はテストクラスのインスタンスを作成した <em>後</em> に実行する処理を実行するための拡張APIです。</p>
</div>
<div class="paragraph">
<p>一般的な使い方として、テストインスタンスに依存オブジェクトを注入したり、独自の初期化メソッドを呼び出すことがあると思います。</p>
</div>
<div class="paragraph">
<p>具体例は <code><a href="https://github.com/mockito/mockito/blob/release/2.x/subprojects/junit-jupiter/src/main/java/org/mockito/junit/jupiter/MockitoExtension.java">MockitoExtension</a></code> や <code><a href="https://github.com/spring-projects/spring-framework/tree/HEAD/spring-test/src/main/java/org/springframework/test/context/junit/jupiter/SpringExtension.java">SpringExtension</a></code> のソースコードを参照してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="extensions-test-instance-pre-destroy-callback"><a class="anchor" href="#extensions-test-instance-pre-destroy-callback"></a>5.6. テストインスタンスを破棄する前のコールバック</h3>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/TestInstancePreDestroyCallback.html">TestInstancePreDestroyCallback</a></code> はテストクラスのインスタンスがテストを実行した <em>後</em>、インスタンスを破棄する <em>前</em> に実行したい処理を実行するための拡張APIです。</p>
</div>
<div class="paragraph">
<p>一般的な使い方として、テストインスタンスの依存オブジェクトを後始末したり、独自の逆初期化メソッドを呼び出すことがあると思います。</p>
</div>
</div>
<div class="sect2">
<h3 id="extensions-parameter-resolution"><a class="anchor" href="#extensions-parameter-resolution"></a>5.7. パラメータの解決</h3>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/ParameterResolver.html">ParameterResolver</a></code> は実行時にいろいろなパラメータを解決するための拡張APIです。</p>
</div>
<div class="paragraph">
<p><em>テストクラス</em> のコンストラクタ、<em>テストメソッド</em>、<em>ライフサイクルメソッド</em>（<a href="#writing-tests-classes-and-methods">テストクラスとテストメソッド</a> を参照）に宣言した引数は、<code>ParameterResolver</code> により実行時に <em>解決</em> しなければなりません。
使用できるのは組み込みの <code>ParameterResolver</code> （<code><a href="https://github.com/junit-team/junit5/tree/HEAD/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/TestInfoParameterResolver.java">TestInfoParameterResolver</a></code> など）か、<a href="#extensions-registration">ユーザーの登録した拡張機能</a> が提供する <code>ParameterResolver</code> です。
一般的には、引数の <em>名前</em> や <em>型</em> や <em>アノテーション</em>、あるいはそれらの組み合わせから解決することになるでしょう。</p>
</div>
<div class="paragraph">
<p>総称型クラスのアダプターである <code><a href="https://github.com/junit-team/junit5/tree/HEAD/junit-jupiter-api/src/main/java/org/junit/jupiter/api/extension/support/TypeBasedParameterResolver.java">TypeBasedParameterResolver</a></code> を継承すると、特定の型に対する引数を解決する <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/ParameterResolver.html">ParameterResolver</a></code> を簡単に実装できます。</p>
</div>
<div class="paragraph">
<p>具体例は <code><a href="https://github.com/junit-team/junit5/tree/HEAD/junit-jupiter-engine/src/test/java/org/junit/jupiter/engine/execution/injection/sample/CustomTypeParameterResolver.java">CustomTypeParameterResolver</a></code> や <code><a href="https://github.com/junit-team/junit5/tree/HEAD/junit-jupiter-engine/src/test/java/org/junit/jupiter/engine/execution/injection/sample/CustomAnnotationParameterResolver.java">CustomAnnotationParameterResolver</a></code> や <code><a href="https://github.com/junit-team/junit5/tree/HEAD/junit-jupiter-engine/src/test/java/org/junit/jupiter/engine/execution/injection/sample/MapOfListsTypeBasedParameterResolver.java">MapOfListsTypeBasedParameterResolver</a></code> のソースコードを参照してください。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>JDK 9 より前の JDK に付属する <code>javac</code> の生成するバイトコードに含まれるバグのせいで、<em>インナークラス</em> のコンストラクタ（<code>@Nested</code> で修飾したテストクラスです）引数を修飾するアノテーションを、<code>java.lang.reflect.Parameter</code> API で直接的に取得する操作は常に失敗します。</p>
</div>
<div class="paragraph">
<p><code>ParameterResolver</code> の実装クラスは <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/ParameterContext.html">ParameterContext</a></code> API （メソッドのリストは以下）を使用できるので、引数を修飾するアノテーションを参照できます。
拡張機能の作者は、JDK のバグを回避するため <code>java.lang.refrect.Parameter</code> の代わりにこれらの API を使うことを強くお勧めします。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>boolean isAnnotated(Class&lt;? extends Annotation&gt; annotationType)</code></p>
</li>
<li>
<p><code>Optional&lt;A&gt; findAnnotation(Class&lt;A&gt; annotationType)</code></p>
</li>
<li>
<p><code>List&lt;A&gt; findRepeatableAnnotations(Class&lt;A&gt; annotationType)</code></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="extensions-test-result-processing"><a class="anchor" href="#extensions-test-result-processing"></a>5.8. テスト結果の処理</h3>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/TestWatcher.html">TestWatcher</a></code> は <em>テストメソッド</em> の実行結果を処理するための拡張APIです。
例えば、<code>TestWatcher</code> は実行時の状況に応じた次のようなイベントを受信します（メソッドを呼び出します）。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>testDisabled</code>: 無効化された <em>テストメソッド</em> をスキップしたときに呼び出すメソッドです</p>
</li>
<li>
<p><code>testSuccessful</code>: <em>テストメソッド</em> の実行が正常に終了した後に呼び出すメソッドです</p>
</li>
<li>
<p><code>testAborted</code>: <em>テストメソッド</em> の実行が中断された後に呼び出すメソッドです</p>
</li>
<li>
<p><code>testFailed</code>: <em>テストメソッド</em> の実行が失敗した後に呼び出すメソッドです</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="#writing-tests-classes-and-methods">テストクラスとテストメソッド</a> における「テストメソッド」の定義とは違って、このセクションの <em>テストメソッド</em> は <code>@Test</code> や <code>@TestTemplate</code> で修飾したメソッドのことを指しています（<code>@RepeatedTest</code> や <code>@ParameterizedTest</code> も含みます）。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>TestWatcher</code> の実装クラスを提供する拡張機能は、メソッドレベルかクラスレベルのいずれかで登録します。
拡張機能をクラスレベルで登録した場合、そこに含まれる全てのテストメソッドと、<code>@Nested</code> テストクラスに含まれる全てのテストメソッドが対象になります。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/ExtensionContext.html">ExtensionContext</a></code> の提供する <code>Store</code> に格納された全ての <code>ExtensionContext.Store.CloseableResource</code> のインスタンスは、この API より <em>前に</em> 閉じられます（<a href="#extensions-keeping-state">拡張機能の状態を保存する</a> を参照）。
閉じると困るリソースがあるなら、親のコンテキストの <code>Store</code> を使用するといいでしょう。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="extensions-lifecycle-callbacks"><a class="anchor" href="#extensions-lifecycle-callbacks"></a>5.9. ライフサイクルコールバック</h3>
<div class="paragraph">
<p>次のインターフェイスはテストの実行時ライフサイクルにおけるさまざまな時点で呼び出される拡張APIです。
詳しくは、後に続くセクションの具体例や、それぞれのインターフェイスや <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/package-summary.html">org.junit.jupiter.api.extension</a></code> パッケージの Javadoc を参照してください。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/BeforeAllCallback.html">BeforeAllCallback</a></code></p>
<div class="ulist">
<ul>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/BeforeEachCallback.html">BeforeEachCallback</a></code></p>
<div class="ulist">
<ul>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/BeforeTestExecutionCallback.html">BeforeTestExecutionCallback</a></code></p>
</li>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/AfterTestExecutionCallback.html">AfterTestExecutionCallback</a></code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/AfterEachCallback.html">AfterEachCallback</a></code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/AfterAllCallback.html">AfterAllCallback</a></code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">複数の拡張APIを実装する</div>
拡張機能の作者は1つの実装クラスで複数の拡張API（インターフェイス）を実装できます。
具体例として <code><a href="https://github.com/spring-projects/spring-framework/tree/HEAD/spring-test/src/main/java/org/springframework/test/context/junit/jupiter/SpringExtension.java">SpringExtension</a></code> のソースコードを参照してください。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="extensions-lifecycle-callbacks-before-after-execution"><a class="anchor" href="#extensions-lifecycle-callbacks-before-after-execution"></a>5.9.1. テスト実行の前、および、後のコールバック</h4>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/BeforeTestExecutionCallback.html">BeforeTestExecutionCallback</a></code> と <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/AfterTestExecutionCallback.html">AfterTestExecutionCallback</a></code> は、（相対的に）テストメソッドを実行する <em>直前</em> あるいは <em>直後</em> に任意の振る舞いを追加する拡張APIです。
時間を計測したり、トレースを記録したりするような場面で役立ちます。
<code>@BeforeEach</code> メソッドの前後や、<code>@AfterEach</code> メソッドの前後に振る舞いを追加したいときは、<code>BeforeEachCallback</code> や <code>AfterEachCallback</code> を実装します。</p>
</div>
<div class="paragraph">
<p>次のコード例では、テストメソッドの実行時間を計算してログに出力するため、<code>TimingExtension</code> が <code>BeforeTestExecutionCallback</code> と <code>AfterTestExecutionCallback</code> を実装しています。</p>
</div>
<div id="extensions-lifecycle-callbacks-timing-extension" class="listingblock">
<div class="title">テストメソッドの実行時間を計算してログに出力する拡張機能</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.lang.reflect.Method</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.logging.Logger</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.AfterTestExecutionCallback</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.BeforeTestExecutionCallback</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.ExtensionContext</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.ExtensionContext.Namespace</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.ExtensionContext.Store</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TimingExtension</span> <span class="kd">implements</span> <span class="nc">BeforeTestExecutionCallback</span><span class="o">,</span> <span class="nc">AfterTestExecutionCallback</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="nc">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">TimingExtension</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">START_TIME</span> <span class="o">=</span> <span class="s">"start time"</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeTestExecution</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="n">getStore</span><span class="o">(</span><span class="n">context</span><span class="o">).</span><span class="na">put</span><span class="o">(</span><span class="no">START_TIME</span><span class="o">,</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterTestExecution</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">Method</span> <span class="n">testMethod</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getRequiredTestMethod</span><span class="o">();</span>
        <span class="kt">long</span> <span class="n">startTime</span> <span class="o">=</span> <span class="n">getStore</span><span class="o">(</span><span class="n">context</span><span class="o">).</span><span class="na">remove</span><span class="o">(</span><span class="no">START_TIME</span><span class="o">,</span> <span class="kt">long</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="kt">long</span> <span class="n">duration</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">()</span> <span class="o">-</span> <span class="n">startTime</span><span class="o">;</span>

        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(()</span> <span class="o">-&gt;</span>
            <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"Method [%s] took %s ms."</span><span class="o">,</span> <span class="n">testMethod</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">duration</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="nc">Store</span> <span class="nf">getStore</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="na">getStore</span><span class="o">(</span><span class="nc">Namespace</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">getClass</span><span class="o">(),</span> <span class="n">context</span><span class="o">.</span><span class="na">getRequiredTestMethod</span><span class="o">()));</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>TimingExtensionTests</code> では <code>TimingExtension</code> を <code>@ExtendWith</code> で登録しているので、それぞれのテストメソッドの実行時間が計測されています。</p>
</div>
<div class="listingblock">
<div class="title"><code>TimingExtension</code> を使用するテストクラス</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">TimingExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">TimingExtensionTests</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">sleep20ms</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">20</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">sleep50ms</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">50</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>実行すると、次のような出力を得られるでしょう。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>INFO: Method [sleep20ms] took 24 ms.
INFO: Method [sleep50ms] took 53 ms.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extensions-exception-handling"><a class="anchor" href="#extensions-exception-handling"></a>5.10. 例外処理</h3>
<div class="paragraph">
<p>テストを実行しているときに例外が発生したら、それを呼び出し元に伝播させる前に介入して、なんらかの処理をさせたい場合があります（エラーをログに出力したり、リソースを解法したり）。
JUnit Jupiter ではそのような拡張機能を作成するための拡張APIを提供しています。
<code>@Test</code> メソッドで発生した例外を処理する <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/TestExecutionExceptionHandler.html">TestExecutionExceptionHandler</a></code> と、ライフサイクルメソッド（<code>@BeforeAll, @BeforeEach, @AfterEach, @AfterAll</code>）で発生した例外を処理する <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/LifecycleMethodExecutionExceptionHandler.html">LifecycleMethodExecutionExceptionHandler</a></code> です。</p>
</div>
<div class="paragraph">
<p>次のコード例では、テストを実行しているときに発生した <code>IOException</code> 以外の例外を再スローする拡張機能を実装しています。</p>
</div>
<div class="listingblock">
<div class="title">テスト実行時に発生した <code>IOException</code> を隠す例外処理ハンドラーの拡張機能</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">IgnoreIOExceptionExtension</span> <span class="kd">implements</span> <span class="nc">TestExecutionExceptionHandler</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleTestExecutionException</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">,</span> <span class="nc">Throwable</span> <span class="n">throwable</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">throwable</span> <span class="k">instanceof</span> <span class="nc">IOException</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">throw</span> <span class="n">throwable</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>次のコード例では、準備や後始末をしているときに予期せぬ例外が発生した場合、テスト対象のアプリケーションの状態を記録する方法を示しています。
ライフサイクルメソッドのコールバックを使用する場合と違って、例外処理ハンドラーを実行するかどうかは実行したテストの内容によって異なります。
この例のような使い方をすると、<code>@BeforeALl, @BeforeEach, @AfterEach, @AfterAll</code> が失敗した直後に呼び出されることが保証されています。</p>
</div>
<div class="listingblock">
<div class="title">An exception handling extension that records application state on error</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">RecordStateOnErrorExtension</span> <span class="kd">implements</span> <span class="nc">LifecycleMethodExecutionExceptionHandler</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleBeforeAllMethodExecutionException</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">,</span> <span class="nc">Throwable</span> <span class="n">ex</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>
        <span class="n">memoryDumpForFurtherInvestigation</span><span class="o">(</span><span class="s">"Failure recorded during class setup"</span><span class="o">);</span>
        <span class="k">throw</span> <span class="n">ex</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleBeforeEachMethodExecutionException</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">,</span> <span class="nc">Throwable</span> <span class="n">ex</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>
        <span class="n">memoryDumpForFurtherInvestigation</span><span class="o">(</span><span class="s">"Failure recorded during test setup"</span><span class="o">);</span>
        <span class="k">throw</span> <span class="n">ex</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleAfterEachMethodExecutionException</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">,</span> <span class="nc">Throwable</span> <span class="n">ex</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>
        <span class="n">memoryDumpForFurtherInvestigation</span><span class="o">(</span><span class="s">"Failure recorded during test cleanup"</span><span class="o">);</span>
        <span class="k">throw</span> <span class="n">ex</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleAfterAllMethodExecutionException</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">,</span> <span class="nc">Throwable</span> <span class="n">ex</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>
        <span class="n">memoryDumpForFurtherInvestigation</span><span class="o">(</span><span class="s">"Failure recorded during class cleanup"</span><span class="o">);</span>
        <span class="k">throw</span> <span class="n">ex</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>同じライフサイクルメソッドの定義順によって、複数の例外処理ハンドラーを呼び出す可能性があります。
いずれかの例外処理ハンドラーが自分で処理した例外を隠してしまうと、後に続く例外処理ハンドラーは呼び出されなくなりますし、JUnit にも失敗が伝わりません。
例外が発生しなかったとように扱われてしまうのです。
例外処理ハンドラーは受け取った例外を再スローするか、（受け取った例外を内包する）新しい例外をスローするか選ぶことになるでしょう。</p>
</div>
<div class="paragraph">
<p><code>@BeforeAll, @AfterAll</code> で発生した例外を、<code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/LifecycleMethodExecutionExceptionHandler.html">LifecycleMethodExecutionExceptionHandler</a></code> を実装した拡張機能で扱いたいときは、拡張機能をクラスレベルで登録しなければなりません。
この場合、それぞれのテストメソッドに対する <code>BeforeEach, AfterEach</code> にも例外処理ハンドラーが登録されます。</p>
</div>
<div class="listingblock">
<div class="title">複数の例外処理ハンドラーを登録する</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="c1">// Register handlers for @Test, @BeforeEach, @AfterEach as well as @BeforeAll and @AfterAll</span>
<span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">ThirdExecutedHandler</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MultipleHandlersTestCase</span> <span class="o">{</span>

    <span class="c1">// Register handlers for @Test, @BeforeEach, @AfterEach only</span>
    <span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">SecondExecutedHandler</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">FirstExecutedHandler</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testMethod</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extensions-intercepting-invocations"><a class="anchor" href="#extensions-intercepting-invocations"></a>5.11. テストコードの呼び出しへの割り込み</h3>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/InvocationInterceptor.html">InvocationInterceptor</a></code> はテストコードの呼び出しに割り込んで処理をさせたいときに使用する拡張APIです。</p>
</div>
<div class="paragraph">
<p>次のコード例では、Swing のイベントディスパッチスレッドで全てのテストメソッドを実行しています。</p>
</div>
<div class="listingblock">
<div class="title">ユーザー定義スレッドでテストを実行する拡張機能</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SwingEdtInterceptor</span> <span class="kd">implements</span> <span class="nc">InvocationInterceptor</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">interceptTestMethod</span><span class="o">(</span><span class="nc">Invocation</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">&gt;</span> <span class="n">invocation</span><span class="o">,</span>
            <span class="nc">ReflectiveInvocationContext</span><span class="o">&lt;</span><span class="nc">Method</span><span class="o">&gt;</span> <span class="n">invocationContext</span><span class="o">,</span>
            <span class="nc">ExtensionContext</span> <span class="n">extensionContext</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>

        <span class="nc">AtomicReference</span><span class="o">&lt;</span><span class="nc">Throwable</span><span class="o">&gt;</span> <span class="n">throwable</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AtomicReference</span><span class="o">&lt;&gt;();</span>

        <span class="nc">SwingUtilities</span><span class="o">.</span><span class="na">invokeAndWait</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">invocation</span><span class="o">.</span><span class="na">proceed</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">catch</span> <span class="o">(</span><span class="nc">Throwable</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">throwable</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>
        <span class="nc">Throwable</span> <span class="n">t</span> <span class="o">=</span> <span class="n">throwable</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">t</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="n">t</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extensions-test-templates"><a class="anchor" href="#extensions-test-templates"></a>5.12. テストテンプレートに呼び出し元のコンテキストを与える</h3>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/TestTemplate.html">@TestTemplate</a></code> で修飾したメソッドを実行するには、少なくとも1つの <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/TestTemplateInvocationContextProvider.html">TestTemplateInvocationContextProvider</a></code> を登録しなければなりません。
このインターフェイスの実装クラスは <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/TestTemplateInvocationContext.html">TestTemplateInvocationContext</a></code> を要素とする <code>Stream</code> を提供しなければなりません。
それぞれの要素には、独自の表示名や、直後の <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/TestTemplate.html">@TestTemplate</a></code> メソッドを呼び出すときにだけ使用する拡張機能のリストが含まれています。</p>
</div>
<div class="paragraph">
<p>次のコード例では、テストテンプレートの書き方と、<code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/TestTemplateInvocationContextProvider.html">TestTemplateInvocationContextProvider</a></code> の実装方法を説明しています。</p>
</div>
<div class="listingblock">
<div class="title">自作の拡張機能とテストテンプレート</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">fruits</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span> <span class="s">"banana"</span><span class="o">,</span> <span class="s">"lemon"</span><span class="o">);</span>

<span class="nd">@TestTemplate</span>
<span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">MyTestTemplateInvocationContextProvider</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testTemplate</span><span class="o">(</span><span class="nc">String</span> <span class="n">fruit</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertTrue</span><span class="o">(</span><span class="n">fruits</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">fruit</span><span class="o">));</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyTestTemplateInvocationContextProvider</span>
        <span class="kd">implements</span> <span class="nc">TestTemplateInvocationContextProvider</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supportsTestTemplate</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">TestTemplateInvocationContext</span><span class="o">&gt;</span> <span class="nf">provideTestTemplateInvocationContexts</span><span class="o">(</span>
            <span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>

        <span class="k">return</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">invocationContext</span><span class="o">(</span><span class="s">"apple"</span><span class="o">),</span> <span class="n">invocationContext</span><span class="o">(</span><span class="s">"banana"</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="nc">TestTemplateInvocationContext</span> <span class="nf">invocationContext</span><span class="o">(</span><span class="nc">String</span> <span class="n">parameter</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">TestTemplateInvocationContext</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getDisplayName</span><span class="o">(</span><span class="kt">int</span> <span class="n">invocationIndex</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">parameter</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Extension</span><span class="o">&gt;</span> <span class="nf">getAdditionalExtensions</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="nc">Collections</span><span class="o">.</span><span class="na">singletonList</span><span class="o">(</span><span class="k">new</span> <span class="nc">ParameterResolver</span><span class="o">()</span> <span class="o">{</span>
                    <span class="nd">@Override</span>
                    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supportsParameter</span><span class="o">(</span><span class="nc">ParameterContext</span> <span class="n">parameterContext</span><span class="o">,</span>
                            <span class="nc">ExtensionContext</span> <span class="n">extensionContext</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">return</span> <span class="n">parameterContext</span><span class="o">.</span><span class="na">getParameter</span><span class="o">().</span><span class="na">getType</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
                    <span class="o">}</span>

                    <span class="nd">@Override</span>
                    <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">resolveParameter</span><span class="o">(</span><span class="nc">ParameterContext</span> <span class="n">parameterContext</span><span class="o">,</span>
                            <span class="nc">ExtensionContext</span> <span class="n">extensionContext</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">return</span> <span class="n">parameter</span><span class="o">;</span>
                    <span class="o">}</span>
                <span class="o">});</span>
            <span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>前のコード例では、テストテンプレートは2回呼び出されるはずです。
それぞれの呼び出しについて、呼び出しコンテキストに指定された表示名は <code>apple</code> と <code>banana</code> になります。
また、メソッド引数を解決する独自の <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/ParameterResolver.html">ParameterResolver</a></code> も登録されています。
<code>ConsoleLauncher</code> でテストを実行すると、次のように出力されるでしょう。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>└─ testTemplate(String) ✔
   ├─ apple ✔
   └─ banana ✔</pre>
</div>
</div>
<div class="paragraph">
<p><code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/TestTemplateInvocationContextProvider.html">TestTemplateInvocationContextProvider</a></code> API の主な目的は、さまざまなコンテキストで呼び出されるメソッドのように、繰り返し呼び出されることが前提の普通とは異なるテストを実現することです。
例えば、毎回違うパラメータで実行したり、テストクラスのインスタンスの状態を毎回変化させたり、状態を変化させずに何度も実行するなどです。
この API で実現されてる <a href="#writing-tests-repeated-tests">繰り返しテスト</a> や <a href="#writing-tests-parameterized-tests">パラメタライズテスト</a> についても参照してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="extensions-keeping-state"><a class="anchor" href="#extensions-keeping-state"></a>5.13. 拡張機能の状態を保存する</h3>
<div class="paragraph">
<p>普通なら拡張機能をインスタンス化するのは1度だけです。
だから「拡張機能が前に呼び出されたときの状態を残すにはどうしたらいいのか」という疑問が生じるのは当然です。
<code>ExtensionContext</code> API の <code>Store</code> インターフェイスはそのために使用します。
拡張機能が後から参照する値を登録するための API なのです。
メソッドレベルのスコープで <code>Store</code> を使用する具体例として <code><a href="#extensions-lifecycle-callbacks-timing-extension">TimingExtension</a></code> を見てください。
テストメソッドを実行しているときに <code>ExtensionContext</code> へ登録した値は、周辺の <code>ExtensionContext</code> からは参照できないことに注意してください。
<code>ExtensionContext</code> は入れ子構造にできるのですが、内側の可視性は制限されているのです。
値を登録したり参照したりするためのメソッドについては <code><a href="../api/org.junit.jupiter.api/org/junit/jupiter/api/extension/ExtensionContext.Store.html">Store</a></code> の Javadoc を参照してください。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title"><code>ExtensionContext.Store.CloseableResource</code></div>
拡張機能用コンテキストストアは、その拡張機能のコンテキストのライフサイクルに束縛されています。
その拡張機能のライフサイクルが終了になれば、結びつけられたストアも閉じられるのです。
登録したあらゆる <code>CloseableResource</code> のインスタンスに対して、登録した順序の逆順に <code>close()</code> メソッドを呼び出していきます。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="extensions-supported-utilities"><a class="anchor" href="#extensions-supported-utilities"></a>5.14. 拡張機能で利用できるユーティリティ</h3>
<div class="paragraph">
<p><code>junit-platform-commons</code> アーティファクトの提供する <code><a href="../api/org.junit.platform.commons/org/junit/platform/commons/support/package-summary.html">org.junit.platform.commons.support</a></code> パッケージには、アノテーションやクラスやリフレクションに関連する操作や、クラスパスを探索する機能に関する、<em>保守されている</em> 便利メソッドが含まれています。
テスト実行エンジンや拡張機能の作者は、JUnit Platform と一貫性のある操作を利用できるのです。</p>
</div>
<div class="sect3">
<h4 id="extensions-supported-utilities-annotations"><a class="anchor" href="#extensions-supported-utilities-annotations"></a>5.14.1. アノテーション</h4>
<div class="paragraph">
<p><code>AnnotationSupport</code> は、アノテーションで修飾できる要素（パッケージ、アノテーション、クラス、インターフェイス、コンストラクタ、メソッド、フィールド）を操作する便利メソッドを提供します（<code>static</code> メソッドです）。
アノテーションで修飾されているか、任意のアノテーションでメタアノテーションされているか、特定のアノテーションの探索、アノテーションで修飾されたメソッド、フィールド、クラス、インターフェイスの探索など。
クラスの実装したインターフェイスや、クラス階層を渡り歩いてアノテーションを探索するメソッドもあります。
詳しくは <code><a href="../api/org.junit.platform.commons/org/junit/platform/commons/support/AnnotationSupport.html">AnnotationSupport</a></code> の Javadoc を参照してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="extensions-supported-utilities-classes"><a class="anchor" href="#extensions-supported-utilities-classes"></a>5.14.2. クラス</h4>
<div class="paragraph">
<p><code>ClassSupport</code> は、クラス（<code>java.lang.Class</code> のインスタンスなど）を操作する便利メソッドを提供します（<code>static</code> メソッドです）。
詳しくは <code><a href="../api/org.junit.platform.commons/org/junit/platform/commons/support/ClassSupport.html">ClassSupport</a></code> の Javadoc を参照してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="extensions-supported-utilities-reflection"><a class="anchor" href="#extensions-supported-utilities-reflection"></a>5.14.3. リフレクション</h4>
<div class="paragraph">
<p><code>ReflectionSupport</code> は JDK の標準ライブラリが提供するリフレクション API やクラスロードの仕組みを拡張する便利メソッドを提供します（<code>static</code> メソッドです）。
クラスパスから任意の述語式にマッチするクラスを探索する、指定したクラスをロードして新しいインスタンスを作成する、メソッドを探索して実行する（クラス階層を渡り歩くなど）、など。
詳しくは <code><a href="../api/org.junit.platform.commons/org/junit/platform/commons/support/ReflectionSupport.html">ReflectionSupport</a></code> の Javadoc を参照してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="extensions-supported-utilities-modifier"><a class="anchor" href="#extensions-supported-utilities-modifier"></a>5.14.4. 修飾子（Modifier）</h4>
<div class="paragraph">
<p><code>ModifierSupport</code> はクラスのメンバーやクラス自体の修飾子を操作する便利メソッドを提供します。
メンバーの可視性が <code>public/private/abstract/static</code> のどれなのか、など。
詳しくは <code><a href="../api/org.junit.platform.commons/org/junit/platform/commons/support/ModifierSupport.html">ModifierSupport</a></code> の Javadoc を参照してください。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extensions-execution-order"><a class="anchor" href="#extensions-execution-order"></a>5.15. ユーザーコードと拡張機能の相対的な実行順序</h3>
<div class="paragraph">
<p>1つ以上のテストメソッドを持つテストクラスを実行するとき、ユーザーの記述したテストとライフサイクルメソッドに加えて、いくつもの拡張機能（コールバック）が呼び出されることになります。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="#writing-tests-test-execution-order">テストの実行順序</a> も参照してください。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="extensions-execution-order-overview"><a class="anchor" href="#extensions-execution-order-overview"></a>5.15.1. ユーザーコードと拡張機能の順序関係</h4>
<div class="paragraph">
<p>次の図はユーザーコードと拡張機能の相対的な順序を示しています。
ユーザーの記述したテストとライフサイクルメソッドはオレンジ色、拡張機能が実装したコールバックは青色です。
灰色は1つのテストメソッドを実行するとき、および、全てのテストメソッドについて繰り返し実行するときの範囲を示しています。</p>
</div>
<div id="extensions-execution-order-diagram" class="imageblock">
<div class="content">
<img src="images/extensions_lifecycle.png" alt="extensions lifecycle">
</div>
<div class="title">ユーザーコードと拡張機能の順序関係</div>
</div>
<div class="paragraph">
<p>次の表は <a href="#extensions-execution-order-diagram">ユーザーコードと拡張機能の順序関係</a> を実行する16の手順を詳しく記述したものです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 5%;">
<col style="width: 15%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">手順</th>
<th class="tableblock halign-left valign-top">インターフェイス／アノテーション</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">インターフェイス <code>org.junit.jupiter.api.extension.BeforeAllCallback</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">拡張機能：テストコンテナのあらゆるテストメソッドより先に実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">アノテーション <code>org.junit.jupiter.api.BeforeAll</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ユーザーコード：テストコンテナのあらゆるテストメソッドより先に実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">インターフェイス <code>org.junit.jupiter.api.extension.LifecycleMethodExecutionExceptionHandler
#handleBeforeAllMethodExecutionException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">拡張機能：<code>@BeforeAll</code> メソッドがスローした例外を処理する例外処理ハンドラーを実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">インターフェイス <code>org.junit.jupiter.api.extension.BeforeEachCallback</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">拡張機能：テストコンテナのそれぞれのテストメソッドを実行する前に実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">アノテーション <code>org.junit.jupiter.api.BeforeEach</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ユーザーコード：テストコンテナのそれぞれのテストメソッドを実行する前に実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">インターフェイス <code>org.junit.jupiter.api.extension.LifecycleMethodExecutionExceptionHandler
#handleBeforeEachMethodExecutionException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">拡張機能：<code>@BeforeEach</code> メソッドがスローした例外を処理する例外処理ハンドラーを実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">インターフェイス <code>org.junit.jupiter.api.extension.BeforeTestExecutionCallback</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">拡張機能：テストコンテナのそれぞれのテストメソッドを実行する直前に実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">アノテーション <code>org.junit.jupiter.api.Test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ユーザーコード：テストコンテナのそれぞれのテストメソッドを実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">インターフェイス <code>org.junit.jupiter.api.extension.TestExecutionExceptionHandler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">拡張機能：テストメソッドがスローした例外を処理する例外処理ハンドラーを実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">インターフェイス <code>org.junit.jupiter.api.extension.AfterTestExecutionCallback</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">拡張機能：テストコンテナのそれぞれのテストメソッドを実行した直後、あるいは、例外処理ハンドラーを実行した直後に実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">アノテーション <code>org.junit.jupiter.api.AfterEach</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ユーザーコード：テストコンテナのそれぞれのテストメソッドを実行した後に実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">インターフェイス <code>org.junit.jupiter.api.extension.LifecycleMethodExecutionExceptionHandler
#handleAfterEachMethodExecutionException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">拡張機能：<code>@AfterEach</code> メソッドがスローした例外を処理する例外処理ハンドラーを実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">インターフェイス <code>org.junit.jupiter.api.extension.AfterEachCallback</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">拡張機能：テストコンテナのそれぞれのテストメソッドより後に実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">アノテーション <code>org.junit.jupiter.api.AfterAll</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ユーザーコード：テストコンテナの全てのテストメソッドより後に実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">インターフェイス <code>org.junit.jupiter.api.extension.LifecycleMethodExecutionExceptionHandler
#handleAfterAllMethodExecutionException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">拡張機能：<code>@AfterAll</code> メソッドがスローした例外を処理する例外処理ハンドラーを実行する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">インターフェイス <code>org.junit.jupiter.api.extension.AfterAllCallback</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">拡張機能：テストコンテナの全てのテストメソッドより後に実行する</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>単純な場合はテストメソッドを実行するだけでしょう（手順8）。
他の手順を実行するかどうかは、ユーザーコードや拡張機能が、対応するライフサイクルメソッドを提供しているかどうかによって決まります。
ライフサイクルメソッドのコールバックについては、対応するインターフェイスや拡張機能の Javadoc を参照してください。</p>
</div>
<div class="paragraph">
<p>全てのユーザーコード（メソッド）の呼び出しは、<a href="#extensions-intercepting-invocations"><code>InvocationInterceptor</code></a> で割り込み可能です。</p>
</div>
</div>
<div class="sect3">
<h4 id="extensions-execution-order-wrapping-behavior"><a class="anchor" href="#extensions-execution-order-wrapping-behavior"></a>5.15.2. コールバックによる包み隠す振る舞い</h4>
<div class="paragraph">
<p>JUnit Jupiter は、複数のライフサイクルコールバック（<code>BeforeAllCallback, AfterAllCallback, BeforeEachCallback, AfterEachCallback, BeforeTestExecutionCallback, AfterTestExecutionCallback</code>）を登録した場合、それぞれの呼び出しを <em>包み隠す</em> ことを保証します。</p>
</div>
<div class="paragraph">
<p>例えば、<code>Extension1</code> と <code>Extension2</code> を順番に登録した場合、<code>Extension1</code> の提供する全ての "before" コールバックは、<code>Extension2</code> の提供する全ての "before" コールバックより <strong>先に</strong> 実行することが保証されています。
同様に、<code>Extension1</code> の提供する全ての "after" コールバックは、<code>Extension2</code> の提供する全ての "after" コールバックより <strong>後に</strong> 実行することが保証されています。
この関係を「<code>Extension1</code> は <code>Extension2</code> を <em>包み隠す</em>」と呼んでいます。</p>
</div>
<div class="paragraph">
<p>ユーザーコードの提供する <em>ライフサイクルメソッド</em> （<a href="#writing-tests-classes-and-methods">テストクラスとテストメソッド</a> を参照）は、クラス階層やインターフェイス階層についても <em>包み隠す</em> 関係になることが保証されています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>基底クラスから継承した <code>@BeforeAll</code> メソッドは <em>隠蔽</em> も <em>オーバーライド</em> もできません。
さらに、派生クラスの <code>@BeforeAll</code> メソッドより <strong>先に</strong> 実行します。</p>
<div class="ulist">
<ul>
<li>
<p>同様に、インターフェイスから継承した <code>@BeforeAll</code> メソッドは <em>隠蔽</em> も <em>オーバーライド</em> もできません。
そして、実装クラスの <code>@BeforeAll</code> メソッドより <strong>先に</strong> 実行します。</p>
</li>
</ul>
</div>
</li>
<li>
<p>基底クラスから継承した <code>@AfterAll</code> メソッドは <em>隠蔽</em> も <em>オーバーライド</em> もできません。
さらに、派生クラスの <code>@AfterAll</code> メソッドより <strong>後に</strong> 実行します。</p>
<div class="ulist">
<ul>
<li>
<p>同様に、インターフェイスから継承した <code>@AfterAll</code> メソッドは <em>隠蔽</em> も <em>オーバーライド</em> もできません。
そして、実装クラスの <code>@AfterAll</code> メソッドより <strong>後に</strong> 実行します。</p>
</li>
</ul>
</div>
</li>
<li>
<p>基底クラスから継承した <code>@BeforeEach</code> メソッドは <em>オーバーライド</em> できません。
さらに、派生クラスの <code>@BeforeEach</code> メソッドより <strong>先に</strong> 実行します。</p>
<div class="ulist">
<ul>
<li>
<p>同様に、インターフェイスから継承した <code>@BeforeEach</code> メソッドは <em>オーバーライド</em> できません。
そして、実装クラスの <code>@BeforeEach</code> メソッドより <strong>先に</strong> 実行します。</p>
</li>
</ul>
</div>
</li>
<li>
<p>基底クラスから継承した <code>@AfterEach</code> メソッドは <em>オーバーライド</em> できません。
さらに、派生クラスの <code>@AfterEach</code> メソッドより <strong>後に</strong> 実行します。</p>
<div class="ulist">
<ul>
<li>
<p>同様に、インターフェイスから継承した <code>@AfterEach</code> メソッドは <em>オーバーライド</em> できません。
そして、実装クラスの <code>@AfterEach</code> メソッドより <strong>後に</strong> 実行します。</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>次のコード例はここまでに説明した振る舞いを示しています。
具体的になんらかの処理するようにはなっていませんが、テストがデータベースとやりとりする一般的なシナリオを再現しています。
<code>Logger</code> クラスから <code>static</code> インポートしているメソッドは、実行時の情報をログに出力するようになっているため、ユーザーコードと拡張機能のどちらで実装しているコールバックなのか分かりやすくなっています。</p>
</div>
<div class="listingblock">
<div class="title">Extension1</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">afterEachCallback</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">beforeEachCallback</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.AfterEachCallback</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.BeforeEachCallback</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.ExtensionContext</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Extension1</span> <span class="kd">implements</span> <span class="nc">BeforeEachCallback</span><span class="o">,</span> <span class="nc">AfterEachCallback</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeEach</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">beforeEachCallback</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterEach</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">afterEachCallback</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Extension2</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">afterEachCallback</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">beforeEachCallback</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.AfterEachCallback</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.BeforeEachCallback</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.ExtensionContext</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Extension2</span> <span class="kd">implements</span> <span class="nc">BeforeEachCallback</span><span class="o">,</span> <span class="nc">AfterEachCallback</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeEach</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">beforeEachCallback</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterEach</span><span class="o">(</span><span class="nc">ExtensionContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">afterEachCallback</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">AbstractDatabaseTests</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">afterAllMethod</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">afterEachMethod</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">beforeAllMethod</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">beforeEachMethod</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.AfterAll</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.AfterEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeAll</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="o">;</span>

<span class="cm">/**
 * Abstract base class for tests that use the database.
 */</span>
<span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AbstractDatabaseTests</span> <span class="o">{</span>

    <span class="nd">@BeforeAll</span>
    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">createDatabase</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">beforeAllMethod</span><span class="o">(</span><span class="nc">AbstractDatabaseTests</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".createDatabase()"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@BeforeEach</span>
    <span class="kt">void</span> <span class="nf">connectToDatabase</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">beforeEachMethod</span><span class="o">(</span><span class="nc">AbstractDatabaseTests</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".connectToDatabase()"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@AfterEach</span>
    <span class="kt">void</span> <span class="nf">disconnectFromDatabase</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">afterEachMethod</span><span class="o">(</span><span class="nc">AbstractDatabaseTests</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".disconnectFromDatabase()"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@AfterAll</span>
    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">destroyDatabase</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">afterAllMethod</span><span class="o">(</span><span class="nc">AbstractDatabaseTests</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".destroyDatabase()"</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">DatabaseTestsDemo</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">afterEachMethod</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">beforeAllMethod</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">beforeEachMethod</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">testMethod</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.AfterAll</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.AfterEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeAll</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.ExtendWith</span><span class="o">;</span>

<span class="cm">/**
 * Extension of {@link AbstractDatabaseTests} that inserts test data
 * into the database (after the database connection has been opened)
 * and deletes test data (before the database connection is closed).
 */</span>
<span class="nd">@ExtendWith</span><span class="o">({</span> <span class="nc">Extension1</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Extension2</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
<span class="kd">class</span> <span class="nc">DatabaseTestsDemo</span> <span class="kd">extends</span> <span class="nc">AbstractDatabaseTests</span> <span class="o">{</span>

    <span class="nd">@BeforeAll</span>
    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">beforeAll</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">beforeAllMethod</span><span class="o">(</span><span class="nc">DatabaseTestsDemo</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".beforeAll()"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@BeforeEach</span>
    <span class="kt">void</span> <span class="nf">insertTestDataIntoDatabase</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">beforeEachMethod</span><span class="o">(</span><span class="n">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".insertTestDataIntoDatabase()"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testDatabaseFunctionality</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">testMethod</span><span class="o">(</span><span class="n">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".testDatabaseFunctionality()"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@AfterEach</span>
    <span class="kt">void</span> <span class="nf">deleteTestDataFromDatabase</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">afterEachMethod</span><span class="o">(</span><span class="n">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".deleteTestDataFromDatabase()"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@AfterAll</span>
    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">afterAll</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">beforeAllMethod</span><span class="o">(</span><span class="nc">DatabaseTestsDemo</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".afterAll()"</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>DatabaseTestsDemo</code> を実行すると、次のように出力されるでしょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@BeforeAll AbstractDatabaseTests.createDatabase()
@BeforeAll DatabaseTestsDemo.beforeAll()
  Extension1.beforeEach()
  Extension2.beforeEach()
    @BeforeEach AbstractDatabaseTests.connectToDatabase()
    @BeforeEach DatabaseTestsDemo.insertTestDataIntoDatabase()
      @Test DatabaseTestsDemo.testDatabaseFunctionality()
    @AfterEach DatabaseTestsDemo.deleteTestDataFromDatabase()
    @AfterEach AbstractDatabaseTests.disconnectFromDatabase()
  Extension2.afterEach()
  Extension1.afterEach()
@BeforeAll DatabaseTestsDemo.afterAll()
@AfterAll AbstractDatabaseTests.destroyDatabase()</pre>
</div>
</div>
<div class="paragraph">
<p>次のシーケンス図は <code>DatabaseTestDemo</code> を実行したとき、<code>JupiterTestEngine</code> の内部で行われている処理を（大部分省略して）示したものです。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/extensions_DatabaseTestsDemo.png" alt="extensions DatabaseTestsDemo">
</div>
<div class="title">DatabaseTestsDemo</div>
</div>
<div class="paragraph">
<p>JUnit Jupiter では <em>単独の</em> クラスやインターフェイスに宣言された複数のライフサイクルメソッドの実行順序を保証 <strong>しません</strong>。
一見するとアルファベット順に見えるかもしれませんが、正確にはそうではありません。
<code>@Test</code> メソッドの実行順序と同じようになっているのです。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><em>単独の</em> クラスやインターフェイスに宣言した複数のライフサイクルメソッドの実行順序は、意図的に分かりにくくした決定論的アルゴリズムによって決まります。
したがって、再びテストスイートを実行しても、同じ登録順になることが保証されています。再現可能なビルド（プロセス）を保証するためです。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>さらに、<em>単独の</em> クラスやインターフェイスに宣言した複数のライフサイクルメソッドが <em>包み隠す</em> 関係になることを保証 <strong>しません</strong>。</p>
</div>
<div class="paragraph">
<p>次のコード例は、テストクラスに定義したライフサイクルメソッドの（間違った）実行順序に依存しているせいでいろいろ <em>壊れています</em>。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>データベース接続を <code>open()</code> する <em>前に</em> テストデータを <code>insert</code> しています。おそらくデータベース接続エラーが発生するでしょう。</p>
</li>
<li>
<p>テストデータを <code>delete</code> する <em>前に</em> データベース接続を <code>close()</code> しています。おそらくデータベース接続エラーが発生するでしょう。</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">BrokenLifecycleMethodConfigDemo</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">afterEachMethod</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">beforeEachMethod</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">example</span><span class="o">.</span><span class="na">callbacks</span><span class="o">.</span><span class="na">Logger</span><span class="o">.</span><span class="na">testMethod</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.AfterEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.ExtendWith</span><span class="o">;</span>

<span class="cm">/**
 * Example of "broken" lifecycle method configuration.
 *
 * &lt;p&gt;Test data is inserted before the database connection has been opened.
 *
 * &lt;p&gt;Database connection is closed before deleting test data.
 */</span>
<span class="nd">@ExtendWith</span><span class="o">({</span> <span class="nc">Extension1</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Extension2</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
<span class="kd">class</span> <span class="nc">BrokenLifecycleMethodConfigDemo</span> <span class="o">{</span>

    <span class="nd">@BeforeEach</span>
    <span class="kt">void</span> <span class="nf">connectToDatabase</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">beforeEachMethod</span><span class="o">(</span><span class="n">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".connectToDatabase()"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@BeforeEach</span>
    <span class="kt">void</span> <span class="nf">insertTestDataIntoDatabase</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">beforeEachMethod</span><span class="o">(</span><span class="n">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".insertTestDataIntoDatabase()"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testDatabaseFunctionality</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">testMethod</span><span class="o">(</span><span class="n">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".testDatabaseFunctionality()"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@AfterEach</span>
    <span class="kt">void</span> <span class="nf">deleteTestDataFromDatabase</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">afterEachMethod</span><span class="o">(</span><span class="n">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".deleteTestDataFromDatabase()"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@AfterEach</span>
    <span class="kt">void</span> <span class="nf">disconnectFromDatabase</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">afterEachMethod</span><span class="o">(</span><span class="n">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">".disconnectFromDatabase()"</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>BrokenLifecycleMethodConfigDemo</code> を実行すると、次のように出力されるでしょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Extension1.beforeEach()
Extension2.beforeEach()
  @BeforeEach BrokenLifecycleMethodConfigDemo.insertTestDataIntoDatabase()
  @BeforeEach BrokenLifecycleMethodConfigDemo.connectToDatabase()
    @Test BrokenLifecycleMethodConfigDemo.testDatabaseFunctionality()
  @AfterEach BrokenLifecycleMethodConfigDemo.disconnectFromDatabase()
  @AfterEach BrokenLifecycleMethodConfigDemo.deleteTestDataFromDatabase()
Extension2.afterEach()
Extension1.afterEach()</pre>
</div>
</div>
<div class="paragraph">
<p>次のシーケンス図は <code>BrokenLifecycleMethodConfigDemo</code> を実行したとき、<code>JupiterTestEngine</code> の内部で行われている処理を（大部分省略して）示したものです。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/extensions_BrokenLifecycleMethodConfigDemo.png" alt="extensions BrokenLifecycleMethodConfigDemo">
</div>
<div class="title">BrokenLifecycleMethodConfigDemo</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>このセクションで説明した振る舞いが前提になるため、JUnit チームとしては、テストクラスやテストインターフェイスに定義するライフサイクルメソッド（<a href="#writing-tests-classes-and-methods">テストクラスとテストメソッド</a> を参照）は、それぞれの種類ごとに1つだけ定義するようにして、お互いに依存しないようにすることをお勧めします。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="advanced-topics"><a class="anchor" href="#advanced-topics"></a>6. 高度な使い方</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="launcher-api"><a class="anchor" href="#launcher-api"></a>6.1. JUnit Platform Launcher API</h3>
<div class="paragraph">
<p>JUnit 5 の特徴的な目標の1つとして、ビルドツールや IDE などのプログラムから JUnit を操作する強力かつ安定したインターフェイスを提供することが挙げられます。
目的は、テストを探索したり実行したりする内部動作と、外部から指定するテストをふるい落とす条件やその他の設定を完全に分離することです。</p>
</div>
<div class="paragraph">
<p>JUnit 5 では <code>Launcher</code> という考え方を導入しました。
テストを探索し、選抜し、実行する要素です。
さらに、専用の <code><a href="../api/org.junit.platform.engine/org/junit/platform/engine/TestEngine.html">TestEngine</a></code> を使用すれば、Spock や Cucumber や FitNesse のようなサードパーティライブラリを JUnit Platform で実行できます。</p>
</div>
<div class="paragraph">
<p>Launcher API は <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/package-summary.html">junit-platform-launcher</a></code> モジュールに含まれています。</p>
</div>
<div class="paragraph">
<p>実際に Launcher API を使用している好例は <code><a href="../api/org.junit.platform.console/org/junit/platform/console/package-summary.html">junit-platform-console</a></code> プロジェクトの <code><a href="../api/org.junit.platform.console/org/junit/platform/console/ConsoleLauncher.html">ConsoleLauncher</a></code> です。</p>
</div>
<div class="sect3">
<h4 id="launcher-api-discovery"><a class="anchor" href="#launcher-api-discovery"></a>6.1.1. テストの発見</h4>
<div class="paragraph">
<p><em>テストの発見</em> を JUnit Platform から独立した機能にすることで、旧バージョンの JUnit によるテストクラスやテストメソッドの特定に悩まされてきたビルドツールや IDE は楽になったはずです。</p>
</div>
<div class="paragraph">
<p>使い方。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">discovery</span><span class="o">.</span><span class="na">ClassNameFilter</span><span class="o">.</span><span class="na">includeClassNamePatterns</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">discovery</span><span class="o">.</span><span class="na">DiscoverySelectors</span><span class="o">.</span><span class="na">selectClass</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">discovery</span><span class="o">.</span><span class="na">DiscoverySelectors</span><span class="o">.</span><span class="na">selectPackage</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.PrintWriter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Path</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.platform.engine.FilterResult</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.engine.TestDescriptor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.Launcher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.LauncherDiscoveryListener</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.LauncherDiscoveryRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.LauncherSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.LauncherSessionListener</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.PostDiscoveryFilter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.TestExecutionListener</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.TestPlan</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.core.LauncherConfig</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.core.LauncherDiscoveryRequestBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.core.LauncherFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.listeners.SummaryGeneratingListener</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.listeners.TestExecutionSummary</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.reporting.legacy.xml.LegacyXmlReportGeneratingListener</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">LauncherDiscoveryRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="nc">LauncherDiscoveryRequestBuilder</span><span class="o">.</span><span class="na">request</span><span class="o">()</span>
    <span class="o">.</span><span class="na">selectors</span><span class="o">(</span>
        <span class="n">selectPackage</span><span class="o">(</span><span class="s">"com.example.mytests"</span><span class="o">),</span>
        <span class="n">selectClass</span><span class="o">(</span><span class="nc">MyTestClass</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="o">)</span>
    <span class="o">.</span><span class="na">filters</span><span class="o">(</span>
        <span class="n">includeClassNamePatterns</span><span class="o">(</span><span class="s">".*Tests"</span><span class="o">)</span>
    <span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="k">try</span> <span class="o">(</span><span class="nc">LauncherSession</span> <span class="n">session</span> <span class="o">=</span> <span class="nc">LauncherFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">())</span> <span class="o">{</span>
    <span class="nc">TestPlan</span> <span class="n">testPlan</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getLauncher</span><span class="o">().</span><span class="na">discover</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>

    <span class="c1">// ... discover additional test plans or execute tests</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>クラスやメソッドを選択したり、パッケージの全てのクラスを選択したり、クラスパスやモジュールパスから全てのテストクラスを検索したりできるのです。
テストの発見は、存在する全てのテスト実行エンジンが行います。</p>
</div>
<div class="paragraph">
<p>発見した結果は、読み取り専用で階層的な木構造構造のテスト計画（<code>TestPlan</code>）になります。
データ構造の要素は <code>LauncherDiscoveryRequest</code> に適合したテスト実行エンジン、テストクラス、テストメソッドです。
API のクライアントは木を行き来して節を特定し、詳細情報を取得し、取得元（クラスやメソッド、ファイル中の位置など）の情報を取得します。
テスト計画に含まれる全ての節には <em>固有のID</em> が割り当てられており、一部のテストやテストのグループを実行するために使用できます。</p>
</div>
<div class="paragraph">
<p>テストを発見している途中に発生したイベントから何らかの洞察を得るため、API のクライアントは1つ以上の <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/LauncherDiscoveryListener.html">LauncherDiscoveryListener</a></code> を登録できます（<code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/core/LauncherDiscoveryRequestBuilder.html">LauncherDiscoveryRequestBuilder</a></code> でインスタンスを作成します）。
初期設定では <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/core/LauncherDiscoveryRequestBuilder.html">LauncherDiscoveryRequestBuilder</a></code> が「中断および失敗」リスナーを登録します。
テストの発見に失敗したら、ただちに発見処理全体を中断するためです。
設定パラメータの <code>junit.platform.discovery.listener.default</code> に完全修飾クラス名を指定すれば変更できます。</p>
</div>
</div>
<div class="sect3">
<h4 id="launcher-api-execution"><a class="anchor" href="#launcher-api-execution"></a>6.1.2. テストの実行</h4>
<div class="paragraph">
<p>テストを実行するには発見フェーズと同じ <code>LauncherDiscoveryRequest</code> を使用するか、新しい要求を作成して使用します。
進行状況や結果を報告するには1つ以上の <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/TestExecutionListener.html">TestExecutionListener</a></code> を登録します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">LauncherDiscoveryRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="nc">LauncherDiscoveryRequestBuilder</span><span class="o">.</span><span class="na">request</span><span class="o">()</span>
    <span class="o">.</span><span class="na">selectors</span><span class="o">(</span>
        <span class="n">selectPackage</span><span class="o">(</span><span class="s">"com.example.mytests"</span><span class="o">),</span>
        <span class="n">selectClass</span><span class="o">(</span><span class="nc">MyTestClass</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="o">)</span>
    <span class="o">.</span><span class="na">filters</span><span class="o">(</span>
        <span class="n">includeClassNamePatterns</span><span class="o">(</span><span class="s">".*Tests"</span><span class="o">)</span>
    <span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="nc">SummaryGeneratingListener</span> <span class="n">listener</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SummaryGeneratingListener</span><span class="o">();</span>

<span class="k">try</span> <span class="o">(</span><span class="nc">LauncherSession</span> <span class="n">session</span> <span class="o">=</span> <span class="nc">LauncherFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">())</span> <span class="o">{</span>
    <span class="nc">Launcher</span> <span class="n">launcher</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getLauncher</span><span class="o">();</span>
    <span class="c1">// Register a listener of your choice</span>
    <span class="n">launcher</span><span class="o">.</span><span class="na">registerTestExecutionListeners</span><span class="o">(</span><span class="n">listener</span><span class="o">);</span>
    <span class="c1">// Discover tests and build a test plan</span>
    <span class="nc">TestPlan</span> <span class="n">testPlan</span> <span class="o">=</span> <span class="n">launcher</span><span class="o">.</span><span class="na">discover</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
    <span class="c1">// Execute test plan</span>
    <span class="n">launcher</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">testPlan</span><span class="o">);</span>
    <span class="c1">// Alternatively, execute the request directly</span>
    <span class="n">launcher</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
<span class="o">}</span>

<span class="nc">TestExecutionSummary</span> <span class="n">summary</span> <span class="o">=</span> <span class="n">listener</span><span class="o">.</span><span class="na">getSummary</span><span class="o">();</span>
<span class="c1">// Do something with the summary...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>execute()</code> メソッドには返り値がありません。
代わりに <code>TestExecutionListener</code> でテストの結果を集約できるようになっています。
具体的には <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/listeners/SummaryGeneratingListener.html">SummaryGeneratingListener</a></code> や <code><a href="../api/org.junit.platform.reporting/org/junit/platform/reporting/legacy/xml/LegacyXmlReportGeneratingListener.html">LegacyXmlReportGeneratingListener</a></code> や
<code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/listeners/UniqueIdTrackingListener.html">UniqueIdTrackingListener</a></code> のソースコードを参照してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="launcher-api-engines-custom"><a class="anchor" href="#launcher-api-engines-custom"></a>6.1.3. テスト実行エンジンの登録</h4>
<div class="paragraph">
<p>JUnit は3種類の <code><a href="../api/org.junit.platform.engine/org/junit/platform/engine/TestEngine.html">TestEngine</a></code> の実装クラスを提供しています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="../api/org.junit.jupiter.engine/org/junit/jupiter/engine/package-summary.html">junit-jupiter-engine</a></code>: JUnit Jupiter の基本となるエンジンです</p>
</li>
<li>
<p><code><a href="../api/org.junit.vintage.engine/org/junit/vintage/engine/package-summary.html">junit-vintage-engine</a></code>: <em>骨董品</em> のようなテストを JUnit Platform で実行するための、JUnit 4 を薄いレイヤーで包み込んだエンジンです</p>
</li>
<li>
<p><code><a href="../api/org.junit.platform.suite.engine/org/junit/platform/suite/engine/package-summary.html">junit-platform-suite-engine</a></code>: JUnit Platform で宣言的に構成したテストスイートを実行するエンジンです</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>サードパーティライブラリの作者は <code><a href="../api/org.junit.platform.engine/org/junit/platform/engine/package-summary.html">junit-platform-engine</a></code> モジュールの <code>TestEngine</code> インターフェイスの実装クラスを提供し、<em>登録</em> させることができます。
テスト実行エンジンは Java の <code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/ServiceLoader.html">ServiceLoader</a></code> で登録します。
例えば、<code>junit-jupiter-engine</code> モジュールは <code>org.junit.jupiter.engine.JupiterTestEngine</code> を登録するのですが、それは jar ファイルの <code>/META-INF/services/org.junit.platform.engine.TestEngine</code> に <code>org.junit.jupiter.engine.JupiterTestEngine</code> と記述されているからです。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code><a href="../api/org.junit.platform.engine/org/junit/platform/engine/support/hierarchical/HierarchicalTestEngine.html">HierarchicalTestEngine</a></code> を抽象基底クラスとして使用すると、テストを発見するロジックだけを実装すれば済むので便利です（<code><a href="../api/org.junit.jupiter.engine/org/junit/jupiter/engine/package-summary.html">junit-jupiter-engine</a></code> でも使用しています）。
<code><a href="../api/org.junit.platform.engine/org/junit/platform/engine/support/hierarchical/HierarchicalTestEngine.html">HierarchicalTestEngine</a></code> は <code>Node</code> インターフェイスを実装いた <code>TestDescriptors</code> を実装するようになっており、並列実行にも対応しています。
</td>
</tr>
</table>
</div>
<div id="launcher-api-engines-custom-ids" class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">接頭辞が <code>junit-</code> のテスト実行エンジン ID は JUnit チームのために予約済みです</div>
<div class="paragraph">
<p>Launcher API は JUnit チームの公開する <code>TestEngine</code> 実装の ID だけが <code>junit-</code> で始まることを強制します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>サードパーティライブラリのテストエンジンの報告する ID が <code>junit-jupiter</code> や <code>junit-vintage</code> なら、JUnit Platform が例外をスローし、テストの実行はただちに中断します。</p>
</li>
<li>
<p>サードパーティライブラリのテストエンジンの報告する ID が <code>junit-</code> から始まる場合、JUnit Platform は警告をログ出力します。将来のバージョンでは例外をスローさせるかもしれません。</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="launcher-api-post-discovery-filters-custom"><a class="anchor" href="#launcher-api-post-discovery-filters-custom"></a>6.1.4. テスト発見後処理フィルター（PostDiscoveryFilter） を登録する</h4>
<div class="paragraph">
<p>Lancher API へ渡す <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/LauncherDiscoveryRequest.html">LauncherDiscoveryRequest</a></code> にテスト発見後処理フィルターを設定するだけでなく、Java の <code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/ServiceLoader.html">ServiceLoader</a></code> を使用して <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/PostDiscoveryFilter.html">PostDiscoveryFilter</a></code> の実装クラスを発見し、自動的に Launcher へ登録できます。</p>
</div>
<div class="paragraph">
<p>例えば、<code>PostDiscoveryFilter</code> を実装した <code>example.CustomTagFilter</code> （の完全修飾クラス名）を <code>/META-INF/services/org.junit.platform.launcher.PostDiscoveryFilter</code> に記述しておけば、自動的に登録するのです。</p>
</div>
</div>
<div class="sect3">
<h4 id="launcher-api-launcher-session-listeners-custom"><a class="anchor" href="#launcher-api-launcher-session-listeners-custom"></a>6.1.5. セッションリスナー（LauncherSessionListener）を登録する</h4>
<div class="paragraph">
<p><code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/LauncherSessionListener.html">LauncherSessionListener</a></code> の実装クラスを登録すると、<code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/LauncherSession.html">LauncherSession</a></code> を開いたとき（<code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/Launcher.html">Launcher</a></code> が最初にテストを発見し、実行する前）や、閉じるとき（それ以上発見したり実行したりするテストが無くなったとき）に通知します。
<code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/core/LauncherFactory.html">LauncherFactory</a></code> へ渡す <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/core/LauncherConfig.html">LauncherConfig</a></code> で手続き的に登録することもできますし、Java の <code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/ServiceLoader.html">ServiceLoader</a></code> を使用して自動的に登録することもできます（自動登録機能が有効なら）。</p>
</div>
<div class="paragraph">
<p><code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/LauncherSessionListener.html">LauncherSessionListener</a></code> は JVM が1回だけ <code>setup</code> と <code>teardown</code> を実行する状況に最適化されています。
1つのセッションで最初のテストを発見する前と、最後のテストが終了した後に呼び出されるからです。
セッションの有効範囲は使用している IDE やビルドツールによって異なりますが、基本的にはテストを実行する JVM のライフサイクルと一致します。
次のコード例は、最初のテストを発見する前に HTTP サーバーを起動し、最後のテストが終了した後に HTTP サーバーを停止するリスナーです。</p>
</div>
<div class="listingblock">
<div class="title">src/test/java/example/session/GlobalSetupTeardownListener.java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">package</span> <span class="nn">example.session</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.UncheckedIOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.InetSocketAddress</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ExecutorService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Executors</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.sun.net.httpserver.HttpServer</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.LauncherSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.LauncherSessionListener</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.TestExecutionListener</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.launcher.TestPlan</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GlobalSetupTeardownListener</span> <span class="kd">implements</span> <span class="nc">LauncherSessionListener</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Fixture</span> <span class="n">fixture</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">launcherSessionOpened</span><span class="o">(</span><span class="nc">LauncherSession</span> <span class="n">session</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Avoid setup for test discovery by delaying it until tests are about to be executed</span>
        <span class="n">session</span><span class="o">.</span><span class="na">getLauncher</span><span class="o">().</span><span class="na">registerTestExecutionListeners</span><span class="o">(</span><span class="k">new</span> <span class="nc">TestExecutionListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testPlanExecutionStarted</span><span class="o">(</span><span class="nc">TestPlan</span> <span class="n">testPlan</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">fixture</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">fixture</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Fixture</span><span class="o">();</span>
                    <span class="n">fixture</span><span class="o">.</span><span class="na">setUp</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">});</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">launcherSessionClosed</span><span class="o">(</span><span class="nc">LauncherSession</span> <span class="n">session</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">fixture</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">fixture</span><span class="o">.</span><span class="na">tearDown</span><span class="o">();</span>
            <span class="n">fixture</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Fixture</span> <span class="o">{</span>

        <span class="kd">private</span> <span class="nc">HttpServer</span> <span class="n">server</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nc">ExecutorService</span> <span class="n">executorService</span><span class="o">;</span>

        <span class="kt">void</span> <span class="nf">setUp</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">server</span> <span class="o">=</span> <span class="nc">HttpServer</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="k">new</span> <span class="nc">InetSocketAddress</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span> <span class="mi">0</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">UncheckedIOException</span><span class="o">(</span><span class="s">"Failed to start HTTP server"</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="n">server</span><span class="o">.</span><span class="na">createContext</span><span class="o">(</span><span class="s">"/test"</span><span class="o">,</span> <span class="n">exchange</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="n">exchange</span><span class="o">.</span><span class="na">sendResponseHeaders</span><span class="o">(</span><span class="mi">204</span><span class="o">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">);</span>
                <span class="n">exchange</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">});</span>
            <span class="n">executorService</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newCachedThreadPool</span><span class="o">();</span>
            <span class="n">server</span><span class="o">.</span><span class="na">setExecutor</span><span class="o">(</span><span class="n">executorService</span><span class="o">);</span>
            <span class="n">server</span><span class="o">.</span><span class="na">start</span><span class="o">();</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="kt">int</span> <span class="n">port</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="na">getAddress</span><span class="o">().</span><span class="na">getPort</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">"http.server.port"</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">port</span><span class="o">));</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="o">}</span>

        <span class="kt">void</span> <span class="nf">tearDown</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">server</span><span class="o">.</span><span class="na">stop</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="n">executorService</span><span class="o">.</span><span class="na">shutdownNow</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>HTTP サーバーを起動します</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>テストから参照するための待ち受けポート番号を動的に決定し、システムプロパティへ設定します</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>HTTP サーバーを停止します</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>このサンプルコードでは JDK に付属している <code>jdk.httserver</code> モジュールの実装を使用していますが、他の実装でも同じように記述できるでしょう。
リスナーを自動的に JUnit Platform へ登録するには、次のようなリソースファイルをテストランタイムクラスパスに配置します（<code>src/test/resources</code> などに配置することになるでしょう）。</p>
</div>
<div class="listingblock">
<div class="title">src/test/resources/META-INF/services/org.junit.platform.launcher.LauncherSessionListener</div>
<div class="content">
<pre class="rouge highlight"><code>example.session.GlobalSetupTeardownListener</code></pre>
</div>
</div>
<div class="paragraph">
<p>テストは次のように記述できます。</p>
</div>
<div class="listingblock">
<div class="title">src/test/java/example/session/HttpTests.java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">package</span> <span class="nn">example.session</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.HttpURLConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">HttpTests</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">respondsWith204</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">port</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"http.server.port"</span><span class="o">);</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="no">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="no">URL</span><span class="o">(</span><span class="s">"http://localhost:"</span> <span class="o">+</span> <span class="n">port</span> <span class="o">+</span> <span class="s">"/test"</span><span class="o">);</span>

        <span class="nc">HttpURLConnection</span> <span class="n">connection</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HttpURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
        <span class="n">connection</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="s">"GET"</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">responseCode</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getResponseCode</span><span class="o">();</span> <i class="conum" data-value="2"></i><b>(2)</b>

        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">204</span><span class="o">,</span> <span class="n">responseCode</span><span class="o">);</span> <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>リスナーの設定したシステムプロパティから待ち受けポート番号を読み取ります</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>HTTP サーバーにリクエストを送信します</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>レスポンスのステータスコードを確認します</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="launcher-api-launcher-discovery-listeners-custom"><a class="anchor" href="#launcher-api-launcher-discovery-listeners-custom"></a>6.1.6. テスト発見リスナー（LauncherDiscoveryListener）を登録します</h4>
<div class="paragraph">
<p>Lancher API へ渡す <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/LauncherDiscoveryRequest.html">LauncherDiscoveryRequest</a></code> にテスト発見後処理フィルターを設定するだけでなく、Java の <code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/ServiceLoader.html">ServiceLoader</a></code> を使用して <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/LauncherDiscoveryListener.html">LauncherDiscoveryListener</a></code> の実装クラスを自動的に発見し、<code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/core/LauncherFactory.html">LauncherFactory</a></code> で作成した <code>Launcher</code> へ登録できます。</p>
</div>
<div class="paragraph">
<p>例えば、<code>LauncherDiscoveryListener</code> を実装した <code>example.CustomLauncherDiscoveryListener</code> （の完全修飾クラス名）を <code>/META-INF/services/org.junit.platform.launcher.LauncherDiscoveryListener</code> に記述しておけば、自動的に登録するのです。</p>
</div>
</div>
<div class="sect3">
<h4 id="launcher-api-listeners-custom"><a class="anchor" href="#launcher-api-listeners-custom"></a>6.1.7. テスト実行リスナー（TestExecutionListener）を登録する</h4>
<div class="paragraph">
<p><code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/Launcher.html">Launcher</a></code> API のメソッドで手続き的にテスト実行リスナーを登録するだけでなく、Java の <code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/ServiceLoader.html">ServiceLoader</a></code> を使用して <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/TestExecutionListener.html">TestExecutionListener</a></code> の実装クラスを自動的に発見し、<code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/core/LauncherFactory.html">LauncherFactory</a></code> で作成した <code>Launcher</code> へ登録できます。</p>
</div>
<div class="paragraph">
<p>例えば、<code>TestExecutionListener</code> を実装した <code>example.CustomTestExecutionListener</code> （の完全修飾クラス名）を <code>/META-INF/services/org.junit.platform.launcher.TestExecutionListener</code> に記述しておけば、自動的に登録するのです。</p>
</div>
</div>
<div class="sect3">
<h4 id="launcher-api-listeners-config"><a class="anchor" href="#launcher-api-listeners-config"></a>6.1.8. テスト実行リスナーの設定</h4>
<div class="paragraph">
<p><code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/TestExecutionListener.html">TestExecutionListener</a></code> を <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/Launcher.html">Launcher</a></code> API で手続き的に登録するときは、手続き的にリスナーの設定を変更できます。
例えばコンストラクタやセッターメソッドを使う方法です。
しかし、<code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/ServiceLoader.html">ServiceLoader</a></code> で自動的に登録するときは（<a href="#launcher-api-listeners-custom">テスト実行リスナー（TestExecutionListener）を登録する</a> を参照）、直接的にリスナーの設定を変更する方法がありません。
そういう場合、<code>TestExecutionListener</code> の作者はリスナーの設定を <a href="#running-tests-config-params">設定パラメータ</a> で指定できるようにするといいでしょう。
リスナーは <code>testPlanExecutionStarted(TestPlan)</code> メソッドや <code>testPlanExecutionFinished(TestPlan)</code> メソッドを実装すれば、<code>TestPlan</code> から設定パラメータを参照できます。
具体例は <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/listeners/UniqueIdTrackingListener.html">UniqueIdTrackingListener</a></code> を参照してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="launcher-api-listeners-custom-deactivation"><a class="anchor" href="#launcher-api-listeners-custom-deactivation"></a>6.1.9. テスト実行リスナーを不活性にする</h4>
<div class="paragraph">
<p>テスト実行リスナーを <em>使わずに</em> テストスイートを実行できるようになっていると役に立つ場合があります。
例えば、自作の <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/TestExecutionListener.html">TestExecutionListener</a></code> が外部システムにテスト結果を送信するようになっているとしたら、<em>デバッグ実行した結果</em> は送信したくないはずです。
そういうときは、設定パラメータの <code>junit.platform.execution.listeners.deactivate</code> へテスト実行リスナーの完全修飾クラス名を指定すると、そのテスト実行リスナーは不活性（未登録状態）になります。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>不活性にできるのは <code>/META-INF/services/org.junit.platform.launcher.TestExecutionListener</code> に記述して <code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/ServiceLoader.html">ServiceLoader</a></code> で登録したリスナーだけです。
つまり、<code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/LauncherDiscoveryRequest.html">LauncherDiscoveryRequest</a></code> で明示的に指定したリスナーは不活性にできません。</p>
</div>
<div class="paragraph">
<p>また、テスト実行を開始する前にテスト実行リスナーを登録するようになっているので、<code>junit.platform.execution.listeners.deactivate</code> は JVM のシステムパラメータか、設定ファイル（<a href="#running-tests-config-params">設定パラメータの構成</a> を参照）でしか指定できません。
<code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/Launcher.html">Launcher</a></code> へ渡す <code>LauncherDiscoveryRequest</code> では指定できないのです。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="launcher-api-listeners-custom-deactivation-pattern"><a class="anchor" href="#launcher-api-listeners-custom-deactivation-pattern"></a>パターンマッチ記法</h5>
<div class="paragraph">
<p><a href="#running-tests-config-params-deactivation-pattern">パターンマッチ記法</a> を参照してください。</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="launcher-api-launcher-config"><a class="anchor" href="#launcher-api-launcher-config"></a>6.1.10. Launcher の設定</h4>
<div class="paragraph">
<p>自動検出機能や登録機能より、テストエンジンやリスナーの登録を詳細に制御したいときは、<code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/core/LauncherConfig.html">LauncherConfig</a></code> のインスタンスを作成して <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/core/LauncherFactory.html">LauncherFactory</a></code> に渡すようにします。
普通は <em>ビルダー</em> API で <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/core/LauncherConfig.html">LauncherConfig</a></code> のインスタンスを作成します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">LauncherConfig</span> <span class="n">launcherConfig</span> <span class="o">=</span> <span class="nc">LauncherConfig</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">enableTestEngineAutoRegistration</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
    <span class="o">.</span><span class="na">enableLauncherSessionListenerAutoRegistration</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
    <span class="o">.</span><span class="na">enableLauncherDiscoveryListenerAutoRegistration</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
    <span class="o">.</span><span class="na">enablePostDiscoveryFilterAutoRegistration</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
    <span class="o">.</span><span class="na">enableTestExecutionListenerAutoRegistration</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
    <span class="o">.</span><span class="na">addTestEngines</span><span class="o">(</span><span class="k">new</span> <span class="nc">CustomTestEngine</span><span class="o">())</span>
    <span class="o">.</span><span class="na">addLauncherSessionListeners</span><span class="o">(</span><span class="k">new</span> <span class="nc">CustomLauncherSessionListener</span><span class="o">())</span>
    <span class="o">.</span><span class="na">addLauncherDiscoveryListeners</span><span class="o">(</span><span class="k">new</span> <span class="nc">CustomLauncherDiscoveryListener</span><span class="o">())</span>
    <span class="o">.</span><span class="na">addPostDiscoveryFilters</span><span class="o">(</span><span class="k">new</span> <span class="nc">CustomPostDiscoveryFilter</span><span class="o">())</span>
    <span class="o">.</span><span class="na">addTestExecutionListeners</span><span class="o">(</span><span class="k">new</span> <span class="nc">LegacyXmlReportGeneratingListener</span><span class="o">(</span><span class="n">reportsDir</span><span class="o">,</span> <span class="n">out</span><span class="o">))</span>
    <span class="o">.</span><span class="na">addTestExecutionListeners</span><span class="o">(</span><span class="k">new</span> <span class="nc">CustomTestExecutionListener</span><span class="o">())</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="nc">LauncherDiscoveryRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="nc">LauncherDiscoveryRequestBuilder</span><span class="o">.</span><span class="na">request</span><span class="o">()</span>
    <span class="o">.</span><span class="na">selectors</span><span class="o">(</span><span class="n">selectPackage</span><span class="o">(</span><span class="s">"com.example.mytests"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="k">try</span> <span class="o">(</span><span class="nc">LauncherSession</span> <span class="n">session</span> <span class="o">=</span> <span class="nc">LauncherFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="n">launcherConfig</span><span class="o">))</span> <span class="o">{</span>
    <span class="n">session</span><span class="o">.</span><span class="na">getLauncher</span><span class="o">().</span><span class="na">execute</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="junit-platform-reporting"><a class="anchor" href="#junit-platform-reporting"></a>6.2. JUnit Platform レポート機能</h3>
<div class="paragraph">
<p><code>junit-platform-reporting</code> アーティファクトには、テスト結果レポートを生成する <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/TestExecutionListener.html">TestExecutionListener</a></code> の実装クラスが複数含まれています。
これらのリスナーを使用するのはたいていの場合 IDE やビルドツールです。
<code>org.junit.platform.reporting.legacy.xml</code> パッケージには、次のような実装クラスがあります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="../api/org.junit.platform.reporting/org/junit/platform/reporting/legacy/xml/LegacyXmlReportGeneratingListener.html">LegacyXmlReportGeneratingListener</a></code> は <code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/TestPlan.html">TestPlan</a></code> のルートノードごとに XML 形式のテスト結果レポートを生成します。
生成するレポートは JUnit 4 のテスト結果レポート形式として事実上の標準になっている XML 形式のテスト結果レポートで、Ant により一般的になりました。
<code>LegacyXmlReportGeneratingListener</code> は <a href="#running-tests-console-launcher">コンソールランチャー</a> から使うと便利です。</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code><a href="../api/org.junit.platform.launcher/org/junit/platform/launcher/package-summary.html">junit-platform-launcher</a></code> モジュールにもテスト結果レポートの生成に使用できる <code>TestExecutionListener</code> の実装クラスが含まれています。
詳しくは <a href="#running-tests-listeners">リスナーを使用する</a> を参照してください。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="junit-platform-suite-engine"><a class="anchor" href="#junit-platform-suite-engine"></a>6.3. JUnit Platform テストスイートエンジン</h3>
<div class="paragraph">
<p>JUnit Platform では、JUnit Platform に対応している <em>あらゆる</em> テスト実行エンジンで、宣言的なテストスイートの宣言と実行ができるようになっています。</p>
</div>
<div class="sect3">
<h4 id="junit-platform-suite-engine-setup"><a class="anchor" href="#junit-platform-suite-engine-setup"></a>6.3.1. 準備</h4>
<div class="paragraph">
<p><code>junit-platform-suite-api</code> と <code>junit-platform-suite-engine</code> に加えて、<em>少なくとも1つ</em> のテスト実行エンジンをクラスパスから参照できるようにしなければなりません。
具体的な情報（グループIDやアーティファクトIDやバージョンなど）は <a href="#dependency-metadata">依存ライブラリに関するメタデータ</a> を参照してください。</p>
</div>
<div class="sect4">
<h5 id="junit-platform-suite-engine-setup-required-dependencies"><a class="anchor" href="#junit-platform-suite-engine-setup-required-dependencies"></a>必要な依存ライブラリ</h5>
<div class="ulist">
<ul>
<li>
<p><code>junit-platform-suite-api</code> <em>テスト</em> スコープ。テストスイートを宣言するアノテーションを含んでいます。</p>
</li>
<li>
<p><code>junit-platform-suite-engine</code> <em>テストランタイム</em> スコープ。テストスイートを定義する <code>TestEngine</code> の実装クラスを含んでいます。</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
これらの依存ライブラリを集約した <code>junit-platform-suite</code> アーティファクトを <em>テスト</em> スコープで追加するだけでも大丈夫です。
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="junit-platform-suite-engine-setup-transitive-dependencies"><a class="anchor" href="#junit-platform-suite-engine-setup-transitive-dependencies"></a>推移的依存ライブラリ</h5>
<div class="ulist">
<ul>
<li>
<p><code>junit-platform-suite-commons</code> <em>テスト</em> スコープ</p>
</li>
<li>
<p><code>junit-platform-launcher</code> <em>テスト</em> スコープ</p>
</li>
<li>
<p><code>junit-platform-engine</code> <em>テスト</em> スコープ</p>
</li>
<li>
<p><code>junit-platform-commons</code> <em>テスト</em> スコープ</p>
</li>
<li>
<p><code>opentest4j</code> <em>テスト</em> スコープ</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="junit-platform-suite-engine-example"><a class="anchor" href="#junit-platform-suite-engine-example"></a>6.3.2. テストスイートを宣言するアノテーション <code>@Suite</code> の使用例</h4>
<div class="paragraph">
<p>あるクラスを <code>@Suite</code> で修飾すると、JUnit Platform はテストスイートとして認識します。
次のコード例では選択式（selector）とフィルターアノテーションを組み合わせてテストスイートの項目を構成しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.junit.platform.suite.api.IncludeClassNamePatterns</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.suite.api.SelectPackages</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.suite.api.Suite</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.suite.api.SuiteDisplayName</span><span class="o">;</span>

<span class="nd">@Suite</span>
<span class="nd">@SuiteDisplayName</span><span class="o">(</span><span class="s">"JUnit Platform Suite Demo"</span><span class="o">)</span>
<span class="nd">@SelectPackages</span><span class="o">(</span><span class="s">"example"</span><span class="o">)</span>
<span class="nd">@IncludeClassNamePatterns</span><span class="o">(</span><span class="s">".*Tests"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">SuiteDemo</span> <span class="o">{</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">高度な設定項目</div>
テストスイートに組み込むテストを発見し、選択するための設定項目は大量に存在します。
利用できるアノテーションと設定項目の完全な一覧は <code><a href="../api/org.junit.platform.suite.api/org/junit/platform/suite/api/package-summary.html">org.junit.platform.suite.api</a></code> パッケージの Javadoc を参照してください。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="testkit"><a class="anchor" href="#testkit"></a>6.4. JUnit Platform 検査キット</h3>
<div class="paragraph">
<p><code>junit-platform-testkit</code> アーティファクトは、JUnit Platform でテスト計画を実行し、テスト結果と期待結果を検証するための機能を提供します。
ただし、JUnit Platform 1.4 から単独のテスト実行エンジン（<a href="#testkit-engine">テスト実行エンジン検査キット</a> を参照）による実行しかできなくなりました。</p>
</div>
<div class="sect3">
<h4 id="testkit-engine"><a class="anchor" href="#testkit-engine"></a>6.4.1. テスト実行エンジン検査キット</h4>
<div class="paragraph">
<p><code><a href="../api/org.junit.platform.testkit/org/junit/platform/testkit/engine/package-summary.html">org.junit.platform.testkit.engine</a></code> パッケージは、JUnit Platform で実行した <code><a href="../api/org.junit.platform.engine/org/junit/platform/engine/TestEngine.html">TestEngine</a></code> のテスト結果を期待結果と検証するためのフルーエント API を提供します。
主なエントリポイントは <code><a href="../api/org.junit.platform.testkit/org/junit/platform/testkit/engine/EngineTestKit.html">EngineTestKit</a></code> クラスの <code>static</code> メソッド <code>engine()</code> と <code>execute()</code> です。
<code>LauncherDiscoveryRequest</code> を作成するフルーエント API の利点を活用して、柔軟に <code>engine()</code> を選択することをお勧めします。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Launcher API の <code>LauncherDiscoveryRequestBuilder</code> で <code>LauncherDiscoveryRequest</code> を作成するなら、<code>EngineTestKit</code> の <code>execute()</code> メソッドを使用してください。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>以降のコード例では次のテストクラスを使用します。</p>
</div>
<div id="testkit-engine-ExampleTestCase" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assumptions</span><span class="o">.</span><span class="na">assumeTrue</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">example.util.Calculator</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Disabled</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.MethodOrderer.OrderAnnotation</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Order</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.TestMethodOrder</span><span class="o">;</span>

<span class="nd">@TestMethodOrder</span><span class="o">(</span><span class="nc">OrderAnnotation</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExampleTestCase</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Calculator</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Calculator</span><span class="o">();</span>

    <span class="nd">@Test</span>
    <span class="nd">@Disabled</span><span class="o">(</span><span class="s">"for demonstration purposes"</span><span class="o">)</span>
    <span class="nd">@Order</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">skippedTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// skipped ...</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@Order</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">succeedingTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">42</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">multiply</span><span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@Order</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">abortedTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assumeTrue</span><span class="o">(</span><span class="s">"abc"</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"Z"</span><span class="o">),</span> <span class="s">"abc does not contain Z"</span><span class="o">);</span>
        <span class="c1">// aborted ...</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@Order</span><span class="o">(</span><span class="mi">4</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">failingTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// The following throws an ArithmeticException: "/ by zero"</span>
        <span class="n">calculator</span><span class="o">.</span><span class="na">divide</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>説明を簡略化するため、以降のセクションではエンジン ID が <code>"junit-jupiter"</code> である JUnit 本体の <code>JupiterTestEngnine</code> を使用します。
独自の <code>TestEngine</code> を試したければ、エンジン ID を変更するか、<code>EngineTestKit.engine(TestEngine)</code> メソッドを使ってください。</p>
</div>
</div>
<div class="sect3">
<h4 id="testkit-engine-statistics"><a class="anchor" href="#testkit-engine-statistics"></a>6.4.2. 統計情報を確認する</h4>
<div class="paragraph">
<p>検査キットで最もよく使われる機能の1つが、<code>TestPlan</code> を実行している間に発生したイベントの統計情報を確認する機能です。
次のコード例では、Junit Jupiter のテスト実行エンジンが処理した <em>テストコンテナ</em> と <em>テスト</em> に関する統計情報を確認しています。
利用できる統計情報について詳しくは <code><a href="../api/org.junit.platform.testkit/org/junit/platform/testkit/engine/EventStatistics.html">EventStatistics</a></code> の Javadoc を参照してください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">discovery</span><span class="o">.</span><span class="na">DiscoverySelectors</span><span class="o">.</span><span class="na">selectClass</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">example.ExampleTestCase</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.testkit.engine.EngineTestKit</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">EngineTestKitStatisticsDemo</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">verifyJupiterContainerStats</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">EngineTestKit</span>
            <span class="o">.</span><span class="na">engine</span><span class="o">(</span><span class="s">"junit-jupiter"</span><span class="o">)</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="o">.</span><span class="na">selectors</span><span class="o">(</span><span class="n">selectClass</span><span class="o">(</span><span class="nc">ExampleTestCase</span><span class="o">.</span><span class="na">class</span><span class="o">))</span> <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="o">.</span><span class="na">execute</span><span class="o">()</span> <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="o">.</span><span class="na">containerEvents</span><span class="o">()</span> <i class="conum" data-value="4"></i><b>(4)</b>
            <span class="o">.</span><span class="na">assertStatistics</span><span class="o">(</span><span class="n">stats</span> <span class="o">-&gt;</span> <span class="n">stats</span><span class="o">.</span><span class="na">started</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">succeeded</span><span class="o">(</span><span class="mi">2</span><span class="o">));</span> <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">verifyJupiterTestStats</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">EngineTestKit</span>
            <span class="o">.</span><span class="na">engine</span><span class="o">(</span><span class="s">"junit-jupiter"</span><span class="o">)</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="o">.</span><span class="na">selectors</span><span class="o">(</span><span class="n">selectClass</span><span class="o">(</span><span class="nc">ExampleTestCase</span><span class="o">.</span><span class="na">class</span><span class="o">))</span> <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="o">.</span><span class="na">execute</span><span class="o">()</span> <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="o">.</span><span class="na">testEvents</span><span class="o">()</span> <i class="conum" data-value="6"></i><b>(6)</b>
            <span class="o">.</span><span class="na">assertStatistics</span><span class="o">(</span><span class="n">stats</span> <span class="o">-&gt;</span>
                <span class="n">stats</span><span class="o">.</span><span class="na">skipped</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">started</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">succeeded</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">aborted</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">failed</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span> <i class="conum" data-value="7"></i><b>(7)</b>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>テスト実行エンジンを指定する</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>テストクラスとして <a href="#testkit-engine-ExampleTestCase"><code>ExampleTestCase</code></a> を指定する</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>TestPlan</code> を実行する</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><em>テストコンテナ</em> のイベントを選択する</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><em>テストコンテナ</em> のイベントに関する統計情報を確認する</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><em>テスト</em> のイベントを選択する</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td><em>テスト</em> のイベントに関する統計情報を確認する</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>verifyJupiterContainerStats()</code> では、<code>JupiterTestEngine</code> と <a href="#testkit-engine-ExampleTestCase"><code>ExampleTestCase</code></a> の両方が認識しているテストコンテナについて、<code>started</code> と <code>succeeded</code> イベントが <code>2</code> 回発生していることを確認しています。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="testkit-engine-events"><a class="anchor" href="#testkit-engine-events"></a>6.4.3. イベントを確認する</h4>
<div class="paragraph">
<p><a href="#testkit-engine-statistics">統計情報を確認する</a> だけでは、テスト実行時に期待する振る舞いを検証するのに不足しているなら、記録された <code><a href="../api/org.junit.platform.testkit/org/junit/platform/testkit/engine/Event.html">Event</a></code> そのものを直接的に確認できます。</p>
</div>
<div class="paragraph">
<p>例えば、<a href="#testkit-engine-ExampleTestCase"><code>ExampleTestCase</code></a> の <code>skippedTest()</code> をスキップした理由を確認するには、次のように記述します。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>以降のコード例における <code>assertThatEvents()</code> は <code><a href="https://joel-costigliola.github.io/assertj/">AssertJ</a></code> の提供する <code>org.assertj.core.api.Assertions.assertThat(events.list())</code> に対するショートカットです。</p>
</div>
<div class="paragraph">
<p>使用している <em>条件</em> について詳しくは <code><a href="../api/org.junit.platform.testkit/org/junit/platform/testkit/engine/EventConditions.html">EventConditions</a></code> の Javadoc を参照してください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">discovery</span><span class="o">.</span><span class="na">DiscoverySelectors</span><span class="o">.</span><span class="na">selectMethod</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">event</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">skippedWithReason</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">example.ExampleTestCase</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.testkit.engine.EngineTestKit</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.testkit.engine.Events</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">EngineTestKitSkippedMethodDemo</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">verifyJupiterMethodWasSkipped</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">methodName</span> <span class="o">=</span> <span class="s">"skippedTest"</span><span class="o">;</span>

        <span class="nc">Events</span> <span class="n">testEvents</span> <span class="o">=</span> <span class="nc">EngineTestKit</span> <i class="conum" data-value="5"></i><b>(5)</b>
            <span class="o">.</span><span class="na">engine</span><span class="o">(</span><span class="s">"junit-jupiter"</span><span class="o">)</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="o">.</span><span class="na">selectors</span><span class="o">(</span><span class="n">selectMethod</span><span class="o">(</span><span class="nc">ExampleTestCase</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">methodName</span><span class="o">))</span> <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="o">.</span><span class="na">execute</span><span class="o">()</span> <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="o">.</span><span class="na">testEvents</span><span class="o">();</span> <i class="conum" data-value="4"></i><b>(4)</b>

        <span class="n">testEvents</span><span class="o">.</span><span class="na">assertStatistics</span><span class="o">(</span><span class="n">stats</span> <span class="o">-&gt;</span> <span class="n">stats</span><span class="o">.</span><span class="na">skipped</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span> <i class="conum" data-value="6"></i><b>(6)</b>

        <span class="n">testEvents</span><span class="o">.</span><span class="na">assertThatEvents</span><span class="o">()</span> <i class="conum" data-value="7"></i><b>(7)</b>
            <span class="o">.</span><span class="na">haveExactly</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">event</span><span class="o">(</span><span class="n">test</span><span class="o">(</span><span class="n">methodName</span><span class="o">),</span>
                <span class="n">skippedWithReason</span><span class="o">(</span><span class="s">"for demonstration purposes"</span><span class="o">)));</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>テスト実行エンジンを指定する</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>テストクラス <a href="#testkit-engine-ExampleTestCase"><code>ExampleTestCase</code></a> の <code>skippedTest()</code> を指定する</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>TestPlan</code> を実行する</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><em>テスト</em> のイベントを選択する</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><em>テスト</em> のイベントをローカル変数に保存する</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>ついでにイベントの統計情報を確認する</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>記録した <em>テスト</em> イベントに、<code>"for demonstration purposes"</code> というメッセージを含むイベントが1つだけ存在し、<code>skippedTest()</code> メソッドをスキップしたことを確認する</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>failingTest()</code> メソッドのスローした例外クラスを確認するときは、次のように記述します。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>使用している <em>条件</em> について詳しくは <code><a href="../api/org.junit.platform.testkit/org/junit/platform/testkit/engine/EventConditions.html">EventConditions</a></code> と <code><a href="../api/org.junit.platform.testkit/org/junit/platform/testkit/engine/TestExecutionResultConditions.html">TestExecutionResultConditions</a></code> の Javadoc を参照してください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">discovery</span><span class="o">.</span><span class="na">DiscoverySelectors</span><span class="o">.</span><span class="na">selectClass</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">event</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">finishedWithFailure</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">TestExecutionResultConditions</span><span class="o">.</span><span class="na">instanceOf</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">TestExecutionResultConditions</span><span class="o">.</span><span class="na">message</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">example.ExampleTestCase</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.testkit.engine.EngineTestKit</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">EngineTestKitFailedMethodDemo</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">verifyJupiterMethodFailed</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">EngineTestKit</span><span class="o">.</span><span class="na">engine</span><span class="o">(</span><span class="s">"junit-jupiter"</span><span class="o">)</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="o">.</span><span class="na">selectors</span><span class="o">(</span><span class="n">selectClass</span><span class="o">(</span><span class="nc">ExampleTestCase</span><span class="o">.</span><span class="na">class</span><span class="o">))</span> <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="o">.</span><span class="na">execute</span><span class="o">()</span> <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="o">.</span><span class="na">testEvents</span><span class="o">()</span> <i class="conum" data-value="4"></i><b>(4)</b>
            <span class="o">.</span><span class="na">assertThatEvents</span><span class="o">().</span><span class="na">haveExactly</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <i class="conum" data-value="5"></i><b>(5)</b>
                <span class="n">event</span><span class="o">(</span><span class="n">test</span><span class="o">(</span><span class="s">"failingTest"</span><span class="o">),</span>
                    <span class="n">finishedWithFailure</span><span class="o">(</span>
                        <span class="n">instanceOf</span><span class="o">(</span><span class="nc">ArithmeticException</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="n">message</span><span class="o">(</span><span class="s">"/ by zero"</span><span class="o">))));</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>テスト実行エンジンを指定する</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>テストクラスとして <a href="#testkit-engine-ExampleTestCase"><code>ExampleTestCase</code></a> を指定する</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>TestPlan</code> を実行する</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><em>テスト</em> のイベントを選択する</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>記録した <em>テスト</em> イベントに、<code>"/ by zero"</code> というメッセージを含む <code>ArithmeticException</code> をスローしたイベントが1つだけ存在し、<code>failingTest()</code> メソッドが失敗したことを確認する</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>普通なら不要ですが、<code>TestPlan</code> を実行している間に発生した <strong>全ての</strong> イベントを確認しなければならない場合があるかもしれません。
次のコード例では <code>EngineTestKit</code> API の <code>assertEventsMatchExactly()</code> メソッドでそのようなことをしています。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>assertEventsMatchExactly()</code> はイベントが発生したのと同じ順番で条件と比較していきます。
<a href="#testkit-engine-ExampleTestCase"><code>ExampleTestCase</code></a> は <code>@TestMethodOrder(OrderAnnotation.class)</code> で修飾しているし、それぞれのテストメソッドは <code>@Order(&#8230;&#8203;)</code> で修飾しているので、常に同じ順番で実行されます。
したがって、<code>verifyAllJupiterEvents()</code> の結果は（順序の違いに）影響されません。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>順序を無視して <em>部分的に</em> 比較したければ、<code>assertEventsMatchLooselyInOrder()</code> や <code>assertEventsMatchLoosely()</code> を使うといいでしょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">condition</span><span class="o">.</span><span class="na">JRE</span><span class="o">.</span><span class="na">JAVA_18</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">discovery</span><span class="o">.</span><span class="na">DiscoverySelectors</span><span class="o">.</span><span class="na">selectClass</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">abortedWithReason</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">container</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">engine</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">event</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">finishedSuccessfully</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">finishedWithFailure</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">skippedWithReason</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">started</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">EventConditions</span><span class="o">.</span><span class="na">test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">TestExecutionResultConditions</span><span class="o">.</span><span class="na">instanceOf</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">platform</span><span class="o">.</span><span class="na">testkit</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">TestExecutionResultConditions</span><span class="o">.</span><span class="na">message</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.StringWriter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.Writer</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">example.ExampleTestCase</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.condition.DisabledOnJre</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.platform.testkit.engine.EngineTestKit</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.opentest4j.TestAbortedException</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">EngineTestKitAllEventsDemo</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisabledOnJre</span><span class="o">(</span><span class="no">JAVA_18</span><span class="o">)</span> <span class="c1">// https://github.com/assertj/assertj-core/issues/2340</span>
    <span class="kt">void</span> <span class="nf">verifyAllJupiterEvents</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Writer</span> <span class="n">writer</span> <span class="o">=</span> <span class="c1">// create a java.io.Writer for debug output</span>

        <span class="nc">EngineTestKit</span><span class="o">.</span><span class="na">engine</span><span class="o">(</span><span class="s">"junit-jupiter"</span><span class="o">)</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="o">.</span><span class="na">selectors</span><span class="o">(</span><span class="n">selectClass</span><span class="o">(</span><span class="nc">ExampleTestCase</span><span class="o">.</span><span class="na">class</span><span class="o">))</span> <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="o">.</span><span class="na">execute</span><span class="o">()</span> <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="o">.</span><span class="na">allEvents</span><span class="o">()</span> <i class="conum" data-value="4"></i><b>(4)</b>
            <span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="n">writer</span><span class="o">)</span> <i class="conum" data-value="5"></i><b>(5)</b>
            <span class="o">.</span><span class="na">assertEventsMatchExactly</span><span class="o">(</span> <i class="conum" data-value="6"></i><b>(6)</b>
                <span class="n">event</span><span class="o">(</span><span class="n">engine</span><span class="o">(),</span> <span class="n">started</span><span class="o">()),</span>
                <span class="n">event</span><span class="o">(</span><span class="n">container</span><span class="o">(</span><span class="nc">ExampleTestCase</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="n">started</span><span class="o">()),</span>
                <span class="n">event</span><span class="o">(</span><span class="n">test</span><span class="o">(</span><span class="s">"skippedTest"</span><span class="o">),</span> <span class="n">skippedWithReason</span><span class="o">(</span><span class="s">"for demonstration purposes"</span><span class="o">)),</span>
                <span class="n">event</span><span class="o">(</span><span class="n">test</span><span class="o">(</span><span class="s">"succeedingTest"</span><span class="o">),</span> <span class="n">started</span><span class="o">()),</span>
                <span class="n">event</span><span class="o">(</span><span class="n">test</span><span class="o">(</span><span class="s">"succeedingTest"</span><span class="o">),</span> <span class="n">finishedSuccessfully</span><span class="o">()),</span>
                <span class="n">event</span><span class="o">(</span><span class="n">test</span><span class="o">(</span><span class="s">"abortedTest"</span><span class="o">),</span> <span class="n">started</span><span class="o">()),</span>
                <span class="n">event</span><span class="o">(</span><span class="n">test</span><span class="o">(</span><span class="s">"abortedTest"</span><span class="o">),</span>
                    <span class="n">abortedWithReason</span><span class="o">(</span><span class="n">instanceOf</span><span class="o">(</span><span class="nc">TestAbortedException</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
                        <span class="n">message</span><span class="o">(</span><span class="n">m</span> <span class="o">-&gt;</span> <span class="n">m</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"abc does not contain Z"</span><span class="o">)))),</span>
                <span class="n">event</span><span class="o">(</span><span class="n">test</span><span class="o">(</span><span class="s">"failingTest"</span><span class="o">),</span> <span class="n">started</span><span class="o">()),</span>
                <span class="n">event</span><span class="o">(</span><span class="n">test</span><span class="o">(</span><span class="s">"failingTest"</span><span class="o">),</span> <span class="n">finishedWithFailure</span><span class="o">(</span>
                    <span class="n">instanceOf</span><span class="o">(</span><span class="nc">ArithmeticException</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="n">message</span><span class="o">(</span><span class="s">"/ by zero"</span><span class="o">))),</span>
                <span class="n">event</span><span class="o">(</span><span class="n">container</span><span class="o">(</span><span class="nc">ExampleTestCase</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="n">finishedSuccessfully</span><span class="o">()),</span>
                <span class="n">event</span><span class="o">(</span><span class="n">engine</span><span class="o">(),</span> <span class="n">finishedSuccessfully</span><span class="o">()));</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>テスト実行エンジンを指定する</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>テストクラスとして <a href="#testkit-engine-ExampleTestCase"><code>ExampleTestCase</code></a> を指定する</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>TestPlan</code> を実行する</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><em>テスト</em> のイベントを選択する</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>デバッグ用に全てのイベントを <code>writer</code> へ出力する（<code>System.out</code> や <code>System.err</code> のような <code>OutputStream</code> に出力することもできます）</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>テストエンジンの発生した <em>全ての</em> イベントが想定した順序になっているか確認する</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>前のコード例に登場する <code>debug()</code> は次のような出力をするでしょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>All Events:
    Event [type = STARTED, testDescriptor = JupiterEngineDescriptor: [engine:junit-jupiter], timestamp = 2018-12-14T12:45:14.082280Z, payload = null]
    Event [type = STARTED, testDescriptor = ClassTestDescriptor: [engine:junit-jupiter]/[class:example.ExampleTestCase], timestamp = 2018-12-14T12:45:14.089339Z, payload = null]
    Event [type = SKIPPED, testDescriptor = TestMethodTestDescriptor: [engine:junit-jupiter]/[class:example.ExampleTestCase]/[method:skippedTest()], timestamp = 2018-12-14T12:45:14.094314Z, payload = 'for demonstration purposes']
    Event [type = STARTED, testDescriptor = TestMethodTestDescriptor: [engine:junit-jupiter]/[class:example.ExampleTestCase]/[method:succeedingTest()], timestamp = 2018-12-14T12:45:14.095182Z, payload = null]
    Event [type = FINISHED, testDescriptor = TestMethodTestDescriptor: [engine:junit-jupiter]/[class:example.ExampleTestCase]/[method:succeedingTest()], timestamp = 2018-12-14T12:45:14.104922Z, payload = TestExecutionResult [status = SUCCESSFUL, throwable = null]]
    Event [type = STARTED, testDescriptor = TestMethodTestDescriptor: [engine:junit-jupiter]/[class:example.ExampleTestCase]/[method:abortedTest()], timestamp = 2018-12-14T12:45:14.106121Z, payload = null]
    Event [type = FINISHED, testDescriptor = TestMethodTestDescriptor: [engine:junit-jupiter]/[class:example.ExampleTestCase]/[method:abortedTest()], timestamp = 2018-12-14T12:45:14.109956Z, payload = TestExecutionResult [status = ABORTED, throwable = org.opentest4j.TestAbortedException: Assumption failed: abc does not contain Z]]
    Event [type = STARTED, testDescriptor = TestMethodTestDescriptor: [engine:junit-jupiter]/[class:example.ExampleTestCase]/[method:failingTest()], timestamp = 2018-12-14T12:45:14.110680Z, payload = null]
    Event [type = FINISHED, testDescriptor = TestMethodTestDescriptor: [engine:junit-jupiter]/[class:example.ExampleTestCase]/[method:failingTest()], timestamp = 2018-12-14T12:45:14.111217Z, payload = TestExecutionResult [status = FAILED, throwable = java.lang.ArithmeticException: / by zero]]
    Event [type = FINISHED, testDescriptor = ClassTestDescriptor: [engine:junit-jupiter]/[class:example.ExampleTestCase], timestamp = 2018-12-14T12:45:14.113731Z, payload = TestExecutionResult [status = SUCCESSFUL, throwable = null]]
    Event [type = FINISHED, testDescriptor = JupiterEngineDescriptor: [engine:junit-jupiter], timestamp = 2018-12-14T12:45:14.113806Z, payload = TestExecutionResult [status = SUCCESSFUL, throwable = null]]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-evolution"><a class="anchor" href="#api-evolution"></a>7. API の進化</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JUnit 5 の主要な目標の1つとして、多数のプロジェクトで使われつつ継続的に JUnit を進化させるため、メンテナーにとっての利便性を向上することが挙げられます。
JUnit 4 では、拡張機能やツールの作者が利用できる部品は、最初から用意されていた内部部品に限られていたため、とても苦労させられただけでなく、やりたいことができない場合もありました。</p>
</div>
<div class="paragraph">
<p>JUnit 5 が全てのライフサイクルに関するインターフェイスやクラスやメソッドを公開しているのは、そういう理由です。</p>
</div>
<div class="sect2">
<h3 id="api-evolution-version-and-status"><a class="anchor" href="#api-evolution-version-and-status"></a>7.1. API のバージョンと状態</h3>
<div class="paragraph">
<p>公開している全てのアーティファクトのバージョン番号の形式は <code>&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</code> です。
インターフェイス、クラス、メソッド、アノテーションにも、<code><a href="https://github.com/apiguardian-team/apiguardian">@API Guardian</a></code> の <code><a href="https://apiguardian-team.github.io/apiguardian/docs/current/api/">@API</a></code> で同じバージョン番号が指定されています。
<code>status</code> 属性には次のような値が指定されています。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">状態</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">内容</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INTERNAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">内部用。JUnit 以外で使用するべきではない要素です。予告せずに削除する場合があります。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DEPRECATED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">廃止予定。将来のマイナーアップデートで削除する可能性があるため、使用しないほうがいい要素です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EXPERIMENTAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">実験的。JUnit チームとしてフィードバックを募集している新しい実験的な機能に関連する要素です。
                     注意して使用してください。
                     将来的に <code>MAINTAINED</code> や <code>STABLE</code> へ変更になる可能性があります。
                     将来のパッチアップデートで予告せずにで削除する可能性があります。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MAINTAINED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">保守。後方互換性を保つため、<strong>少なくとも</strong> 次のマイナーアップデート（同じメジャーバージョン）では変更しない要素です。
                     将来的に削除する場合は、まず状態を <code>DEPRECATED</code> へ変更します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STABLE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">安定。後方互換性を保つため、同じメジャーバージョンの間は変更しない要素です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>インターフェイスやクラスが <code>@API</code> で修飾されているなら、可視性が <code>public</code> のメンバーについても同じ意味になります。
インターフェイスやクラスのメンバーには、インターフェイスやクラスより安定性の低い <code>status</code> を指定する場合があります。</p>
</div>
</div>
<div class="sect2">
<h3 id="api-evolution-experimental-apis"><a class="anchor" href="#api-evolution-experimental-apis"></a>7.2. 実験的な API</h3>
<div class="paragraph">
<p>次の表は現在のバージョンで <em>実験的</em> <code>@API(status = EXPERIMENTAL)</code> になっている要素です。
注意して使用してください。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Package Name</th>
<th class="tableblock halign-left valign-top">Type Name</th>
<th class="tableblock halign-left valign-top">Since</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ClassDescriptor</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ClassOrderer</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ClassOrdererContext</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DisplayNameGenerator.IndicativeSentences</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.7</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IndicativeSentencesGeneration</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.7</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MethodOrderer.DisplayName</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.7</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MethodOrderer.MethodName</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.7</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Order</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.4</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TestClassOrder</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DynamicTestInvocationContext</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>InvocationInterceptor</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>InvocationInterceptor.Invocation</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LifecycleMethodExecutionExceptionHandler</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ReflectiveInvocationContext</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TestInstantiationException</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension.support</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TypeBasedParameterResolver</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.6</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.io</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TempDir</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.4</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.parallel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Execution</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.parallel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ExecutionMode</code> <em>(enum)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.parallel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Isolated</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.7</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.parallel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ResourceAccessMode</code> <em>(enum)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.parallel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ResourceLock</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.parallel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ResourceLocks</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.parallel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Resources</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.converter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TypedArgumentConverter</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.7</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.commons.support</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SearchOption</code> <em>(enum)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.console</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConsoleLauncherToolProvider</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.6</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EngineDiscoveryListener</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.6</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SelectorResolutionResult</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.6</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.config</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PrefixedConfigurationParameters</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.discovery</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EngineDiscoveryRequestResolver</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.discovery</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EngineDiscoveryRequestResolver.Builder</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.discovery</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EngineDiscoveryRequestResolver.InitializationContext</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.discovery</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SelectorResolver</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.discovery</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SelectorResolver.Context</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.discovery</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SelectorResolver.Match</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.discovery</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SelectorResolver.Resolution</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.hierarchical</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DefaultParallelExecutionConfigurationStrategy</code> <em>(enum)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.hierarchical</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ExclusiveResource</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.hierarchical</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ForkJoinPoolHierarchicalTestExecutorService</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.hierarchical</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HierarchicalTestExecutorService</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.hierarchical</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Node.ExecutionMode</code> <em>(enum)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.hierarchical</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Node.Invocation</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.4</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.hierarchical</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ParallelExecutionConfiguration</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.hierarchical</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ParallelExecutionConfigurationStrategy</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.hierarchical</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ResourceLock</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.hierarchical</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SameThreadHierarchicalTestExecutorService</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.jfr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FlightRecordingDiscoveryListener</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.jfr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FlightRecordingExecutionListener</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.launcher</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EngineDiscoveryResult</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.6</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.launcher</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LauncherDiscoveryListener</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.6</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.launcher</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LauncherSession</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.launcher</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LauncherSessionListener</code> <em>(interface)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.launcher.listeners</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>UniqueIdTrackingListener</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.launcher.listeners.discovery</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LauncherDiscoveryListeners</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.6</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.suite.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConfigurationParameter</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.suite.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConfigurationParameters</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.suite.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DisableParentConfigurationParameters</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.suite.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SelectClasspathResource</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.suite.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SelectClasspathResources</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.suite.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SelectDirectories</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.suite.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SelectFile</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.suite.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SelectFiles</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.suite.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SelectModules</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.suite.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SelectUris</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.suite.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Suite</code> <em>(annotation)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="api-evolution-deprecated-apis"><a class="anchor" href="#api-evolution-deprecated-apis"></a>7.3. 廃止予定の API</h3>
<div class="paragraph">
<p>次の表は現在のバージョンで <em>廃止予定</em> <code>@API(status = DEPRECATED)</code> になっている要素です。
次のリリースで削除される可能性があるため、できるだけ使用しないでください。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Package Name</th>
<th class="tableblock halign-left valign-top">Type Name</th>
<th class="tableblock halign-left valign-top">Since</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MethodOrderer.Alphanumeric</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5.7</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.commons.util</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BlacklistedExceptions</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.7</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.commons.util</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PreconditionViolationException</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.filter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ClasspathScanningSupport</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.support.hierarchical</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SingleTestExecutor</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.launcher.listeners</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LegacyReportingUtils</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.6</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.runner</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JUnitPlatform</code> <em>(class)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.8</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="api-evolution-tooling"><a class="anchor" href="#api-evolution-tooling"></a>7.4. ツール側の <code>@API</code> 対応</h3>
<div class="paragraph">
<p><code><a href="https://github.com/apiguardian-team/apiguardian">@API Guardian</a></code> プロジェクトでは、<code><a href="https://apiguardian-team.github.io/apiguardian/docs/current/api/">@API</a></code> で修飾した要素の供給者と消費者をツールから使用するための機能を提供する予定です。
例えば、ツールの使用している JUnit API の <code>@API</code> をチェックできるようになるかもしれません。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributors"><a class="anchor" href="#contributors"></a>8. Contributors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Browse the <a href="https://github.com/junit-team/junit5/graphs/contributors">current list of contributors</a> directly on GitHub.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="release-notes"><a class="anchor" href="#release-notes"></a>9. Release Notes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The release notes are available <a href="../release-notes/index.html#release-notes">here</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix"><a class="anchor" href="#appendix"></a>10. 付録</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="reproducible-builds"><a class="anchor" href="#reproducible-builds"></a>10.1. 再現性のあるビルド</h3>
<div class="paragraph">
<p>JUnit 5.7 から、Javadoc を含まない jar ファイルを <a href="https://reproducible-builds.org/">再現性のあるビルド</a> として作成するようになりました。</p>
</div>
<div class="paragraph">
<p>ビルド時の条件（Java のバージョンなど）が同じなら、何回ビルドをしてもバイト単位で同じ結果を生成するということです。</p>
</div>
<div class="paragraph">
<p>Maven Central や Sonartype に公開しているアーティファクトと同じビルド時の条件を用意できるなら、誰でも自分の環境で完全に同じアーティファクトをビルドできるのです。
Maven リポジトリのアーティファクトがソースコードからビルドした内容であることを確認できます。</p>
</div>
</div>
<div class="sect2">
<h3 id="dependency-metadata"><a class="anchor" href="#dependency-metadata"></a>10.2. 依存ライブラリに関するメタデータ</h3>
<div class="paragraph">
<p>最終的なリリースやマイルストーンに対応するアーティファクトは <a href="https://search.maven.org/">Maven Central</a> へデプロイします。
スナップショットのアーティファクトは SonarType の <a href="https://oss.sonatype.org/content/repositories/snapshots">スナップショットリポジトリ</a> の <a href="https://oss.sonatype.org/content/repositories/snapshots/org/junit/">/org/junit</a> へデプロイします。</p>
</div>
<div class="sect3">
<h4 id="dependency-metadata-junit-platform"><a class="anchor" href="#dependency-metadata-junit-platform"></a>10.2.1. JUnit Platform</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Group ID</strong>: <code>org.junit.platform</code></p>
</li>
<li>
<p><strong>Version</strong>: <code>1.9.0-SNAPSHOT</code></p>
</li>
<li>
<p><strong>Artifact IDs</strong>:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>junit-platform-commons</code></dt>
<dd>
<p>Common APIs and support utilities for the JUnit Platform. Any API annotated with
<code>@API(status = INTERNAL)</code> is intended solely for usage within the JUnit framework
itself. <em>Any usage of internal APIs by external parties is not supported!</em></p>
</dd>
<dt class="hdlist1"><code>junit-platform-console</code></dt>
<dd>
<p>Support for discovering and executing tests on the JUnit Platform from the console.
See <a href="#running-tests-console-launcher">コンソールランチャー</a> for details.</p>
</dd>
<dt class="hdlist1"><code>junit-platform-console-standalone</code></dt>
<dd>
<p>An executable JAR with all dependencies included is provided in Maven Central under the
<a href="https://repo1.maven.org/maven2/org/junit/platform/junit-platform-console-standalone">junit-platform-console-standalone</a>
directory. See <a href="#running-tests-console-launcher">コンソールランチャー</a> for details.</p>
</dd>
<dt class="hdlist1"><code>junit-platform-engine</code></dt>
<dd>
<p>Public API for test engines. See <a href="#launcher-api-engines-custom">テスト実行エンジンの登録</a> for details.</p>
</dd>
<dt class="hdlist1"><code>junit-platform-jfr</code></dt>
<dd>
<p>   Provides a <code>LauncherDiscoveryListener</code> and <code>TestExecutionListener</code> for Java Flight
Recorder events on the JUnit Platform. See <a href="#running-tests-listeners-flight-recorder">Java Flight Recorder を使用する</a>
for details.</p>
</dd>
<dt class="hdlist1"><code>junit-platform-launcher</code></dt>
<dd>
<p>Public API for configuring and launching test plans&#8201;&#8212;&#8201;typically used by IDEs and
build tools. See <a href="#launcher-api">JUnit Platform Launcher API</a> for details.</p>
</dd>
<dt class="hdlist1"><code>junit-platform-reporting</code></dt>
<dd>
<p><code>TestExecutionListener</code> implementations that generate test reports&#8201;&#8212;&#8201;typically used
by IDEs and build tools. See <a href="#junit-platform-reporting">JUnit Platform レポート機能</a> for details.</p>
</dd>
<dt class="hdlist1"><code>junit-platform-runner</code></dt>
<dd>
<p>Runner for executing tests and test suites on the JUnit Platform in a JUnit 4
environment. See <a href="#running-tests-junit-platform-runner">JUnit 4 で JUnit Platform を実行する</a> for details.</p>
</dd>
<dt class="hdlist1"><code>junit-platform-suite</code></dt>
<dd>
<p>   JUnit Platform Suite artifact that transitively pulls in dependencies on
   <code>junit-platform-suite-api</code> and <code>junit-platform-suite-engine</code> for simplified dependency
management in build tools such as Gradle and Maven.</p>
</dd>
<dt class="hdlist1"><code>junit-platform-suite-api</code></dt>
<dd>
<p>Annotations for configuring test suites on the JUnit Platform. Supported by the
<a href="#junit-platform-suite-engine">JUnit Platform Suite Engine</a> and the
<a href="#running-tests-junit-platform-runner">JUnitPlatform runner</a>.</p>
</dd>
<dt class="hdlist1"><code>junit-platform-suite-commons</code></dt>
<dd>
<p>Common support utilities for executing test suites on the JUnit Platform.</p>
</dd>
<dt class="hdlist1"><code>junit-platform-suite-engine</code></dt>
<dd>
<p>Engine that executes test suites on the JUnit Platform; only required at runtime. See
<a href="#junit-platform-suite-engine">JUnit Platform Suite Engine</a> for details.</p>
</dd>
<dt class="hdlist1"><code>junit-platform-testkit</code></dt>
<dd>
<p>Provides support for executing a test plan for a given <code>TestEngine</code> and then
accessing the results via a fluent API to verify the expected results.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="dependency-metadata-junit-jupiter"><a class="anchor" href="#dependency-metadata-junit-jupiter"></a>10.2.2. JUnit Jupiter</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Group ID</strong>: <code>org.junit.jupiter</code></p>
</li>
<li>
<p><strong>Version</strong>: <code>5.9.0-SNAPSHOT</code></p>
</li>
<li>
<p><strong>Artifact IDs</strong>:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>junit-jupiter</code></dt>
<dd>
<p>JUnit Jupiter aggregator artifact that transitively pulls in dependencies on
<code>junit-jupiter-api</code>, <code>junit-jupiter-params</code>, and <code>junit-jupiter-engine</code> for
simplified dependency management in build tools such as Gradle and Maven.</p>
</dd>
<dt class="hdlist1"><code>junit-jupiter-api</code></dt>
<dd>
<p>JUnit Jupiter API for <a href="#writing-tests">writing tests</a> and <a href="#extensions">extensions</a>.</p>
</dd>
<dt class="hdlist1"><code>junit-jupiter-engine</code></dt>
<dd>
<p>JUnit Jupiter test engine implementation; only required at runtime.</p>
</dd>
<dt class="hdlist1"><code>junit-jupiter-params</code></dt>
<dd>
<p>Support for <a href="#writing-tests-parameterized-tests">parameterized tests</a> in JUnit Jupiter.</p>
</dd>
<dt class="hdlist1"><code>junit-jupiter-migrationsupport</code></dt>
<dd>
<p>Support for migrating from JUnit 4 to JUnit Jupiter; only required for support for
JUnit 4&#8217;s <code>@Ignore</code> annotation and for running selected JUnit 4 rules.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="dependency-metadata-junit-vintage"><a class="anchor" href="#dependency-metadata-junit-vintage"></a>10.2.3. JUnit Vintage</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Group ID</strong>: <code>org.junit.vintage</code></p>
</li>
<li>
<p><strong>Version</strong>: <code>5.9.0-SNAPSHOT</code></p>
</li>
<li>
<p><strong>Artifact ID</strong>:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>junit-vintage-engine</code></dt>
<dd>
<p>JUnit Vintage test engine implementation that allows one to run <em>vintage</em> JUnit tests
on the JUnit Platform. <em>Vintage</em> tests include those written using JUnit 3 or JUnit 4
APIs or tests written using testing frameworks built on those APIs.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="dependency-metadata-junit-bom"><a class="anchor" href="#dependency-metadata-junit-bom"></a>10.2.4. 部品表（BOM：Bill of Materials）</h4>
<div class="paragraph">
<p><a href="https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Importing_Dependencies">Maven</a> や
<a href="https://docs.gradle.org/current/userguide/managing_transitive_dependencies.html#sec:bom_import">Gradle</a> で
複数のアーティファクトを依存ライブラリとして簡単に管理できるよう、Maven BOM を公開しています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Group ID</strong>: <code>org.junit</code></p>
</li>
<li>
<p><strong>Artifact ID</strong>: <code>junit-bom</code></p>
</li>
<li>
<p><strong>Version</strong>: <code>5.9.0-SNAPSHOT</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="dependency-metadata-dependencies"><a class="anchor" href="#dependency-metadata-dependencies"></a>10.2.5. Dependencies</h4>
<div class="paragraph">
<p>ほとんどのアーティファクトは公開している Maven POM の依存関係として {API_Gurdian} のライブラリを記述しています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Group ID</strong>: <code>org.apiguardian</code></p>
</li>
<li>
<p><strong>Artifact ID</strong>: <code>apiguardian-api</code></p>
</li>
<li>
<p><strong>Version</strong>: <code>1.1.2</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>また、ほとんどのアーティファクトは直接的に、あるいは、推移的に、<em>OpenTest4J</em> のライブラリへ依存しています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Group ID</strong>: <code>org.opentest4j</code></p>
</li>
<li>
<p><strong>Artifact ID</strong>: <code>opentest4j</code></p>
</li>
<li>
<p><strong>Version</strong>: <code>1.2.0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dependency-diagram"><a class="anchor" href="#dependency-diagram"></a>10.3. Dependency Diagram</h3>
<div class="imageblock">
<div class="content">
<img src="images/component-diagram.svg" alt="component diagram" width="2014" height="893">
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 5.9.0-SNAPSHOT<br>
Last updated 2021-09-15 16:34:57 +0900
</div>
</div>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .sa, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
<script src="../tocbot-3.0.2/tocbot.min.js"></script>
<script>
    /* Tocbot dynamic TOC, works with tocbot 3.0.2 */
    /* Source: https://github.com/asciidoctor/asciidoctor/issues/699#issuecomment-321066006 */
    var oldtoc = document.getElementById('toctitle').nextElementSibling;
    var newtoc = document.createElement('div');
    newtoc.setAttribute('id', 'tocbot');
    newtoc.setAttribute('class', 'js-toc');
    oldtoc.parentNode.replaceChild(newtoc, oldtoc);
    tocbot.init({ contentSelector: '#content',
        headingSelector: 'h1, h2, h3, h4, h5',
        smoothScroll: false });
    var handleTocOnResize = function() {
        var width = window.innerWidth
                    || document.documentElement.clientWidth
                    || document.body.clientWidth;
        if (width < 768) {
            tocbot.refresh({ contentSelector: '#content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 6,
                activeLinkClass: 'ignoreactive',
                throttleTimeout: 1000,
                smoothScroll: false });
        }
        else {
            tocbot.refresh({ contentSelector: '#content',
                headingSelector: 'h1, h2, h3, h4, h5',
                smoothScroll: false });
        }
    };
    window.addEventListener('resize', handleTocOnResize);
    handleTocOnResize();
</script>
</body>
</html>